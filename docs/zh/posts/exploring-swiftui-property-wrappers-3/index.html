<!DOCTYPE html><html lang="zh"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="sitemap" href="/sitemap-index.xml"><!-- <link rel="shortcut icon" href={iconSVG.src} /> --><link rel="icon" type="image/png" sizes="16x16" href="/_astro/favicon-16x16.2312221518-2.4YWPtmqG.png"><link rel="icon" type="image/png" sizes="32x32" href="/_astro/favicon-32x32.2312221518-2.W1M1HUWf.png"><link rel="mask-icon" href="/_astro/faviconSVG-32x32.2312221518-2.JZf4E4CU.svg"><link rel="apple-touch-icon" sizes="180x180" href="/_astro/apple-touch-icon.2312227635.RNVrzb6f.png"><link rel="stylesheet" href="/style/global-new.css"><title>探讨 SwiftUI 中的属性包装器：@FetchRequest、@SectionedFetchRequest、@Query、@Namespace、@Bindable | 肘子的 Swift 记事本</title>
<meta name="description" content="本文深入探讨SwiftUI中 @FetchRequest、@SectionedFetchRequest、@Query、 @Namespace 和 @Bindable 属性包装器的用法，助你掌握数据获取和视图控制。">
<meta name="robots" content="index,follow">
<link rel="canonical" href="https://fatbobman.com/zh/posts/exploring-swiftui-property-wrappers-3/">
<meta property="og:title" content="探讨 SwiftUI 中的属性包装器：@FetchRequest、@SectionedFetchRequest、@Query、@Namespace、@Bindable | 肘子的 Swift 记事本">
<meta property="og:description" content="本文深入探讨SwiftUI中 @FetchRequest、@SectionedFetchRequest、@Query、 @Namespace 和 @Bindable 属性包装器的用法，助你掌握数据获取和视图控制。">
<meta property="og:url" content="https://fatbobman.com/zh/posts/exploring-swiftui-property-wrappers-3/">
<meta property="og:type" content="article">
<meta property="og:image" content="https://cdn.fatbobman.com/card/exploring-swiftui-property-wrappers-3-zh.png">

<meta property="og:locale" content="zh">
<meta property="og:site_name" content="fatbobman.com">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@fatbobman">
<meta name="twitter:creator" content="@fatbobman"><link rel="alternate" type="application/rss+xml" title="RSS Feed for My Website" href="https://fatbobman.com/zh/rss.xml"><link rel="sitemap" href="/sitemap-index.xml"><meta name="keywords" content="Swift 编程,Swift Programming,SwiftUI 教程,SwiftUI Tutorials,Core Data 实践,Core Data Practices,SwiftData 应用,SwiftData Applications,iOS 开发,iOS Development,Swift UI 设计,Swift UI Design,Swift 性能优化,Swift Performance Optimization,Swift 编码技巧,Swift Coding Techniques,iOS 应用开发,iOS App Development,Swift 数据管理,Swift Data Management,SwiftUI 布局,SwiftUI Layout,SwiftUI 动画,SwiftUI Animation"><meta name="apple-mobile-web-app-title" content="肘子的博客"><link rel="alternate" hreflang="zh" href="https://fatbobman.com/zh/posts/exploring-swiftui-property-wrappers-3/"><link rel="alternate" hreflang="en" href="https://fatbobman.com/en/posts/exploring-swiftui-property-wrappers-3/"><!-- <BasicScripts /> --><!-- <script is:inline>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?14e5d60a3ea6276655f9d14c58b1fcd0";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script> --><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5C7N4MF5');</script> <!-- End Google Tag Manager --><link rel="stylesheet" href="/_astro/about.ef6e_bru.css" />
<link rel="stylesheet" href="/_astro/about.Y66QztvF.css" />
<link rel="stylesheet" href="/_astro/_slug_.KE54EPLE.css" />
<style>.sticky[data-astro-cid-4wsjtibl]{position:fixed;top:0;left:50%;transform:translate(-50%);width:100%;max-width:100%}
</style><script type="module" src="/_astro/hoisted.i0Vwr4b0.js"></script></head> <body class="antialiased text-default tracking-tight bg-page">  <div class="flex flex-col min-h-screen justify-between "> <div> <header> <div class="bg-block" id="wholeHeader" data-astro-cid-4wsjtibl> <div id="blogTitle"> <a href="/zh/"> <div class="flex space-x-4 mx-auto text-center pt-16 sm:pt-12 font-black w-[240px] sm:w-[300px] pb-6 sm:pb-1"> <svg class="text-heading" width="337" height="63"> <use href="/images/title-fatbobman.svg#main"></use> </svg> <svg class="text-primary mt-[-6px] sm:mt-[-5px]" width="130" height="91"> <use href="/images/title-blog.svg#main"></use> </svg> </div> </a> </div> <div class="bg-block z-50 shadow-custom-light dark:shadow-custom-dark" id="stickyHeader" data-astro-cid-4wsjtibl> <div class="max-w-5xl flex flex-wrap items-center justify-between mx-auto p-2 sm:p-0" data-astro-cid-4wsjtibl> <div class="flex space-x-2" data-astro-cid-4wsjtibl> <div id="lang-data" data-lang="zh" style="display: none;"></div> <button id="language-dropdown-button" data-dropdown-toggle="language-dropdown-menu" type="button" class="p-2 w-10 h-10 font-medium text-default hover:text-secondary hover:bg-gray-100 dark:hover:bg-page focus:outline-none focus:ring-2 focus:ring-gray-200 dark:hover:bg-gray-700 dark:focus:ring-gray-600 rounded-lg"> ZH </button> <!-- Dropdown --> <div class="z-50 hidden my-4 text-base list-none bg-page divide-y divide-gray-100 rounded-lg shadow dark:bg-gray-700" id="language-dropdown-menu"> <ul class="py-2 font-medium text-sm" role="none"> <li> <a href="/en/posts/exploring-swiftui-property-wrappers-3/" class="block px-4 py-2 text-default hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" role="menuitem"> <div class="inline-flex items-center">
English
<svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5 ml-2 hidden text-primary" id="EN-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M6.979 3.074a6 6 0 0 1 4.988 1.425l.037 .033l.034 -.03a6 6 0 0 1 4.733 -1.44l.246 .036a6 6 0 0 1 3.364 10.008l-.18 .185l-.048 .041l-7.45 7.379a1 1 0 0 1 -1.313 .082l-.094 -.082l-7.493 -7.422a6 6 0 0 1 3.176 -10.215z" stroke-width="0" fill="currentColor"></path></svg> </div> </a> </li> <li> <a href="" class="block px-4 py-2 text-default hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" role="menuitem"> <div class="inline-flex items-center">
中文
<svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5 ml-2 hidden text-primary" id="ZH-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M6.979 3.074a6 6 0 0 1 4.988 1.425l.037 .033l.034 -.03a6 6 0 0 1 4.733 -1.44l.246 .036a6 6 0 0 1 3.364 10.008l-.18 .185l-.048 .041l-7.45 7.379a1 1 0 0 1 -1.313 .082l-.094 -.082l-7.493 -7.422a6 6 0 0 1 3.176 -10.215z" stroke-width="0" fill="currentColor"></path></svg> </div> </a> </li> <li> <div class="border-t border-gray-200 dark:border-gray-800 w-4/5 mx-auto my-2"></div> <button class="block px-4 py-2 text-default hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" role="menuitem" id="set-default-lang"> <div class="inline-flex items-center"> 将中文设置为默认 </div> </button> </li> </ul> </div>  <button id="theme-dropdown-button" data-dropdown-toggle="theme-dropdown-menu" type="button" class="group p-2 w-10 h-10 text-default hover:bg-gray-100 dark:hover:bg-page focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600 rounded-lg flex items-center justify-center"> <svg viewBox="0 0 24 24" id="theme_icon_system" class="w-5 h-5 text-default fill-current group-hover:text-secondary hidden" astro-icon="tabler:device-laptop"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="icon-tabler"><path d="M3 19h18"/><rect width="14" height="10" x="5" y="6" rx="1"/></g></svg> <svg viewBox="0 0 24 24" id="theme_icon_dark" class="w-5 h-5 text-default fill-current group-hover:text-secondary hidden" astro-icon="tabler:moon"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3h.393a7.5 7.5 0 0 0 7.92 12.446A9 9 0 1 1 12 2.992z"/></svg> <svg viewBox="0 0 24 24" id="theme_icon_light" class="w-5 h-5 text-default fill-current group-hover:text-secondary hidden" astro-icon="tabler:sun"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="icon-tabler"><circle cx="12" cy="12" r="4"/><path d="M3 12h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></g></svg> </button> <!-- Dropdown --> <div class="z-50 hidden my-4 text-base list-none bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-gray-700" id="theme-dropdown-menu"> <ul class="py-2 font-medium" role="none"> <li class="hover:bg-gray-100 dark:hover:bg-gray-600"> <button class="flex px-4 py-2 text-sm align-text-center dark:hover:text-white text-default" id="theme_button_light"> <svg viewBox="0 0 24 24" class="w-5 h-5 fill-current" astro-icon="tabler:sun"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="icon-tabler"><circle cx="12" cy="12" r="4"/><path d="M3 12h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></g></svg> <span class="ml-2 dark:hover:text-white">Light</span> </button> </li> <li class="hover:bg-gray-100 dark:hover:bg-gray-600"> <button class="flex px-4 py-2 text-sm align-text-center dark:hover:text-white text-default" id="theme_button_dark"> <svg viewBox="0 0 24 24" class="w-5 h-5" astro-icon="tabler:moon"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3h.393a7.5 7.5 0 0 0 7.92 12.446A9 9 0 1 1 12 2.992z"/></svg> <span class="ml-2 text-default dark:hover:text-white">Dark</span> </button> </li> <li class="hover:bg-gray-100 dark:hover:bg-gray-600"> <button class="flex px-4 py-2 text-sm align-text-center dark:hover:text-white text-default" id="theme_button_system"> <svg viewBox="0 0 24 24" class="w-5 h-5" astro-icon="tabler:device-laptop"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="icon-tabler"><path d="M3 19h18"/><rect width="14" height="10" x="5" y="6" rx="1"/></g></svg> <span class="ml-2 dark:hover:text-white">System</span> </button> </li> </ul> </div> <script>
  (async () => {
    const { setTheme } = await import('/js/theme.js');
    // Use setTheme here
    // Change the icons inside the button based on previous settings
    // 如果 localStorage 里面有设置过 color-theme 的值, 则 themeToggleSystemIcon.classList.remove('hidden')
    function setThemeButton() {
      let theme = localStorage.getItem('color-theme');
      if (theme === 'dark') {
        themeToggleDarkIcon.classList.remove('hidden');
        themeToggleLightIcon.classList.add('hidden');
        themeToggleSystemIcon.classList.add('hidden');
      } else if (theme === 'light') {
        themeToggleDarkIcon.classList.add('hidden');
        themeToggleLightIcon.classList.remove('hidden');
        themeToggleSystemIcon.classList.add('hidden');
      } else {
        themeToggleDarkIcon.classList.add('hidden');
        themeToggleLightIcon.classList.add('hidden');
        themeToggleSystemIcon.classList.remove('hidden');
      }
    }

    // 监听暗黑模式的变化
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (event) => {
      setThemeButton();
    });

    // 保证其他的页面也能够监听到 localStorage 的变化
    window.addEventListener('storage', function (event) {
      if (event.key === 'color-theme') {
        setThemeButton();
      }
    });

    function resetTheme() {
      setTheme();
      setThemeButton();
    }

    // 获取按钮
    var themeButtonLight = document.getElementById('theme_button_light');
    var themeButtonDark = document.getElementById('theme_button_dark');
    var themeButtonSystem = document.getElementById('theme_button_system');
    // 获取图标
    var themeToggleDarkIcon = document.getElementById('theme_icon_dark');
    var themeToggleLightIcon = document.getElementById('theme_icon_light');
    var themeToggleSystemIcon = document.getElementById('theme_icon_system');

    // Listen for clicks on the button themeToggleDarkIcon
    themeButtonDark.addEventListener('click', function () {
      localStorage.setItem('color-theme', 'dark');
      resetTheme();
    });

    // // Listen for clicks on the button themeToggleLightIcon
    themeButtonLight.addEventListener('click', function () {
      localStorage.setItem('color-theme', 'light');
      resetTheme();
    });

    // // Listen for clicks on the button themeToggleSystemIcon
    themeButtonSystem.addEventListener('click', function () {
      localStorage.removeItem('color-theme');
      resetTheme();
    });

    resetTheme();
  })();
</script> <link rel="stylesheet" href="/style/docsearch.css"><div id="docsearch" class="group w-10 h-10 text-default hover:bg-gray-100 dark:hover:bg-page focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600 rounded-lg flex items-center justify-center"></div> </div> <button data-collapse-toggle="navbar-solid-bg" type="button" class="inline-flex items-center p-2 mx-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-solid-bg" aria-expanded="false" id="navbar-toggle-button"> <span class="sr-only">Open main menu</span> <svg class="w-5 h-5 text-default" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14"> <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"></path> </svg> </button> <nav class="hidden w-full md:block md:w-auto px-4 z-40" id="navbar-solid-bg"> <ul class="flex flex-col font-bold mt-4 rounded-lg bg-gray-50 md:space-x-8 rtl:space-x-reverse md:flex-row md:mt-0 md:border-0 md:bg-transparent dark:bg-gray-800 md:dark:bg-transparent dark:border-gray-700"> <a href="/zh/" class="block py-2 px-3 md:p-0 rounded  text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent"> 首页 </a><a href="/zh/posts/" class="block py-2 px-3 md:p-0 rounded text-invert bg-secondary md:bg-transparent md:text-secondary md:dark:bg-transparent" aria-current="page"> 文章 </a><a href="/zh/weekly/" class="block py-2 px-3 md:p-0 rounded  text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent"> 周报 </a><a href="/zh/snippet/" class="block py-2 px-3 md:p-0 rounded  text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent"> 小贴士 </a><a href="/zh/about/" class="block py-2 px-3 md:p-0 rounded  text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent"> 关于 </a> </ul> </nav>  </div> </div> <div id="placeholder" class="hidden" data-astro-cid-4wsjtibl></div> </div> <script>(function(){const enableSticky = true;
const enableStickyInMobile = true;

  window.onload = function () {
    checkStickyHeader();
    stickySetup();
  };

  window.addEventListener('resize', stickySetup);

  function checkStickyHeader() {
    const title = document.getElementById('blogTitle');
    const stickyHeader = document.getElementById('stickyHeader');
    const placeholder = document.getElementById('placeholder');

    if (title && stickyHeader && placeholder) {
      const offset = title.offsetTop + title.offsetHeight;

      if (shouldStick() && window.scrollY >= offset) {
        stickyHeader.classList.add('sticky');
        placeholder.style.display = 'block';
        placeholder.style.height = `${stickyHeader.offsetHeight}px`;
      } else {
        stickyHeader.classList.remove('sticky');
        placeholder.style.display = 'none';
      }
    }
  }

  function shouldStick() {
    if (!enableSticky) return false;

    let isMobile = window.matchMedia('(max-width: 640px)').matches;
    if (isMobile && !enableStickyInMobile) return false;

    return true;
  }

  function stickySetup() {
    window.onscroll = checkStickyHeader;
  }
})();</script>  </header> <main class="w-full mx-auto max-w-3xl p-4 md:p-6 "> <div class="container mx-auto space-y-6 sm:space-y-12">   <div class="mx-auto space-y-4 text-center py-10" style="width:80%"> <div class="flex mx-auto justify-center"> <div class="flex mx-auto justify-center"> <a class="text-xs font-medium sm:font-semibold mx-2 text-muted hover:text-secondary" href="/zh/tags/SwiftUI/">
#SwiftUI </a> <a class="text-xs font-medium sm:font-semibold mx-2 text-muted hover:text-secondary" href="/en/posts/exploring-swiftui-property-wrappers-3/" id="language-switcher-for-topic"> #English </a> </div> </div> <h1 class="text-2xl font-bold leadi md:text-3xl text-heading">探讨 SwiftUI 中的属性包装器：@FetchRequest、@SectionedFetchRequest、@Query、@Namespace、@Bindable</h1> <p class="text-sm text-default"> <a itemprop="author" href="https://x.com/intent/follow?screen_name=fatbobman" target="_blank" class="hover:text-secondary font-medium">东坡肘子</a> <!-- <time datetime={`${post.data.publishDate.toISOString()}`}>{date}</time> --> </p> <p class="text-xs text-muted"> 发表于 <time datetime="2024-02-01T04:00:00.000Z">2024 年 2 月 1 日</time>  </p> </div> <svg style="display: none;"> <symbol id="icon-clipboard" viewBox="0 0 1024 1024"> <path d="M426.666667 42.666667l170.666667 0q41.344 0 74.325333 23.850667t46.336 61.482667l50.005333 0q52.992 0 90.496 37.504t37.504 90.496l0 597.333333q0 52.992-37.504 90.496t-90.496 37.504l-512 0q-52.992 0-90.496-37.504t-37.504-90.496l0-597.333333q0-52.992 37.504-90.496t90.496-37.504l50.005333 0q13.312-37.674667 46.336-61.482667t74.325333-23.850667zM768 213.333333l-50.005333 0q-13.312 37.674667-46.336 61.482667t-74.325333 23.850667l-170.666667 0q-41.344 0-74.325333-23.850667t-46.336-61.482667l-50.005333 0q-17.664 0-30.165333 12.501333t-12.501333 30.165333l0 597.333333q0 17.664 12.501333 30.165333t30.165333 12.501333l512 0q17.664 0 30.165333-12.501333t12.501333-30.165333l0-597.333333q0-17.664-12.501333-30.165333t-30.165333-12.501333zM597.333333 128l-170.666667 0q-17.664 0-30.165333 12.501333t-12.501333 30.165333 12.501333 30.165333 30.165333 12.501333l170.666667 0q17.664 0 30.165333-12.501333t12.501333-30.165333-12.501333-30.165333-30.165333-12.501333z"></path> </symbol> <symbol id="icon-check" viewBox="0 0 1024 1024"> <path d="M421.858 683.366l401.796-448.518c18.66-20.828 50.668-22.586 71.498-3.928 20.828 18.66 22.586 50.67 3.928 71.498L463.638 788.494c-18.606 20.768-50.5 22.586-71.344 4.066l-263.29-233.924c-20.906-18.572-22.796-50.576-4.222-71.48 18.574-20.906 50.576-22.796 71.48-4.222L421.86 683.366z"></path> </symbol> </svg> <div class="relative" id="article-area"> <article class="prose dark:prose-invert mx-auto w-full"> <div> 
<p>在本文中，我们将对 <code>@FetchRequest</code>、<code>@SectionedFetchRequest</code>、<code>@Query</code>、 <code>@Namespace</code> 和 <code>@Bindable</code> 等属性包装器进行探讨。这些属性包装器涵盖了在视图中对 Core Data 和 SwiftData 数据进行检索以及在视图中创建命名空间等功能。</p>
<blockquote>
<p>本文旨在提供对这些属性包装器的主要功能和使用注意事项的概述，而非详尽的使用指南。</p>
</blockquote>
<ul>
<li><a href="/zh/posts/exploring-key-property-wrappers-in-swiftui/" target="_blank">@State、@Binding、@StateObject、@ObservedObject、@EnvironmentObject、@Environment</a></li>
<li><a href="/zh/posts/exploring-swiftui-property-wrappers-2/" target="_blank">@AppStorage、@SceneStorage、@FocusState、@GestureState、@ScaledMetric</a></li>
<li><a href="/zh/posts/exploring-swiftui-property-wrappers-4/" target="_blank">@UIApplicationDelegateAdaptor, @AccessibilityFocusState, @FocusedObject, @FocusedValue, @FocusedBinding</a></li>
</ul>
<div class="dynamic-ad-container pt-4"></div>
<h2 id="1-fetchrequest">1. @FetchRequest</h2>
<p>在 SwiftUI 中，<code>@FetchRequest</code> 用于在视图中检索 Core Data 的实体数据。它可以简化从持久化存储中检索数据的过程，并在数据发生变化时自动更新视图。</p>
<h3 id="11-基本用法">1.1 基本用法</h3>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">@FetchRequest</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">    sortDescriptors</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> [</span><span style="color:#8BE9FD">NSSortDescriptor</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">keyPath</span><span style="color:#F8F8F2">: \Item.timestamp, </span><span style="color:#8BE9FD">ascending</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">)],</span></span>
<span class="line"><span style="color:#F8F8F2">    predicate</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> nil</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    animation</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> .default)</span></span>
<span class="line"><span style="color:#FF79C6">private</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> items: FetchedResults&lt;Item&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">List {</span></span>
<span class="line"><span style="color:#8BE9FD">    ForEach</span><span style="color:#F8F8F2">(items) { item </span><span style="color:#FF79C6">in</span></span>
<span class="line"><span style="color:#FF79C6">        if</span><span style="color:#FF79C6"> let</span><span style="color:#F8F8F2"> timestamp </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> item.timestamp {</span></span>
<span class="line"><span style="color:#F8F8F2">            NavigationLink {</span></span>
<span class="line"><span style="color:#8BE9FD">                Text</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Item at </span><span style="color:#FF79C6">\(</span><span style="color:#F1FA8C">timestamp, format</span><span style="color:#FF79C6">:</span><span style="color:#F1FA8C"> .</span><span style="color:#F8F8F2">dateTime</span><span style="color:#FF79C6">)</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">            } label</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#8BE9FD">                Text</span><span style="color:#F8F8F2">(timestamp, </span><span style="color:#8BE9FD">format</span><span style="color:#F8F8F2">: .dateTime)</span></span>
<span class="line"><span style="color:#F8F8F2">            }</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<h3 id="12-主要功能">1.2 主要功能</h3>
<ul>
<li><code>@FetchRequest</code> 使得从 Core Data 中检索数据变得简单直接。开发者可以定义实体类型、排序描述符和谓词来过滤结果。</li>
<li>在 Core Data 中的数据发生任何变动时，<code>@FetchRequest</code> 能够自动更新其检索结果，确保视图与数据间的实时同步。</li>
<li>与 SwiftUI 的声明式编程模型紧密结合，<code>@FetchRequest</code> 提供了一种更为自然和流畅的方式，用于将数据驱动的界面融入应用中。</li>
</ul>
<h3 id="13-注意事项与使用技巧">1.3 注意事项与使用技巧</h3>
<ul>
<li>在使用 <code>@FetchRequest</code> 前，确保当前视图环境中已注入了托管对象上下文。</li>
<li>下面的示例展示了如何在构造器中根据特定参数设置过滤和排序条件：</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">@FetchRequest</span></span>
<span class="line"><span style="color:#FF79C6">private</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> items: FetchedResults&lt;Item&gt;</span></span>
<span class="line"><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B;font-style:italic">startDate</span><span style="color:#F8F8F2">:Date,</span><span style="color:#50FA7B;font-style:italic">endDate</span><span style="color:#F8F8F2">:Date) {</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> predicate </span><span style="color:#FF79C6">=</span><span style="color:#8BE9FD"> NSPredicate</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">format</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">timestamp &gt;= %@ AND timestamp &lt;= %@</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, startDate </span><span style="color:#FF79C6">as</span><span style="color:#8BE9FD;font-style:italic"> CVarArg</span><span style="color:#F8F8F2">,endDate </span><span style="color:#FF79C6">as</span><span style="color:#8BE9FD;font-style:italic"> CVarArg</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">    _items </span><span style="color:#FF79C6">=</span><span style="color:#8BE9FD"> FetchRequest</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#8BE9FD">        entity</span><span style="color:#F8F8F2">: Item.</span><span style="color:#8BE9FD">entity</span><span style="color:#F8F8F2">(),</span></span>
<span class="line"><span style="color:#8BE9FD">        sortDescriptors</span><span style="color:#F8F8F2">: [.</span><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">key</span><span style="color:#F8F8F2">: </span><span style="color:#8BE9FD">#keyPath</span><span style="color:#F8F8F2">(Item.timestamp), </span><span style="color:#8BE9FD">ascending</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">)],</span></span>
<span class="line"><span style="color:#8BE9FD">        predicate</span><span style="color:#F8F8F2">: predicate</span></span>
<span class="line"><span style="color:#F8F8F2">    )</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<ul>
<li>从 iOS 15 起，开发者可在视图中动态调整 <code>@FetchRequest</code> 的过滤和排序条件。但需注意，在 <code>.onAppear</code> 和 <code>.task</code> 中，此方法不适用。它通常用于根据用户操作动态更新视图。</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#8BE9FD">Button</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">abc</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">    $items.nsPredicate.wrappedValue </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> .</span><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">value</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">false</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">    $items.sortDescriptors.wrappedValue </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> [.</span><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(\Item.timestamp, </span><span style="color:#8BE9FD">order</span><span style="color:#F8F8F2">: .reverse)]</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<ul>
<li>若要进行更复杂的配置，推荐使用 NSFetchRequest 实例创建 <code>@FetchRequest</code>：</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">extension</span><span style="color:#8BE9FD;font-style:italic"> Item</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">    static</span><span style="color:#FF79C6"> let</span><span style="color:#F8F8F2"> noFaultRequest: NSFetchRequest </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">        let</span><span style="color:#F8F8F2"> request </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> NSFetchRequest</span><span style="color:#FF79C6">&lt;</span><span style="color:#F8F8F2">Item</span><span style="color:#FF79C6">&gt;</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">entityName</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Item</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">        request.predicate </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> nil</span></span>
<span class="line"><span style="color:#F8F8F2">        request.sortDescriptors </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> [.</span><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">keyPath</span><span style="color:#F8F8F2">: \Item.timestamp, </span><span style="color:#8BE9FD">ascending</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">)]</span></span>
<span class="line"><span style="color:#F8F8F2">        request.returnsObjectsAsFaults </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> false</span></span>
<span class="line"><span style="color:#FF79C6">        return</span><span style="color:#F8F8F2"> request</span></span>
<span class="line"><span style="color:#F8F8F2">    }()</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">@FetchRequest</span><span style="color:#F8F8F2">(fetchRequest</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> Item.noFaultRequest)</span></span>
<span class="line"><span style="color:#FF79C6">private</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> items: FetchedResults&lt;Item&gt;</span></span></code></pre></div>
<ul>
<li><code>@FetchRequest</code> 中的 <code>animation</code> 参数决定了数据变化时界面更新的动画效果。<code>.none</code> 和 <code>nil</code> 均表示无动画。</li>
<li>使用 List 展示数据时，List 会忽略 <code>@FetchRequest</code> 设置的动画效果，而使用组件默认动画。</li>
<li>开发者可以用 <code>withAnimation</code> 函数覆盖 <code>@FetchRequest</code> 中设定的动画效果，如下所示：</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#8BE9FD">withAnimation</span><span style="color:#F8F8F2">(.</span><span style="color:#BD93F9">none</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> newItem </span><span style="color:#FF79C6">=</span><span style="color:#8BE9FD"> Item</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">context</span><span style="color:#F8F8F2">: viewContext)</span></span>
<span class="line"><span style="color:#F8F8F2">    newItem.timestamp </span><span style="color:#FF79C6">=</span><span style="color:#8BE9FD"> Date</span><span style="color:#F8F8F2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">    do</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">        try</span><span style="color:#F8F8F2"> viewContext.</span><span style="color:#8BE9FD">save</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">    } </span><span style="color:#FF79C6">catch</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<ul>
<li><code>@FetchRequest</code> 是 SwiftUI 对 NSFetchedResultsController 的封装，其主要功能和性能与后者基本一致。</li>
<li>与 NSFetchedResultsController 相同，<code>@FetchRequest</code> 仅支持返回 NSManagedObject 类型的集合，不支持其他 NSFetchRequestResult 类型（如数字、NSManagedObjectID、字典）。</li>
<li><code>@FetchRequest</code> 的生命周期与视图的存续期紧密相关。它在视图加载到视图树时开始检索数据，并在视图移除时停止。</li>
<li>相比在 ViewModel 中获取 Core Data 实体数据，<code>@FetchRequest</code> 更紧密地与视图的生命周期绑定，几乎无首次加载延迟。</li>
<li>在首次获取数据后，<code>@FetchRequest</code>（NSFetchedResultsController）会根据托管对象上下文的合并信息更新数据集。因此，基于 <code>fetchLimit</code> 的设置无法保证在后续数据变化时始终有效。</li>
<li>关于 <code>@FetchRequest</code> 的工作原理，详见 <a href="/zh/posts/modern-core-data-fetcher/" target="_blank">SwiftUI 与 Core Data —— 数据获取</a>。</li>
<li>FetchedResults 是 NSFetchRequestResult 的封装，遵循 RandomAccessCollection 协议，允许通过下标方式访问数据。</li>
<li>FetchedResults 提供了一个 <code>publisher</code> 属性，一旦结果集数据发生变化，该 Publisher 会发送整个数据集。因此，不建议订阅此属性以监控数据集变化，以避免冗余操作。</li>
<li>在 SwiftUI 开发中，推荐将展示 <code>to-Many</code> 数据的界面单独封装成独立的视图，并通过 <code>@FetchRequest</code> 来获取数据。这种做法不仅确保了数据获取顺序的稳定性，还能及时响应数据变化，并使视图更新更加高效。详情请参阅 <a href="/zh/posts/mastering-relationships-in-core-data-practical/" target="_blank">掌握 Core Data 中的关系：实战</a>。</li>
</ul>
<h2 id="2-sectionedfetchrequest">2. @SectionedFetchRequest</h2>
<p>在 SwiftUI 中，<code>@SectionedFetchRequest</code> 属性包装器提供了一种便捷的方式来处理并展示按照特定标准分组的 Core Data 查询结果。这使得开发者能够在界面上以分组形式展示复杂的数据结构。</p>
<h3 id="21-基本用法">2.1 基本用法</h3>
<p>以下是一个 <code>@SectionedFetchRequest</code> 的基本使用示例：</p>
<p><picture>
                    <source media="(max-width: 479px)" srcset="https://cdn.fatbobman.com/image-20240122162612483.png?imageView2/0/w/500"/>
                    <source media="(max-width: 767px)" srcset="https://cdn.fatbobman.com/image-20240122162612483.png?imageView2/0/w/768"/>
                    <source media="(max-width: 1024px)" srcset="https://cdn.fatbobman.com/image-20240122162612483.png?imageView2/0/w/1024"/>
                    <img src="https://cdn.fatbobman.com/image-20240122162612483.png" alt="image-20240122162612483" loading="lazy" decoding="async"/>
                  </picture></p>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">@SectionedFetchRequest</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">    entity</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> Item.</span><span style="color:#8BE9FD">entity</span><span style="color:#F8F8F2">(),</span></span>
<span class="line"><span style="color:#F8F8F2">    sectionIdentifier</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> \Item.categoryID,</span></span>
<span class="line"><span style="color:#F8F8F2">    sortDescriptors</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> [</span></span>
<span class="line"><span style="color:#F8F8F2">        .</span><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">keyPath</span><span style="color:#F8F8F2">: \Item.categoryID, </span><span style="color:#8BE9FD">ascending</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">        .</span><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">keyPath</span><span style="color:#F8F8F2">: \Item.timestamp, </span><span style="color:#8BE9FD">ascending</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">    ]</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#FF79C6">var</span><span style="color:#F8F8F2"> sectionItems: SectionedFetchResults&lt;</span><span style="color:#8BE9FD;font-style:italic">Int16</span><span style="color:#F8F8F2">, Item&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD">ForEach</span><span style="color:#F8F8F2">(sectionItems) { section </span><span style="color:#FF79C6">in</span></span>
<span class="line"><span style="color:#8BE9FD">    Section</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">header</span><span style="color:#F8F8F2">: </span><span style="color:#8BE9FD">Text</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#FF79C6">\(</span><span style="color:#F1FA8C">section.</span><span style="color:#F8F8F2">id</span><span style="color:#FF79C6">)</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)) {</span></span>
<span class="line"><span style="color:#8BE9FD">        ForEach</span><span style="color:#F8F8F2">(section) { item </span><span style="color:#FF79C6">in</span></span>
<span class="line"><span style="color:#8BE9FD">            Row</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">item</span><span style="color:#F8F8F2">: item)</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<p>这段代码演示了如何根据 <code>Item</code> 实体的 <code>categoryID</code> 属性创建一个分组的 <code>SectionedFetchRequest</code>，并根据预设的规则进行排序。</p>
<p><code>SectionedFetchResults</code> 是一个包含两个泛型参数的结构体。第一个参数定义了用作分组标识（section identifier）的属性类型，而第二个参数指定了托管对象的实体类型</p>
<h3 id="22-主要功能">2.2 主要功能</h3>
<ul>
<li>
<p><code>@SectionedFetchRequest</code> 允许开发者按照特定属性将查询结果分组，从而在 SwiftUI 视图中以分组形式展示。</p>
</li>
<li>
<p>除了支持分组外，其他特征与 <code>@FetchRequest</code> 基本一致。</p>
</li>
</ul>
<h3 id="23-注意事项与使用技巧">2.3 注意事项与使用技巧</h3>
<ul>
<li>大部分适用于 <code>@FetchRequest</code> 的注意事项和技巧同样适用于 <code>@SectionedFetchRequest</code>。</li>
<li>使用 <code>@SectionedFetchRequest</code> 时，必须指定一个用于分组的属性，该属性类型应能被清晰地用于分区，如 String 或 Int 类型。</li>
<li>为确保分组的准确顺序，构建 <code>sortDescriptors</code> 时，应将用于 <code>sectionIdentifier</code> 的属性作为第一排序选项：</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#F8F8F2">sortDescriptors</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> [</span></span>
<span class="line"><span style="color:#F8F8F2">    .</span><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">keyPath</span><span style="color:#F8F8F2">: \Item.categoryID, </span><span style="color:#8BE9FD">ascending</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">    .</span><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">keyPath</span><span style="color:#F8F8F2">: \Item.timestamp, </span><span style="color:#8BE9FD">ascending</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">]</span></span></code></pre></div>
<ul>
<li>对于难以进行精确分组的属性类型，建议为实体创建一个专门的属性以便分类。例如，可以为 <code>timestamp</code> 增加一个 Int16 类型的 <code>year</code> 属性，以便按年份进行分组。</li>
<li>在 SwiftUI 中，嵌套的 <code>ForEach</code> 可能会影响惰性容器的性能优化。通过添加 <code>Section</code>，可以避免 <code>ForEach</code> 的递归展开，提高性能。具体细节可参考 <a href="https://developer.apple.com/videos/play/wwdc2023/10160/?&#38;utm_source=Fatbobman%20Blog&#38;utm_medium=web&#38;utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">Demystify SwiftUI performance</a>。例如，在以下代码中，如果去除 <code>Section</code>，SwiftUI 将一次性为结果集中的每个数据项构建子视图：</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#8BE9FD">ForEach</span><span style="color:#F8F8F2">(sectionItems) { section </span><span style="color:#FF79C6">in</span></span>
<span class="line"><span style="color:#6272A4">    // Section(header: Text(&quot;\(section.id)&quot;)) {</span></span>
<span class="line"><span style="color:#8BE9FD">        ForEach</span><span style="color:#F8F8F2">(section) { item </span><span style="color:#FF79C6">in</span></span>
<span class="line"><span style="color:#8BE9FD">            Row</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">item</span><span style="color:#F8F8F2">: item)</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#6272A4">    // }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<h2 id="3-query">3. @Query</h2>
<p>在 SwiftUI 中，<code>@Query</code> 用于在视图中检索 SwiftData 的实体数据。它可以简化从持久化存储中检索数据的过程，并在数据发生变化时自动更新视图。</p>
<h3 id="31-基本用法">3.1 基本用法</h3>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">@Query</span><span style="color:#F8F8F2">(sort</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> \Item.timestamp, animation</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> .default)</span></span>
<span class="line"><span style="color:#FF79C6">private</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> items: [Item]</span></span></code></pre></div>
<h3 id="32-注意事项与使用技巧">3.2 注意事项与使用技巧</h3>
<ul>
<li><code>@Query</code> 可以被视为 SwiftData 环境中 <code>@FetchRequest</code> 的对应版本。然而，与 <code>@FetchRequest</code> 不同的是，<code>@Query</code> 不支持在视图内动态修改查询的谓词和排序条件。</li>
<li><code>@FetchRequest</code> 与 <code>@Query</code> 之间的对比如下：
<ul>
<li>Core Data 的 NSFetchRequest 对应于 SwiftData 的 <a href="https://developer.apple.com/documentation/swiftdata/fetchdescriptor?&#38;utm_source=Fatbobman%20Blog&#38;utm_medium=web&#38;utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">FetchDescriptor</a>。</li>
<li>NSSortDescriptor 对应于 <a href="https://developer.apple.com/documentation/foundation/sortdescriptor?&#38;utm_source=Fatbobman%20Blog&#38;utm_medium=web&#38;utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">SortDescriptor</a>（后者也可用于 <code>@FetchRequest</code>）。</li>
<li>NSPredicate 对应于 Foundation 的 <a href="https://developer.apple.com/documentation/foundation/predicate?&#38;utm_source=Fatbobman%20Blog&#38;utm_medium=web&#38;utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">Predicate</a>。</li>
<li>参数方面，<code>@FetchRequest</code> 的 predicate 对应于 <code>@Query</code> 的 filter。</li>
</ul>
</li>
<li>在 <code>@Predicate</code> 宏中，不可以直接调用外部方法、函数或计算属性。应先在宏外计算好数值，再作为谓词条件在宏中使用：</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#6272A4">// 示例一：错误方式</span></span>
<span class="line"><span style="color:#FF79C6">@Query</span></span>
<span class="line"><span style="color:#FF79C6">private</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> items: [Item]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> predicate </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> #Predicate</span><span style="color:#FF79C6">&lt;</span><span style="color:#F8F8F2">Item</span><span style="color:#FF79C6">&gt;</span><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#BD93F9;font-style:italic">        $0</span><span style="color:#F8F8F2">.timestamp </span><span style="color:#FF79C6">&lt;</span><span style="color:#F8F8F2"> Date.now </span><span style="color:#6272A4">// 无法编译</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">    _items </span><span style="color:#FF79C6">=</span><span style="color:#8BE9FD"> Query</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#8BE9FD">        filter</span><span style="color:#F8F8F2">: predicate,</span></span>
<span class="line"><span style="color:#8BE9FD">        sort</span><span style="color:#F8F8F2">:\Item.timestamp,</span></span>
<span class="line"><span style="color:#8BE9FD">        order</span><span style="color:#F8F8F2">: .forward,</span></span>
<span class="line"><span style="color:#8BE9FD">        animation</span><span style="color:#F8F8F2">: .default</span></span>
<span class="line"><span style="color:#F8F8F2">    )</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// 示例一：正确方式</span></span>
<span class="line"><span style="color:#FF79C6">let</span><span style="color:#F8F8F2"> now </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> Date.now</span></span>
<span class="line"><span style="color:#FF79C6">let</span><span style="color:#F8F8F2"> predicate </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> #Predicate</span><span style="color:#FF79C6">&lt;</span><span style="color:#F8F8F2">Item</span><span style="color:#FF79C6">&gt;</span><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#BD93F9;font-style:italic">    $0</span><span style="color:#F8F8F2">.timestamp </span><span style="color:#FF79C6">&lt;</span><span style="color:#F8F8F2"> now</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// 示例二：错误方式</span></span>
<span class="line"><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B;font-style:italic">item</span><span style="color:#F8F8F2">: Item) {</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> predicate </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> #Predicate</span><span style="color:#FF79C6">&lt;</span><span style="color:#F8F8F2">Item</span><span style="color:#FF79C6">&gt;</span><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#BD93F9;font-style:italic">        $0</span><span style="color:#F8F8F2">.timestamp </span><span style="color:#FF79C6">&lt;</span><span style="color:#F8F8F2"> item.timestamp </span><span style="color:#6272A4">// 无法编译</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">    _items </span><span style="color:#FF79C6">=</span><span style="color:#8BE9FD"> Query</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#8BE9FD">        filter</span><span style="color:#F8F8F2">: predicate,</span></span>
<span class="line"><span style="color:#8BE9FD">        sort</span><span style="color:#F8F8F2">:\Item.timestamp,</span></span>
<span class="line"><span style="color:#8BE9FD">        order</span><span style="color:#F8F8F2">: .forward,</span></span>
<span class="line"><span style="color:#8BE9FD">        animation</span><span style="color:#F8F8F2">: .default</span></span>
<span class="line"><span style="color:#F8F8F2">    )</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// 示例二：正确方式</span></span>
<span class="line"><span style="color:#FF79C6">init</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B;font-style:italic">item</span><span style="color:#F8F8F2">: Item) {</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> startDate </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> item.timestamp</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> predicate </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> #Predicate</span><span style="color:#FF79C6">&lt;</span><span style="color:#F8F8F2">Item</span><span style="color:#FF79C6">&gt;</span><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#BD93F9;font-style:italic">        $0</span><span style="color:#F8F8F2">.timestamp </span><span style="color:#FF79C6">&lt;</span><span style="color:#F8F8F2"> startDate</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<ul>
<li>SwiftData 并未提供类似于 NSFetchedResultsController 的功能，用于在视图外部进行数据检索并根据数据变化自动更新数据集。对于这种需求，可以考虑使用 Persistent History Tracking。更多详情请参考 <a href="/zh/posts/persistent-history-tracking-in-swiftdata/" target="_blank">如何通过 Persistent History Tracking 观察 SwiftData 的数据变化</a>。</li>
</ul>
<blockquote>
<p>在上文中介绍的三个属性包装器都是在 SQLite 端执行数据的筛选、排序和分组操作，这种做法在效率和系统资源占用方面都优于在内存中使用 Swift 的高阶函数进行相同操作。</p>
</blockquote>
<h2 id="4-namespace">4. @Namespace</h2>
<p><code>@Namespace</code> 属性包装器用于创建一个唯一标识符，使得我们可以对视图或元素进行有效的分组和区分。</p>
<h3 id="41-基本用法">4.1 基本用法</h3>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">@Namespace</span><span style="color:#FF79C6"> private</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> namespace</span></span></code></pre></div>
<h3 id="42-主要功能">4.2 主要功能</h3>
<ul>
<li>每个 <code>@Namespace</code> 属性包装器都将创建一个唯一标识符，该标识符在创建后在其生命周期中保持不变。</li>
<li><code>@Namespace</code> 通常会结合其他的 <code>id</code> 信息共同为视图进行标注。这种方式可以在不改变 <code>id</code> 的情况下，为视图增加更多的可识别信息。</li>
</ul>
<h3 id="43-注意事项与使用技巧">4.3 注意事项与使用技巧</h3>
<ul>
<li>创建了 <code>@Namespace</code> 标识符之后，你可以将其传递到其他视图中使用：</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">struct</span><span style="color:#8BE9FD;font-style:italic"> ParentView</span><span style="color:#F8F8F2">: View {</span></span>
<span class="line"><span style="color:#FF79C6">    @Namespace</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> namespace</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> id </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">1</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#FF79C6">    var</span><span style="color:#F8F8F2"> body: </span><span style="color:#FF79C6">some</span><span style="color:#F8F8F2"> View {</span></span>
<span class="line"><span style="color:#F8F8F2">        VStack {</span></span>
<span class="line"><span style="color:#8BE9FD">            Rectangle</span><span style="color:#F8F8F2">().</span><span style="color:#8BE9FD">frame</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">width</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">200</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">height</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">200</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">                .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: id, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace)</span></span>
<span class="line"><span style="color:#8BE9FD">            SubView3</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">namespace</span><span style="color:#F8F8F2">: namespace, </span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: id)</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">struct</span><span style="color:#8BE9FD;font-style:italic"> SubView</span><span style="color:#F8F8F2">: View {</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> namespace: Namespace.ID</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> id: </span><span style="color:#8BE9FD;font-style:italic">String</span></span>
<span class="line"><span style="color:#FF79C6">    var</span><span style="color:#F8F8F2"> body: </span><span style="color:#FF79C6">some</span><span style="color:#F8F8F2"> View {</span></span>
<span class="line"><span style="color:#8BE9FD">        Rectangle</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">            .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: id, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace, </span><span style="color:#8BE9FD">properties</span><span style="color:#F8F8F2">: .</span><span style="color:#BD93F9">size</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">isSource</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">false</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<ul>
<li>虽然开发者在多数情况下会将 <code>@Namespace</code> 与 <code>matchedGeometryEffect</code> 结合使用，但重要的是要理解 <code>@Namespace</code> 本身仅扮演着标识符的角色，并不直接参与几何信息处理或动画过渡的具体实现。</li>
<li><code>@Namespace</code> 不仅限于与 <code>matchedGeometryEffect</code> 搭配使用，还可以用于其他元素或视图修饰器，如 <code>accessibilityRotorEntry</code>、<code>AccessibilityRotorEntry</code>、 <code>accessibilityLinkedGroup</code> 、<code>prefersDefaultFocus</code> 和 <code>defaultFocus</code>。</li>
<li>在使用 <code>@Namespace</code> 的场景中，通常会出现标注视图和读取视图信息的操作成对出现的模式：</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#6272A4">// 示例一：</span></span>
<span class="line"><span style="color:#8BE9FD">Rectangle</span><span style="color:#F8F8F2">().</span><span style="color:#8BE9FD">frame</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">width</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">200</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">height</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">200</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">     .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: id, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace) </span><span style="color:#6272A4">// 标注视图</span></span>
<span class="line"><span style="color:#8BE9FD">Rectangle</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">     .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: id, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace, </span><span style="color:#8BE9FD">properties</span><span style="color:#F8F8F2">: .</span><span style="color:#BD93F9">size</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">isSource</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">false</span><span style="color:#F8F8F2">) </span><span style="color:#6272A4">// 读取带有特定 namespace + id 的视图的几何信息</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// 示例二：</span></span>
<span class="line"><span style="color:#F8F8F2">VStack {</span></span>
<span class="line"><span style="color:#8BE9FD">    TextField</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">email</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">text</span><span style="color:#F8F8F2">: $email)</span></span>
<span class="line"><span style="color:#F8F8F2">        .</span><span style="color:#8BE9FD">prefersDefaultFocus</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace) </span><span style="color:#6272A4">// 标注视图，该视图为 namespace 中默认获得焦点的视图</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD">    SecureField</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">password</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">text</span><span style="color:#F8F8F2">: $password)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD">    Button</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">login</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">      ...</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD">focusScope</span><span style="color:#F8F8F2">(namespace) </span><span style="color:#6272A4">// 读取 namespace 命名空间中具备默认焦点的视图信息，并将焦点设置与其上</span></span></code></pre></div>
<ul>
<li>允许为同一视图应用多个不同的 <code>namespace + id</code> 组合。例如，在下面的代码中，我们使用了相同的 <code>id</code> 但不同的 <code>namespace</code>，为同一个 <code>TrendView</code> 添加了标注。这样做为两个不同的可访问性转子（Rotor）提供了独立的标识：</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">struct</span><span style="color:#8BE9FD;font-style:italic"> TrendsView</span><span style="color:#F8F8F2">: View {</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> trends: [Trend]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">    @Namespace</span><span style="color:#FF79C6"> private</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> customRotorNamespace</span></span>
<span class="line"><span style="color:#FF79C6">    @Namespace</span><span style="color:#FF79C6"> private</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> countSpace</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">    var</span><span style="color:#F8F8F2"> body: </span><span style="color:#FF79C6">some</span><span style="color:#F8F8F2"> View {</span></span>
<span class="line"><span style="color:#F8F8F2">        VStack {</span></span>
<span class="line"><span style="color:#F8F8F2">            ScrollViewReader { scrollView </span><span style="color:#FF79C6">in</span></span>
<span class="line"><span style="color:#F8F8F2">                List {</span></span>
<span class="line"><span style="color:#8BE9FD">                    ForEach</span><span style="color:#F8F8F2">(trends, </span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: \.id) { trend </span><span style="color:#FF79C6">in</span></span>
<span class="line"><span style="color:#8BE9FD">                        TrendView</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">trend</span><span style="color:#F8F8F2">: trend)</span></span>
<span class="line"><span style="color:#F8F8F2">                            .</span><span style="color:#8BE9FD">accessibilityRotorEntry</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: trend.id, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: customRotorNamespace) </span><span style="color:#6272A4">// 标识1</span></span>
<span class="line"><span style="color:#F8F8F2">                            .</span><span style="color:#8BE9FD">accessibilityRotorEntry</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: trend.id, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: countSpace) </span><span style="color:#6272A4">// 标识2</span></span>
<span class="line"><span style="color:#F8F8F2">                            .</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">(trend.id)</span></span>
<span class="line"><span style="color:#F8F8F2">                    }</span></span>
<span class="line"><span style="color:#F8F8F2">                }</span></span>
<span class="line"><span style="color:#F8F8F2">                .</span><span style="color:#8BE9FD">accessibilityRotor</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Negative trends</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#8BE9FD">                    ForEach</span><span style="color:#F8F8F2">(trends, </span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: \.id) { trend </span><span style="color:#FF79C6">in</span></span>
<span class="line"><span style="color:#FF79C6">                        if</span><span style="color:#FF79C6"> !</span><span style="color:#F8F8F2">trend.isPositive {</span></span>
<span class="line"><span style="color:#8BE9FD">                            AccessibilityRotorEntry</span><span style="color:#F8F8F2">(trend.message, trend.id, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: customRotorNamespace) {</span></span>
<span class="line"><span style="color:#F8F8F2">                                scrollView.</span><span style="color:#8BE9FD">scrollTo</span><span style="color:#F8F8F2">(trend.id)</span></span>
<span class="line"><span style="color:#F8F8F2">                            }</span></span>
<span class="line"><span style="color:#F8F8F2">                        }</span></span>
<span class="line"><span style="color:#F8F8F2">                    }</span></span>
<span class="line"><span style="color:#F8F8F2">                }</span></span>
<span class="line"><span style="color:#F8F8F2">                .</span><span style="color:#8BE9FD">accessibilityRotor</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Count</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">){</span></span>
<span class="line"><span style="color:#8BE9FD">                    ForEach</span><span style="color:#F8F8F2">(trends,</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">:\.id){ trend </span><span style="color:#FF79C6">in</span></span>
<span class="line"><span style="color:#FF79C6">                        if</span><span style="color:#F8F8F2"> trend.</span><span style="color:#BD93F9">count</span><span style="color:#FF79C6"> %</span><span style="color:#BD93F9"> 2</span><span style="color:#FF79C6"> ==</span><span style="color:#BD93F9"> 0</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#8BE9FD">                            AccessibilityRotorEntry</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#FF79C6">\(</span><span style="color:#F1FA8C">trend.</span><span style="color:#BD93F9">count</span><span style="color:#FF79C6">)</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, trend.id, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: countSpace) {</span></span>
<span class="line"><span style="color:#F8F8F2">                                scrollView.</span><span style="color:#8BE9FD">scrollTo</span><span style="color:#F8F8F2">(trend.id)</span></span>
<span class="line"><span style="color:#F8F8F2">                            }</span></span>
<span class="line"><span style="color:#F8F8F2">                        }</span></span>
<span class="line"><span style="color:#F8F8F2">                    }</span></span>
<span class="line"><span style="color:#F8F8F2">                }</span></span>
<span class="line"><span style="color:#F8F8F2">            }</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<blockquote>
<p>有关 <code>AccessibilityRotorEntry</code> 的更多信息，请参阅 <a href="https://swiftwithmajid.com/2021/09/14/accessibility-rotors-in-swiftui/?&#38;utm_source=Fatbobman%20Blog&#38;utm_medium=web&#38;utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">Accessibility rotors in SwiftUI</a>。</p>
</blockquote>
<ul>
<li>
<p>当使用 <code>ForEach</code> 时，我们通常会使用 <code>ForEach</code> 提供的标识符作为 <code>id</code>，并通过结合不同的 <code>namespace</code> 为相同的视图或元素提供多种不同的标识。例如上面的代码。</p>
</li>
<li>
<p>在任何给定时间，应该只存在一个唯一的 <code>namespace + id</code> 组合。例如，在下面的代码中，如果运行，将会产生一个警告，因为存在多个使用相同 <code>namespace + id</code> 组合的视图：</p>
</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">struct</span><span style="color:#8BE9FD;font-style:italic"> AView</span><span style="color:#F8F8F2">:View {</span></span>
<span class="line"><span style="color:#FF79C6">    @Namespace</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> namespace</span></span>
<span class="line"><span style="color:#FF79C6">    var</span><span style="color:#F8F8F2"> body: </span><span style="color:#FF79C6">some</span><span style="color:#F8F8F2"> View {</span></span>
<span class="line"><span style="color:#F8F8F2">        VStack {</span></span>
<span class="line"><span style="color:#8BE9FD">            Rectangle</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">                .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">111</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace)</span></span>
<span class="line"><span style="color:#8BE9FD">            Rectangle</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">                .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">111</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace)</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// Multiple inserted views in matched geometry group Pair&lt;String, ID&gt;(first: &quot;111&quot;, second: SwiftUI.Namespace.ID(id: 88)) have `isSource: true`, results are undefined.</span></span></code></pre></div>
<ul>
<li>当与 <code>matchedGeometryEffect</code> 结合使用时，可以让多个视图共享同一个被标注视图的几何信息。在以下代码中，两个下方的 <code>Rectangle</code> 将与第一个 <code>Rectangle</code> 的位置重叠，因为它们共享了标记为 <code>namespace + &quot;111&quot;</code> 的视图的位置信息：</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">struct</span><span style="color:#8BE9FD;font-style:italic"> AView</span><span style="color:#F8F8F2">:View {</span></span>
<span class="line"><span style="color:#FF79C6">    @Namespace</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> namespace</span></span>
<span class="line"><span style="color:#FF79C6">    var</span><span style="color:#F8F8F2"> body: </span><span style="color:#FF79C6">some</span><span style="color:#F8F8F2"> View {</span></span>
<span class="line"><span style="color:#F8F8F2">        VStack {</span></span>
<span class="line"><span style="color:#8BE9FD">            Rectangle</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">                .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">111</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace)</span></span>
<span class="line"><span style="color:#8BE9FD">            Rectangle</span><span style="color:#F8F8F2">().</span><span style="color:#8BE9FD">fill</span><span style="color:#F8F8F2">(.red)</span></span>
<span class="line"><span style="color:#F8F8F2">                .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">111</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace,</span><span style="color:#8BE9FD">properties</span><span style="color:#F8F8F2">: .position, </span><span style="color:#8BE9FD">isSource</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">false</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#8BE9FD">            Rectangle</span><span style="color:#F8F8F2">().</span><span style="color:#8BE9FD">fill</span><span style="color:#F8F8F2">(.blue)</span></span>
<span class="line"><span style="color:#F8F8F2">                .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">111</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace,</span><span style="color:#8BE9FD">properties</span><span style="color:#F8F8F2">: .position, </span><span style="color:#8BE9FD">isSource</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">false</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<ul>
<li>在模态视图中使用 <code>matchedGeometryEffect</code> 时，若无法正确获取几何信息，这通常是由于 SwiftUI 的一个已知问题，而非 <code>@Namespace</code> 的问题。一个解决方案是将视图放入导航容器内。这样做可以确保在模态视图（如 sheet 或 fullscreenCover）中正确获取几何信息。</li>
</ul>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#6272A4">// 问题示例：无法获取几何信息</span></span>
<span class="line"><span style="color:#FF79C6">struct</span><span style="color:#8BE9FD;font-style:italic"> NaviTest</span><span style="color:#F8F8F2">: View {</span></span>
<span class="line"><span style="color:#FF79C6">    @Namespace</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> namespace</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">    @State</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> show </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> false</span></span>
<span class="line"><span style="color:#FF79C6">    var</span><span style="color:#F8F8F2"> body: </span><span style="color:#FF79C6">some</span><span style="color:#F8F8F2"> View {</span></span>
<span class="line"><span style="color:#F8F8F2">        VStack {</span></span>
<span class="line"><span style="color:#8BE9FD">            Button</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Show</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">                show.</span><span style="color:#8BE9FD">toggle</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">            }</span></span>
<span class="line"><span style="color:#F8F8F2">            .</span><span style="color:#8BE9FD">sheet</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">isPresented</span><span style="color:#F8F8F2">: $show) {</span></span>
<span class="line"><span style="color:#F8F8F2">                VStack {</span></span>
<span class="line"><span style="color:#8BE9FD">                    Rectangle</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">                        .</span><span style="color:#8BE9FD">fill</span><span style="color:#F8F8F2">(.cyan)</span></span>
<span class="line"><span style="color:#F8F8F2">                        .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">1</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace, </span><span style="color:#8BE9FD">properties</span><span style="color:#F8F8F2">: .</span><span style="color:#BD93F9">size</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">isSource</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">false</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">                }</span></span>
<span class="line"><span style="color:#F8F8F2">                .</span><span style="color:#8BE9FD">frame</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">width</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">300</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">height</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">300</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">            }</span></span>
<span class="line"><span style="color:#8BE9FD">            Rectangle</span><span style="color:#F8F8F2">().</span><span style="color:#8BE9FD">fill</span><span style="color:#F8F8F2">(.orange).</span><span style="color:#8BE9FD">frame</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">width</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">100</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">height</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">200</span><span style="color:#F8F8F2">).</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">1</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace)</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// 解决方案：在导航容器内可以正确获取几何信息</span></span>
<span class="line"><span style="color:#F8F8F2">NavigationStack {</span></span>
<span class="line"><span style="color:#F8F8F2">    VStack {</span></span>
<span class="line"><span style="color:#8BE9FD">        Button</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Show</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">            show.</span><span style="color:#8BE9FD">toggle</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">        .</span><span style="color:#8BE9FD">sheet</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">isPresented</span><span style="color:#F8F8F2">: $show) {</span></span>
<span class="line"><span style="color:#F8F8F2">            VStack {</span></span>
<span class="line"><span style="color:#8BE9FD">                Rectangle</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">                    .</span><span style="color:#8BE9FD">fill</span><span style="color:#F8F8F2">(.cyan)</span></span>
<span class="line"><span style="color:#F8F8F2">                    .</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">1</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace, </span><span style="color:#8BE9FD">properties</span><span style="color:#F8F8F2">: .</span><span style="color:#BD93F9">size</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">isSource</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">false</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">            }</span></span>
<span class="line"><span style="color:#F8F8F2">            .</span><span style="color:#8BE9FD">frame</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">width</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">300</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">height</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">300</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#8BE9FD">        Rectangle</span><span style="color:#F8F8F2">().</span><span style="color:#8BE9FD">fill</span><span style="color:#F8F8F2">(.orange).</span><span style="color:#8BE9FD">frame</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">width</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">100</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">height</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">200</span><span style="color:#F8F8F2">).</span><span style="color:#8BE9FD">matchedGeometryEffect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">id</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">1</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">in</span><span style="color:#F8F8F2">: namespace)</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<blockquote>
<p>想了解更多关于 <code>matchedGeometryEffect</code> 的细节，请参考 <a href="https://swiftui-lab.com/matchedgeometryeffect-part1/?&#38;utm_source=Fatbobman%20Blog&#38;utm_medium=web&#38;utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">MatchedGeometryEffect – Part 1 (Hero Animations)</a>。</p>
</blockquote>
<h2 id="5-bindable">5. @Bindable</h2>
<p><code>@Bindable</code> 属性包装器为创建可观察（Observable）对象实例的可变属性绑定（Binding）提供了一种便捷且高效的方式。</p>
<h3 id="51-基本用法">5.1 基本用法</h3>
<div>
        <div class="flex justify-between items-center h-8 font-medium bg-[#96744d] dark:bg-[#002565] text-gray-200 text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-white sm:hover:font-bold">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            Copy code
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#FF79C6">@Observable</span></span>
<span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> People</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">    var</span><span style="color:#F8F8F2"> name: </span><span style="color:#8BE9FD;font-style:italic">String</span></span>
<span class="line"><span style="color:#FF79C6">    var</span><span style="color:#F8F8F2"> age: </span><span style="color:#8BE9FD;font-style:italic">Int</span></span>
<span class="line"><span style="color:#FF79C6">    init</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B;font-style:italic">name</span><span style="color:#F8F8F2">: </span><span style="color:#8BE9FD;font-style:italic">String</span><span style="color:#F8F8F2">, </span><span style="color:#50FA7B;font-style:italic">age</span><span style="color:#F8F8F2">: </span><span style="color:#8BE9FD;font-style:italic">Int</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#BD93F9;font-style:italic">        self</span><span style="color:#F8F8F2">.name </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> name</span></span>
<span class="line"><span style="color:#BD93F9;font-style:italic">        self</span><span style="color:#F8F8F2">.age </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> age</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">struct</span><span style="color:#8BE9FD;font-style:italic"> PeopleView</span><span style="color:#F8F8F2">: View {</span></span>
<span class="line"><span style="color:#FF79C6">    @State</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> people </span><span style="color:#FF79C6">=</span><span style="color:#8BE9FD"> People</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">name</span><span style="color:#F8F8F2">: </span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">fat</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">age</span><span style="color:#F8F8F2">: </span><span style="color:#BD93F9">18</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#FF79C6">    var</span><span style="color:#F8F8F2"> body: </span><span style="color:#FF79C6">some</span><span style="color:#F8F8F2"> View {</span></span>
<span class="line"><span style="color:#F8F8F2">        VStack {</span></span>
<span class="line"><span style="color:#8BE9FD">            Text</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#FF79C6">\(</span><span style="color:#F1FA8C">people.</span><span style="color:#F8F8F2">name</span><span style="color:#FF79C6">)</span><span style="color:#FF79C6"> \(</span><span style="color:#F1FA8C">people.</span><span style="color:#F8F8F2">age</span><span style="color:#FF79C6">)</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#8BE9FD">            PeopleName</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">people</span><span style="color:#F8F8F2">: people)</span></span>
<span class="line"><span style="color:#8BE9FD">            PeopleAge</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">people</span><span style="color:#F8F8F2">: people)</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">struct</span><span style="color:#8BE9FD;font-style:italic"> PeopleName</span><span style="color:#F8F8F2">: View {</span></span>
<span class="line"><span style="color:#FF79C6">    @Bindable</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> people: People </span><span style="color:#6272A4">// 用法一</span></span>
<span class="line"><span style="color:#F8F8F2">    var body: </span><span style="color:#FF79C6">some</span><span style="color:#F8F8F2"> View {</span></span>
<span class="line"><span style="color:#8BE9FD">        TextField</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Name</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">text</span><span style="color:#F8F8F2">: $people.name)</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">struct</span><span style="color:#8BE9FD;font-style:italic"> PeopleAge</span><span style="color:#F8F8F2">: View {</span></span>
<span class="line"><span style="color:#FF79C6">    let</span><span style="color:#F8F8F2"> people: People</span></span>
<span class="line"><span style="color:#FF79C6">    var</span><span style="color:#F8F8F2"> body: </span><span style="color:#FF79C6">some</span><span style="color:#F8F8F2"> View {</span></span>
<span class="line"><span style="color:#FF79C6">        @Bindable</span><span style="color:#FF79C6"> var</span><span style="color:#F8F8F2"> people </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> people </span><span style="color:#6272A4">// 用法二</span></span>
<span class="line"><span style="color:#8BE9FD">        TextField</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Age:</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">value</span><span style="color:#F8F8F2">: $people.age, </span><span style="color:#8BE9FD">format</span><span style="color:#F8F8F2">: .number)</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div>
<h3 id="52-注意事项与使用技巧">5.2 注意事项与使用技巧</h3>
<ul>
<li><code>@Bindable</code> 专门用于符合 <code>Observation.Observable</code> 协议的类型，适用于那些通过 <code>@Observable</code> 宏或 <code>@Model</code> 宏声明的类型。</li>
<li>目前，在将 <code>@Bindable</code> 应用于 SwiftData 的 PersistentModel 实例时需特别小心。特别是当 <code>autoSave</code> 功能被激活时，它可能会导致稳定性问题。预计在未来的更新中，这一问题能得到解决和改进。</li>
</ul>
<div class="dynamic-ad-container pt-4"></div>
<h2 id="总结">总结</h2>
<p>至此，我们已经介绍了 SwiftUI 中的 16 种不同属性包装器。之后还将用一篇文章对剩下的属性包装器的功能进行探讨，敬请期待。</p> </div> </article> <script src="/js/modalsubscribecontroller.js" defer></script> <!-- Modal toggle --><button data-modal-target="default-modal" data-modal-toggle="default-modal" class="hidden text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800" type="button">
Toggle modal
</button> <!-- Main modal --> <div id="modal-backdrop" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40"> <div id="default-modal" tabindex="-1" aria-hidden="true" class="hidden w-full h-full justify-center items-center"> <div class="relative p-4 w-full max-w-2xl"> <!-- Modal content --> <div class="relative bg-white rounded-lg shadow-2xl dark:bg-gray-800 border-gray-200 border dark:border-gray-600"> <!-- Modal header --> <div class="flex items-center justify-between px-4 md:px-5 pt-4 pb-0 rounded-t dark:border-gray-600"> <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="default-modal"> <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14"> <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"></path> </svg> <span class="sr-only">Close modal</span> </button> </div> <!-- Modal body --> <div class="px-4 md:px-5 pb-4"> <div class="w-full mx-auto text-center px-6 pb-6"> <div class="text-lg font-semibold text-gray-900 dark:text-blue-100 pt-4 pb-8">每周一，与您分享精心筛选的 Swift 与 SwiftUI 开发精华</div> <div id="custom-substack-embed1"></div> <!-- <div class="text-gray-700 dark:text-blue-200 text-xs font-medium pt-4">{bottomTip}</div> --> <script>(function(){const subscribeText = "立刻订阅";
const placeholder = "输入邮箱订阅周报";

    window.CustomSubstackWidget = {
      substackUrl: 'weekly.fatbobman.com',
      placeholder: placeholder,
      buttonText: subscribeText,
      theme: 'custom',
      colors: {
        primary: '#F50000',
        input: '#000000',
        email: '#777777',
        text: '#000000',
      },
    };

    // 创建一个新的 MutationObserver 实例
    const observer = new MutationObserver((mutationsList, observer) => {
      // 遍历所有的 mutations
      for (let mutation of mutationsList) {
        // 如果这个 mutation 是一个子节点的添加或删除
        if (mutation.type === 'childList') {
          // 查找订阅框
          const widget = document.querySelector('.custom-substack-widget1');
          if (widget) {
            // 查找 input 元素
            const input = widget.querySelector('input');
            const button = widget.querySelector('button');
            // 根据当前的颜色方案修改订阅框的样式
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
              // 暗黑模式
              widget.style.border = 'var(--subscribe-widget-border)';
              widget.style.padding = '0.3rem';
              widget.style.borderRadius = '0.7rem 0.7rem 0.7rem 0.7rem';
              widget.style.backgroundColor = 'var(--subscribe-input-background)';
              input.style.border = '0px solid #000';
              input.style.backgroundColor = 'var(--subscribe-input-background)';
              input.style.padding = '0.5rem';
              // input.style.border = '1px solid #E2E8F0';
              input.style.outline = 'none';
              button.style.backgroundColor = 'var(--subscribe-button-background)';
              button.style.color = 'var(--subscribe-button-text)';
              button.style.fontWeight = 'bold';
              button.style.padding = '0.5rem 1rem';
              button.style.borderRadius = '0.5rem 0.5rem 0.5rem 0.5rem';
              button.style.maxWidth = '100px';
            } else {
              // 正常模式
              widget.style.border = 'var(--subscribe-widget-border)';
              widget.style.padding = '0.3rem';
              widget.style.borderRadius = '0.7rem 0.7rem 0.7rem 0.7rem';
              widget.style.backgroundColor = 'var(--subscribe-input-background)';
              input.style.border = '0px solid #000';
              input.style.backgroundColor = 'var(--subscribe-input-background)';
              input.style.padding = '0.5rem';
              // input.style.border = '1px solid #E2E8F0';
              input.style.outline = 'none';
              button.style.backgroundColor = 'var(--subscribe-button-background)';
              button.style.color = 'var(--subscribe-button-text)';
              button.style.fontWeight = 'bold';
              button.style.padding = '0.5rem 1rem';
              button.style.borderRadius = '0.5rem 0.5rem 0.5rem 0.5rem';
              button.style.maxWidth = '100px';
            }

            if (window.matchMedia('(max-width: 640px)').matches) {
              // 屏幕尺寸小于 640px
              widget.style.maxWidth = '325px';
            } else {
              // 屏幕尺寸大于或等于 640px
              widget.style.maxWidth = '600px';
            }
            // 停止观察
            observer.disconnect();
          }
        }
      }
    });

    // 开始观察 #custom-substack-embed 元素的子节点的变化
    observer.observe(document.getElementById('custom-substack-embed1'), { childList: true });
  })();</script> <script src="/js/subscriber.js" async></script> </div> <div class="flex justify-center pb-6"> <button data-modal-hide="default-modal" type="button" class="text-gray-600 dark:text-gray-400 bg-transparent hover:text-gray-800 dark:hover:text-gray-200 font-medium rounded-lg text-sm px-8 py-2.5 text-center transition-colors">继续阅读</button> </div> </div> </div> </div> </div> </div> <script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "author": {
    "@type": "Person",
    "name": "Fatbobman",
    "url": "https://twitter.com/fatbobman"
  },
  "dateModified": "2024-02-01T04:00:00.000Z",
  "datePublished": "2024-02-01T04:00:00.000Z",
  "description": "本文深入探讨SwiftUI中 @FetchRequest、@SectionedFetchRequest、@Query、 @Namespace 和 @Bindable 属性包装器的用法，助你掌握数据获取和视图控制。",
  "headline": "探讨 SwiftUI 中的属性包装器：@FetchRequest、@SectionedFetchRequest、@Query、@Namespace、@Bindable",
  "image": {
    "@type": "ImageObject",
    "url": [
      {
        "url": "https://cdn.fatbobman.com/card/exploring-swiftui-property-wrappers-3-zh.png"
      }
    ]
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://fatbobman.com/zh/posts/exploring-swiftui-property-wrappers-3/"
  },
  "url": "https://fatbobman.com/zh/posts/exploring-swiftui-property-wrappers-3/",
  "publisher": {
    "@type": "Organization",
    "name": "Fatbobman's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://fatbobman.com/images/blog-card.png"
    }
  }
}</script> <div class="w-full mx-auto text-center pb-0 sm:pb-6 pt-8"> <div id="custom-substack-embed"></div> <div class="text-xs font-medium text-heading p-4">为您每周带来有关 Swift 和 SwiftUI 的精选资讯！</div> <script>(function(){const subscribeText = "立刻订阅";
const placeholder = "输入邮箱订阅周报";

    window.CustomSubstackWidget = {
      substackUrl: 'weekly.fatbobman.com',
      placeholder: placeholder,
      buttonText: subscribeText,
      theme: 'custom',
      colors: {
        primary: '#F50000',
        input: '#000000',
        email: '#777777',
        text: '#000000',
      },
    };
  
    const observer = new MutationObserver((mutationsList) => {
      const widget = document.querySelector('.custom-substack-widget');
      if (widget) {
        const input = widget.querySelector('input');
        const button = widget.querySelector('button');
  
        // 设置样式（合并暗黑模式与默认模式逻辑）
        const darkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        widget.style.padding = '0.5rem';
        widget.style.borderRadius = '1.2rem';
        widget.style.border = '0.1px solid var(--aw-color-text-muted)';
        input.style.border = '0px solid #000';
        input.style.backgroundColor = 'var(--aw-background-color)';
        button.style.backgroundColor = 'var(--subscribe-button-background)';
        button.style.color = 'var(--subscribe-button-text)';
        button.style.borderRadius = '0.8rem';
        button.style.maxWidth = '100px';
        button.style.fontWeight = 'bold';
  
        // 响应式调整
        widget.style.maxWidth = window.matchMedia('(max-width: 640px)').matches
          ? '325px'
          : '400px';
  
        observer.disconnect(); // 停止观察
      }
    });
  
    // 开始观察
    observer.observe(document.getElementById('custom-substack-embed'), { childList: true });
  })();</script> <script src="https://substackapi.com/widget.js" defer></script> </div> <div class="pt-6 pb-6  dark:border-gray-700"> <!-- <p class="flex justify-center align-center text-sm font-medium text-heading">
    { lang === Lang.ZH && <SupportMeTextZH /> }
    { lang === Lang.EN && <SupportMeTextEN /> }
  </p> --> <div class="flex flex-col sm:flex-row justify-center items-center mx-auto sm:space-x-8 align-center pt-2"> <button type="button" class="text-gray-900 bg-yellow-200 hover:bg-yellow-300 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm px-8 py-4 text-center inline-flex items-center dark:focus:ring-gray-600 dark:border-gray-700 me-2 mb-2" onclick="window.open('https://www.buymeacoffee.com/fatbobman')"> <img src="/images/buymeacoffee.svg" alt="Buy me a coffee" class="w-5 h-5 me-2 -ms-1" decoding="async" loading="lazy"> <span class="text-black font-medium">Buy me a coffee</span> </button> <div class="pt-4 sm:pt-0"> <button type="button" class="text-red-500 bg-[#3270e1] hover:bg-blue-700 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm px-8 py-4 text-center inline-flex items-center dark:focus:ring-gray-600 dark:border-gray-700 me-2 mb-2" onclick="window.open('https://afdian.com/a/fatbobman')"> <img src="/images/aifadian.svg" alt="" width="18" height="18" loading="lazy" decoding="async" class="w-4 h-4 me-2 -ms-1" aria-hidden="true"> <span class="text-white font-medium">爱发电(微信/支付宝)</span> </button>  </div> </div> </div> <!-- <WeeklySubscribe1 lang={lang} top={0} bottom={4}/> --> <div id="copy-alert" class="hidden fixed bottom-28 right-5"> <div id="alert-1" class="flex items-center p-4 mb-4 text-blue-800 rounded-lg bg-blue-50/90 dark:bg-gray-800/90 dark:text-blue-400" role="alert"> <div class="text-sm font-medium">链接已复制</div> </div> </div> <style>
  .copy-icon {
    position: absolute;
    left: -30px; /* 根据您的布局调整位置 */
    top: 50%; /* 将图标定位到标题的中间高度 */
    transform: translateY(-50%); /* 垂直居中对齐图标 */
    cursor: pointer;
    transition: opacity 0.6s ease;
    pointer-events: all; /* 始终响应鼠标事件 */
  }

  article h2,
  article h3,
  article h4,
  article h5 {
    position: relative;
  }

  #copy-alert {
    position: fixed;
    bottom: -100px; /* 初始在视窗下方 */
    right: 20px;
    transition: bottom 0.5s ease-in-out;
  }

  /* 进入动画 */
  @keyframes slideIn {
    from {
      bottom: -100px;
    }
    to {
      bottom: 0px;
    }
  }

  /* 消失动画 */
  @keyframes slideOut {
    from {
      bottom: 20px;
    }
    to {
      bottom: -100px;
    }
  }
</style> <script>
  var hideTimeout; // 用于保存自动隐藏定时器的引用
  document.querySelectorAll('article h2, article h3, article h4, article h5').forEach(function (header) {
    var copyIcon = document.createElement('span');
    copyIcon.innerHTML =
      '<svg fill="currentColor" aria-hidden="true" stroke="currentColor" class="w-5 h-5 hidden md:block hover:text-secondary" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M861.866667 164.266667c-87.466667-87.466667-230.4-89.6-320-2.133334l-68.266667 68.266667c-12.8 12.8-12.8 32 0 44.8s32 12.8 44.8 0l68.266667-68.266667c64-61.866667 166.4-61.866667 230.4 2.133334 64 64 64 168.533333 2.133333 232.533333l-117.333333 119.466667c-34.133333 34.133333-81.066667 51.2-128 49.066666-46.933333-4.266667-91.733333-27.733333-119.466667-66.133333-10.666667-14.933333-29.866667-17.066667-44.8-6.4-14.933333 10.666667-17.066667 29.866667-6.4 44.8 40.533333 53.333333 100.266667 87.466667 166.4 91.733333h17.066667c59.733333 0 119.466667-23.466667 162.133333-68.266666l117.333333-119.466667c83.2-89.6 83.2-234.666667-4.266666-322.133333z"></path><path d="M505.6 750.933333l-66.133333 68.266667c-64 61.866667-166.4 61.866667-230.4-2.133333-64-64-64-168.533333-2.133334-232.533334l117.333334-119.466666c34.133333-34.133333 81.066667-51.2 128-49.066667 46.933333 4.266667 91.733333 27.733333 119.466666 66.133333 10.666667 14.933333 29.866667 17.066667 44.8 6.4 14.933333-10.666667 17.066667-29.866667 6.4-44.8-40.533333-53.333333-100.266667-87.466667-166.4-91.733333-66.133333-4.266667-130.133333 19.2-177.066666 66.133333l-117.333334 119.466667c-85.333333 89.6-85.333333 234.666667 2.133334 322.133333 44.8 44.8 102.4 66.133333 162.133333 66.133334 57.6 0 115.2-21.333333 160-64l66.133333-68.266667c12.8-12.8 12.8-32 0-44.8-14.933333-10.666667-34.133333-10.666667-46.933333 2.133333z"></path></svg>'; // 使用您选择的图标
    copyIcon.className = 'copy-icon';
    copyIcon.style.opacity = '0'; // 默认透明
    header.insertBefore(copyIcon, header.firstChild);

    header.addEventListener('mouseover', function () {
      copyIcon.style.opacity = '1';
    });
    header.addEventListener('mouseout', function () {
      copyIcon.style.opacity = '0';
    });

    copyIcon.addEventListener('click', function () {
        var url = window.location.href.split('#')[0] + '#' + header.id;
        navigator.clipboard.writeText(url).then(function () {
            var alertDiv = document.getElementById('copy-alert');
            if (alertDiv) {
                alertDiv.classList.remove('hidden'); // 确保提示框是可见的
                alertDiv.style.display = 'block'; // 显示提示框
                clearTimeout(hideTimeout); // 清除之前的定时器
                alertDiv.style.animation = 'none'; // 先清除之前的动画
                setTimeout(function () {
                    alertDiv.style.animation = 'slideIn 0.5s forwards'; // 应用新动画
                }, 10);

                // 设置自动隐藏定时器
                hideTimeout = setTimeout(function () {
                    alertDiv.style.animation = 'slideOut 0.5s forwards'; // 应用消失动画
                    setTimeout(function () {
                        alertDiv.style.display = 'none';
                    }, 500);
                }, 3000);
            }
        });
    });
  });
</script> <script>
function copyCode(button, event) {
  event.preventDefault();
  const codeBlock = button.parentNode.nextElementSibling.textContent; // 获取代码内容
  navigator.clipboard.writeText(codeBlock).then(() => {
    // 显示 "Copied"
    button.querySelector('.copy-text').style.display = 'none';
    button.querySelector('.copied-text').style.display = 'inline';

    // 3秒后恢复
    setTimeout(() => {
      button.querySelector('.copy-text').style.display = 'inline';
      button.querySelector('.copied-text').style.display = 'none';
    }, 3000);
  });
}
</script> <script>(function(){const url = "https://fatbobman.com/ads/zh";

  fetch(url)
    .then(response => response.text())
    .then(html => {
      // 获取所有的广告位元素
      const adSlots = document.querySelectorAll('.dynamic-ad-container');
      // 将广告内容填充到每一个广告位中
      adSlots.forEach(slot => {
        slot.innerHTML = html;
      });
    })
    .catch(error => console.error('Error loading the ad:', error));
})();</script>  <!-- <LeaveFeedback lang={lang} /> --> <section class="pt-10"><div class="max-w-5xl sm:px-4 py-2 mx-auto"><div class="grid gap-4 sm:gap-2 sm:mx-4 sm:grid-cols-12"><div class="col-span-12 sm:col-span-3 hidden sm:block"><div class="text-center sm:text-left mt-3 mb-14 before:block before:w-24 before:h-1 before:mb-3 before:rounded before:mx-auto sm:before:mx-0 before:bg-secondary"><h3 class="text-lg font-medium text-default">相关文章</h3></div></div><div class="sm:hidden text-lg font-medium text-heading col-span-12 text-left">相关文章</div><div class="relative col-span-12 sm:px-4 space-y-6 sm:col-span-9"><div class="col-span-12 space-y-2 relative sm:px-4 sm:col-span-8 sm:space-y-4 sm:before:absolute sm:before:top-2 sm:before:bottom-0 sm:before:w-0.5 sm:before:-left-3 before:bg-block"><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/zh/posts/exploring-key-property-wrappers-in-swiftui/" id="relatedPosts-探讨 SwiftUI 中的关键属性包装器：@State、@Binding、@StateObject、@ObservedObject、@EnvironmentObject 和 @Environment"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">探讨 SwiftUI 中的关键属性包装器：@State、@Binding、@StateObject、@ObservedObject、@EnvironmentObject 和 @Environment</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/zh/posts/exploring-swiftui-property-wrappers-2/" id="relatedPosts-探讨 SwiftUI 中的属性包装器：@AppStorage、@SceneStorage、@FocusState、@GestureState 和 @ScaledMetric"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">探讨 SwiftUI 中的属性包装器：@AppStorage、@SceneStorage、@FocusState、@GestureState 和 @ScaledMetric</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/zh/posts/exploring-swiftui-property-wrappers-4/" id="relatedPosts-探讨 SwiftUI 中的属性包装器：@UIApplicationDelegateAdaptor、@AccessibilityFocusState、@FocusedObject、@FocusedValue 和 @FocusedBinding"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">探讨 SwiftUI 中的属性包装器：@UIApplicationDelegateAdaptor、@AccessibilityFocusState、@FocusedObject、@FocusedValue 和 @FocusedBinding</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/zh/posts/modern-core-data-fetcher/" id="relatedPosts-SwiftUI 与 Core Data —— 数据获取"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">SwiftUI 与 Core Data —— 数据获取</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/zh/posts/mastering-relationships-in-core-data-practical/" id="relatedPosts-掌握 Core Data 中的关系：实战"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">掌握 Core Data 中的关系：实战</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/zh/weekly/issue-039" id="relatedPosts-Weekly #39 - 创作者权利在 AI 时代的新挑战"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">Weekly #39 - 创作者权利在 AI 时代的新挑战</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/zh/posts/persistent-history-tracking-in-swiftdata/" id="relatedPosts-如何通过 Persistent History Tracking 观察 SwiftData 的数据变化"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">如何通过 Persistent History Tracking 观察 SwiftData 的数据变化</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/zh/posts/mastering-observation/" id="relatedPosts-深度解读 Observation —— SwiftUI 性能提升的新途径"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">深度解读 Observation —— SwiftUI 性能提升的新途径</h3></div></a></div></div></div></div></section> <!-- <BottomWeeklySubscribe lang={lang} /> --> <div><div id="gitalk-container" data-comment-id="Exploring SwiftUI Property Wrappers 3" data-lang="zh"></div><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script></div><script>
  document.addEventListener('DOMContentLoaded', async function () {
    console.log('fetching comment is enable');
    const response = await fetch('https://fatbobman.com/status/comment');
    const data = await response.text();
    console.log(data);
    if (data === '1') {
      var container = document.getElementById('gitalk-container');
      if (container) {
        var commentID = container.getAttribute('data-comment-id');
        var lang = container.getAttribute('data-lang');

        var gitalk = new Gitalk({
          clientID: 'fcf61195c7f73253dc8b',
          clientSecret: '0ac2907be08248a1fcb5312e27480ad535c682e5',
          repo: 'blogComments',
          owner: 'fatbobman',
          admin: ['fatbobman'],
          id: commentID.split('/').pop().substring(0, 49),
          distractionFreeMode: true,
          createIssueManually: true,
          language: lang,
        });

        gitalk.render('gitalk-container');
      }
    }
  });
</script> <div class="hidden xl:block w-44 lg:absolute" id="toc" style="left: -30px; top: 0px"> <div class="text-muted items-center justify-center overflow-x-clip"> <div class="w-full flex justify-start pb-2" id="toc-button"> <div class=" opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:20px; height:20px;">  <svg fill="currentColor" stroke="currentColor" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" id="toc-list-switcher"> <use href="/images/iconCollection.svg#icon-toc"></use> </svg>  </div> </div> <div class="text-default text-xs hidden" id="toc-list"> <ul> <li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#1-fetchrequest" class=""> 1. @FetchRequest </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#11-基本用法" class=""> 1.1 基本用法 </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#12-主要功能" class=""> 1.2 主要功能 </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#13-注意事项与使用技巧" class=""> 1.3 注意事项与使用技巧 </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#2-sectionedfetchrequest" class=""> 2. @SectionedFetchRequest </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#21-基本用法" class=""> 2.1 基本用法 </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#22-主要功能" class=""> 2.2 主要功能 </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#23-注意事项与使用技巧" class=""> 2.3 注意事项与使用技巧 </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#3-query" class=""> 3. @Query </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#31-基本用法" class=""> 3.1 基本用法 </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#32-注意事项与使用技巧" class=""> 3.2 注意事项与使用技巧 </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#4-namespace" class=""> 4. @Namespace </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#41-基本用法" class=""> 4.1 基本用法 </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#42-主要功能" class=""> 4.2 主要功能 </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#43-注意事项与使用技巧" class=""> 4.3 注意事项与使用技巧 </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#5-bindable" class=""> 5. @Bindable </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#51-基本用法" class=""> 5.1 基本用法 </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#52-注意事项与使用技巧" class=""> 5.2 注意事项与使用技巧 </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#总结" class=""> 总结 </a> </div> </li> </ul> </div> </div> </div> <style>
  #toc-list {
    transition: all 0.9s ease-in-out;
  }

  #toc-button {
    transition: all 0.9s ease-in-out;
  }
</style> <script>
  function getOffsetTop(element) {
    var offsetTop = 0;
    while (element) {
      offsetTop += element.offsetTop;
      element = element.offsetParent;
    }
    return offsetTop;
  }

  var toc = document.querySelector('#toc');
  // 获取 sidebar 在浏览器中的初始 top 值
  var initialTop = getOffsetTop(toc);
  var positioningElement = document.querySelector('#article-area'); // 定位视图的选择器
  var stickyPoint = 150;
  var tocPadding = 30;
  var tocTopOffset = 4;
  var sidebarWidth = toc.offsetWidth;

  function adjustTocPosition() {
    var sidebarOffsetTop = toc.getBoundingClientRect().top;
    console.log(sidebarOffsetTop, window.scrollY, initialTop - stickyPoint);
    if (sidebarOffsetTop <= stickyPoint) {
      // 获取 positioningElement 的左侧侧与浏览器左侧之间的距离
      var positioningElementRight = (window.innerWidth - positioningElement.getBoundingClientRect().width) / 2;
      toc.style.position = 'fixed';
      toc.style.top = stickyPoint + 'px';
      toc.style.left = positioningElementRight - toc.getBoundingClientRect().width - tocPadding + 'px';
    }

    if (window.scrollY <= initialTop - stickyPoint) {
      toc.style.position = 'absolute';
      toc.style.top = tocTopOffset + 'px';
      toc.style.left = -(tocPadding + toc.getBoundingClientRect().width) + 'px';
    }
  }

  document.addEventListener('scroll', adjustTocPosition);
  window.addEventListener('resize', adjustTocPosition);
  // doc 加载完成后，调整 toc 的位置
  toc.style.left = -(tocPadding + toc.getBoundingClientRect().width) + 'px';

  document.addEventListener('DOMContentLoaded', function () {
    const tocList = document.getElementById('toc-list');
    const tocButton = document.getElementById('toc-button');

    // 更新toc-list和toc-button的显示状态
    function updateDisplay() {
      const showToc = localStorage.getItem('showToc') === 'true';
      if (showToc) {
        tocList.classList.remove('hidden');
        tocButton.classList.add('justify-start');
        tocButton.classList.remove('justify-end');
      } else {
        tocList.classList.add('hidden');
        tocButton.classList.remove('justify-start');
        tocButton.classList.add('justify-end');
      }
    }

    // 初始状态检查
    updateDisplay();

    // 点击事件监听器，用于切换toc-list的显示状态并更新按钮位置
    tocButton.addEventListener('click', function () {
      const isHidden = tocList.classList.contains('hidden');
      localStorage.setItem('showToc', isHidden);
      updateDisplay();
    });
  });
</script> <div class="hidden md:block md:absolute" id="sidebar" style="right: -50px; top: 0px"> <div class="flex flex-col space-y-4 text-muted items-center justify-center"> <div class=" opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:20px; height:20px;">  <a href="/zh/posts/exploring-swiftui-property-wrappers-2/" data-tooltip-target="tooltip-next-post" data-tooltip-placement="left" id="sidebar-next-post"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <!-- <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path
        d="M9.586 4l-6.586 6.586a2 2 0 0 0 0 2.828l6.586 6.586a2 2 0 0 0 2.18 .434l.145 -.068a2 2 0 0 0 1.089 -1.78v-2.586h7a2 2 0 0 0 2 -2v-4l-.005 -.15a2 2 0 0 0 -1.995 -1.85l-7 -.001v-2.585a2 2 0 0 0 -3.414 -1.414z"
        stroke-width="0"
        fill="currentColor"
      ></path> --> <use href="/images/iconCollection.svg#icon-previous"></use> </svg> </a>  </div> <div id="tooltip-next-post" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-44 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>探讨 SwiftUI 中的属性包装器：@AppStorage、@SceneStorage、@FocusState、@GestureState 和 @ScaledMetric</div> <div class="text-xs text-yellow-200 font-extrabold pt-2">⌥ + ←</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div> <script>(function(){const url = "/zh/posts/exploring-swiftui-property-wrappers-2/";
const isHidden = false;

  document.addEventListener('keydown', (e) => {
    // Check if Alt+RightArrow or just RightArrow was pressed
    if (e.altKey && e.key === 'ArrowLeft') {
      // Only navigate if there's a URL and the button isn't hidden
      if (url && !isHidden) {
        e.preventDefault(); // Prevent default browser behavior
        window.location.href = url;
      }
    }
  });
})();</script> <div class=" opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:20px; height:20px;">  <a href="/zh/posts/exploring-swiftui-property-wrappers-4/" data-tooltip-target="tooltip-previous-post" data-tooltip-placement="left" id="sidebar-previous-post"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/images/iconCollection.svg#icon-next"></use> <symbol id="icon-next" viewBox="0 0 24 24" fill="currentColor"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M12.089 3.634a2 2 0 0 0 -1.089 1.78l-.001 2.586h-6.999a2 2 0 0 0 -2 2v4l.005 .15a2 2 0 0 0 1.995 1.85l6.999 -.001l.001 2.587a2 2 0 0 0 3.414 1.414l6.586 -6.586a2 2 0 0 0 0 -2.828l-6.586 -6.586a2 2 0 0 0 -2.18 -.434l-.145 .068z" stroke-width="0" fill="currentColor"></path> </symbol> </svg> </a>  </div> <div id="tooltip-previous-post" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-44 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90">  <div>探讨 SwiftUI 中的属性包装器：@UIApplicationDelegateAdaptor、@AccessibilityFocusState、@FocusedObject、@FocusedValue 和 @FocusedBinding</div> <div class="text-xs text-yellow-200 font-extrabold pt-2">⌥ + →</div>  <div class="tooltip-arrow" data-popper-arrow></div> </div> <script>(function(){const url = "/zh/posts/exploring-swiftui-property-wrappers-4/";
const isHidden = false;

  document.addEventListener('keydown', (e) => {
    // Check if Alt+RightArrow or just RightArrow was pressed
    if (e.altKey && e.key === 'ArrowRight') {
      // Only navigate if there's a URL and the button isn't hidden
      if (url && !isHidden) {
        e.preventDefault(); // Prevent default browser behavior
        window.location.href = url;
      }
    }
  });
})();</script> <!-- <DictButton lang={lang} post = {post}/> --> <div class=" opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:20px; height:20px;">  <a href="https://x.com/intent/tweet?text=%E6%8E%A2%E8%AE%A8%20SwiftUI%20%E4%B8%AD%E7%9A%84%E5%B1%9E%E6%80%A7%E5%8C%85%E8%A3%85%E5%99%A8%EF%BC%9AFetchRequest%E3%80%81SectionedFetchRequest%E3%80%81Query%E3%80%81Namespace%E3%80%81Bindable&#38;url=https%3A%2F%2Ffatbobman.com%2Fzh%2Fposts%2Fexploring-swiftui-property-wrappers-3%2F&#38;hashtags=ios%2Cswiftlang&#38;via=fatbobman" target="_blank" id="sidebar-share-with-twitter"> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <use href="/images/iconCollection.svg#icon-twitter"></use> </svg> </a>  </div> <div class=" opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:20px; height:20px;">  <a href="https://bsky.app/intent/compose?text=%E6%8E%A2%E8%AE%A8%20SwiftUI%20%E4%B8%AD%E7%9A%84%E5%B1%9E%E6%80%A7%E5%8C%85%E8%A3%85%E5%99%A8%EF%BC%9AFetchRequest%E3%80%81SectionedFetchRequest%E3%80%81Query%E3%80%81Namespace%E3%80%81Bindable%0A by %40fatbobman.bsky.social %0Ahttps%3A%2F%2Ffatbobman.com%2Fzh%2Fposts%2Fexploring-swiftui-property-wrappers-3%2F%0A #ios #swift" target="_blank" id="sidebar-share-with-bluesky"> <svg xmlns="http://www.w3.org/2000/svg" class="text-default hover:text-secondary" width="20" height="20" viewBox="0 0 24 24" stroke-width="0.7" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/images/iconCollection.svg#icon-bluesky"></use> </svg> </a>  </div> <div class="hidden opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:20px; height:20px;">  <a href="https://www.facebook.com/sharer/sharer.php?u=https%253A%252F%252Ffatbobman.com%252Fzh%252Fposts%252Fexploring-swiftui-property-wrappers-3%252F" target="_blank" id="sidebar-share-with-facebook"> <svg fill="currentColor" stroke="currentColor" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <use href="/images/iconCollection.svg#icon-facebook"></use> </svg> </a>  </div> <div class=" opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:20px; height:20px;">  <a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Ffatbobman.com%2Fzh%2Fposts%2Fexploring-swiftui-property-wrappers-3%2F&#38;title=%E6%8E%A2%E8%AE%A8%20SwiftUI%20%E4%B8%AD%E7%9A%84%E5%B1%9E%E6%80%A7%E5%8C%85%E8%A3%85%E5%99%A8%EF%BC%9AFetchRequest%E3%80%81SectionedFetchRequest%E3%80%81Query%E3%80%81Namespace%E3%80%81Bindable%0A%20%23ios%20%23swift%0A%20by%20%40fatbobman%0A" target="_blank" id="sidebar-share-with-weibo"> <svg fill="currentColor" stroke="currentColor" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <!-- <path
        d="M457.3 543c-68.1-17.7-145 16.2-174.6 76.2-30.1 61.2-1 129.1 67.8 151.3 71.2 23 155.2-12.2 184.4-78.3 28.7-64.6-7.2-131-77.6-149.2z m-52 156.2c-13.8 22.1-43.5 31.7-65.8 21.6-22-10-28.5-35.7-14.6-57.2 13.7-21.4 42.3-31 64.4-21.7 22.4 9.5 29.6 35 16 57.3z m45.5-58.5c-5 8.6-16.1 12.7-24.7 9.1-8.5-3.5-11.2-13.1-6.4-21.5 5-8.4 15.6-12.4 24.1-9.1 8.7 3.2 11.8 12.9 7 21.5zM785.3 443.5c15 4.8 31-3.4 35.9-18.3 11.8-36.6 4.4-78.4-23.2-109-27.6-30.6-68.4-42.3-106-34.3-15.4 3.3-25.2 18.4-21.9 33.8 3.3 15.3 18.4 25.2 33.8 21.8 18.4-3.9 38.3 1.8 51.9 16.7 13.5 15 17.2 35.4 11.3 53.3-4.9 15.1 3.2 31.1 18.2 36z"
      ></path><path
        d="M885.1 237.5c-56.7-62.9-140.4-86.9-217.7-70.5-17.9 3.8-29.3 21.4-25.4 39.3 3.8 17.9 21.4 29.3 39.3 25.5 55-11.7 114.4 5.4 154.8 50.1 40.3 44.7 51.2 105.7 34 159.1-5.6 17.4 3.9 36 21.3 41.7 17.4 5.6 36-3.9 41.6-21.2v-0.1c24.1-75.4 8.9-161.1-47.9-223.9zM729 499c-12.2-3.6-20.5-6.1-14.1-22.1 13.8-34.7 15.2-64.7 0.3-86-28-40.1-104.8-37.9-192.8-1.1 0 0-27.6 12.1-20.6-9.8 13.5-43.5 11.5-79.9-9.6-101-47.7-47.8-174.6 1.8-283.5 110.6C127.3 471.1 80 557.5 80 632.2 80 775.1 263.2 862 442.5 862c235 0 391.3-136.5 391.3-245 0-65.5-55.2-102.6-104.8-118zM443 810.8c-143 14.1-266.5-50.5-275.8-144.5-9.3-93.9 99.2-181.5 242.2-195.6 143-14.2 266.5 50.5 275.8 144.4C694.4 709 586 796.6 443 810.8z"
      ></path> --> <use href="/images/iconCollection.svg#icon-weibo"></use> </svg> </a>  </div> <div class="hidden opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:16px; height:16px;">  <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ffatbobman.com%2Fzh%2Fposts%2Fexploring-swiftui-property-wrappers-3%2F" target="_blank" id="sidebar-share-with-linkedin"> <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 15 15"> <use href="/images/iconCollection.svg#icon-linkedin"></use> </svg> </a>  </div> <div class=" opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:20px; height:20px;">  <a href="mailto:?subject=%E6%96%87%E7%AB%A0%3A%E3%80%90%E6%8E%A2%E8%AE%A8%20SwiftUI%20%E4%B8%AD%E7%9A%84%E5%B1%9E%E6%80%A7%E5%8C%85%E8%A3%85%E5%99%A8%EF%BC%9AFetchRequest%E3%80%81SectionedFetchRequest%E3%80%81Query%E3%80%81Namespace%E3%80%81Bindable%E3%80%91&#38;body=%E5%88%86%E4%BA%AB%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E7%BB%99%E4%BD%A0%EF%BC%9A%0A%0A%E6%8E%A2%E8%AE%A8%20SwiftUI%20%E4%B8%AD%E7%9A%84%E5%B1%9E%E6%80%A7%E5%8C%85%E8%A3%85%E5%99%A8%EF%BC%9AFetchRequest%E3%80%81SectionedFetchRequest%E3%80%81Query%E3%80%81Namespace%E3%80%81Bindable%0A%0A%E9%93%BE%E6%8E%A5%3A%20https%3A%2F%2Ffatbobman.com%2Fzh%2Fposts%2Fexploring-swiftui-property-wrappers-3%2F" target="_blank" id="sidebar-share-with-email"> <svg fill="currentColor" stroke="currentColor" stroke-width="4" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <use href="/images/iconCollection.svg#icon-email"></use> </svg> </a>  </div> <div class=" opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:20px; height:20px;">  <svg fill="currentColor" stroke="currentColor" onclick="scrollToElement()" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <use href="/images/iconCollection.svg#icon-comment"></use> </svg>  </div> <script>
  var offset = 80
  function scrollToElement() {
    var gitalkContainer = document.getElementById('gitalk-container');
    if (gitalkContainer) {
      var topPosition = gitalkContainer.getBoundingClientRect().top + window.scrollY - offset;
      window.scrollTo({ top: topPosition, behavior: 'smooth' });
    }
  }
</script> <div class=" opacity-50 hover:opacity-100 text-heading hover:text-secondary" style="width:20px; height:20px;">  <svg fill="currentColor" stroke="currentColor" onclick="window.scrollTo({top:0,behavior:'smooth'})" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <!-- <path d="M862.464 161.536l-700.928 0c-30.976 0-56.096-25.12-56.096-56.096l0-28.064c0-30.944 25.12-56.064 56.096-56.064l700.896 0c30.976 0 56.096 25.12 56.096 56.064l0 28.032c0 31.008-25.12 56.096-56.096 56.096l0 0 0 0zM138.528 531.68c0 0 306.816-245.792 309.888-248.864 14.304-13.888 31.904-22.368 49.952-25.312 1.76-0.32 3.488-0.608 5.248-0.8 2.816-0.32 5.6-0.352 8.384-0.352 2.816-0.032 5.568 0.032 8.352 0.352 1.792 0.192 3.552 0.48 5.28 0.8 18.048 2.976 35.616 11.424 49.92 25.312 3.104 3.008 309.856 248.864 309.856 248.864 33.152 32.224 30.304 65.44-2.784 97.696s-77.376 3.04-110.496-29.216l-190.08-150.432 0 496.864c0 31.008-25.088 56.096-56.096 56.096l-28 0c-30.976 0-56.096-25.12-56.096-56.096l0-496.864-190.048 150.432c-33.088 32.288-77.408 61.536-110.496 29.216-33.056-32.256-35.872-65.44-2.816-97.696l0 0 0 0z"></path> --> <use href="/images/iconCollection.svg#icon-top"></use> </svg>  </div> </div> </div>  </div>   </div> </main> </div> <footer> <footer class="bg-block"> <div class="mx-auto w-full max-w-3xl px-4 md:px-6"> <div class="container flex flex-col items-center pt-10"> <div class="flex flex-row justify-around w-full space-x-3"> <div class="flex flex-col space-y-4"> <h2 class="font-bold text-heading">网站</h2> <div class="flex flex-col space-y-2 text-sm text-default font-medium"> <a href="https://apps.apple.com/us/app/id1534513553" class="hover:text-secondary" target="_blank">健康笔记</a> <a href="https://discord.gg/zhou-zi-de-swiftji-shi-ben-967978112509935657" class="hover:text-secondary" target="_blank">Discord</a> <a href="/zh/posts/" class="hover:text-secondary">文章</a> <a href="/zh/tags/" class="hover:text-secondary">标签</a> <a href="/zh/collections/" class="hover:text-secondary">合集</a> <a href="/zh/snippet/" class="hover:text-secondary">小贴士</a> </div> </div> <div class="flex flex-col space-y-4"> <h2 class="font-bold text-heading">关注</h2> <div class="flex flex-col space-y-2 text-sm text-default font-medium"> <a href="https://weekly.fatbobman.com" class="hover:text-secondary">周报</a> <a href="https://x.com/intent/follow?screen_name=fatbobman" class="hover:text-secondary" target="_blank">Twitter</a> <a href="https://mastodon.social/@fatbobman" class="hover:text-secondary" target="_blank">Mastodon</a> <a href="https://www.linkedin.com/in/fatbobman/" class="hover:text-secondary" target="_blank">Linkedin</a> <a href="https://bsky.app/profile/fatbobman.bsky.social" class="hover:text-secondary" target="_blank">Blue Sky</a> <a href="https://web.okjike.com/u/e32947ef-7751-4363-9456-b340eef2efd3" class="hover:text-secondary" target="_blank">
即刻
</a> <a href="https://github.com/fatbobman" class="hover:text-secondary" target="_blank">GitHub</a> <a href="/zh/rss.xml" class="hover:text-secondary hover:font-medium" target="_blank">RSS</a> </div> </div> <div class="flex flex-col space-y-4"> <h2 class="font-bold text-heading">信息</h2> <div class="flex flex-col space-y-2 text-sm text-default font-medium"> <a href="/zh/about/" class="hover:text-secondary">关于</a>  </div> </div> </div> <div class="pb-0"> <div class="flex items-center justify-center w-full px-6 pt-12 text-sm"> <span class="text-muted text-xs">Copyright © <span>2020-</span> 2025 <a href="https://x.com/fatbobman" class="border-b-secondary border-b-[1px]">Fatbobman Digital Limited</a>. All Rights
            Reserved.</span> </div> <div class="flex items-center justify-center w-full px-6 pt-2 text-sm pb-10"> <span> <a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank" class="block text-xs text-muted">
辽ICP备20006550号-1
</a> </span> </div> </div> </div> </div> </footer> </footer> </div>   <!-- <script is:inline src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.8.0/flowbite.min.js"></script> --><script type="module" src="/js/theme.js" defer></script> <script>(function(){const currentLang = "zh";

  function attachEvent(selector, event, fn) {
    const matches = typeof selector === 'string' ? document.querySelectorAll(selector) : selector;
    if (matches && matches.length) {
      matches.forEach((elem) => {
        elem.addEventListener(event, (e) => fn(e, elem), false);
      });
    }
  }

  // 为每个需要清除 focus 状态的按钮都添加一个 clear-focus 类, 下面的代码将在点击后自动移除 focus 状态
  document.addEventListener('DOMContentLoaded', (event) => {
    // 获取所有具有 'clear-focus' 类的按钮
    const buttons = document.querySelectorAll('.clear-focus');

    buttons.forEach((button) => {
      button.addEventListener('click', () => {
        setTimeout(() => {
          button.blur();
        }, 0);
      });
    });
  });

  window.onpageshow = function () {
    document.documentElement.classList.add('motion-safe:scroll-smooth');
  };
})();</script> <div id="docsearch-container-data" data-lang="zh" data-searchtext="搜索..."></div> <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script> <script src="/js/runsearch.js"></script> <!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5C7N4MF5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!-- End Google Tag Manager (noscript) --> </body></html>