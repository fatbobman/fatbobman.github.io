<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="sitemap" href="/sitemap-index.xml"><!-- <link rel="shortcut icon" href={iconSVG.src} /> --><link rel="icon" type="image/png" sizes="16x16" href="/_astro/favicon-16x16.2312221518-2.DhhY-2ao.png"><link rel="icon" type="image/png" sizes="32x32" href="/_astro/favicon-32x32.2312221518-2.BbUzUdRZ.png"><link rel="mask-icon" href="/_astro/faviconSVG-32x32.2312221518-2.ll_gTgJS.svg"><link rel="apple-touch-icon" sizes="180x180" href="/_astro/apple-touch-icon.2312227635.BE1WvNvp.png"><title>How to Dynamically Construct Complex Predicates for SwiftData | Fatbobman&#39;s Blog</title>
<meta name="description" content="Explore dynamically creating predicates for SwiftData, similar to NSCompoundPredicate, using PredicateExpression for flexible data filtering.">
<meta name="robots" content="index,follow">
<link rel="canonical" href="https://fatbobman.com/en/posts/how-to-dynamically-construct-complex-predicates-for-swiftdata/">
<meta property="og:title" content="How to Dynamically Construct Complex Predicates for SwiftData | Fatbobman&#39;s Blog">
<meta property="og:description" content="Explore dynamically creating predicates for SwiftData, similar to NSCompoundPredicate, using PredicateExpression for flexible data filtering.">
<meta property="og:url" content="https://fatbobman.com/en/posts/how-to-dynamically-construct-complex-predicates-for-swiftdata/">
<meta property="og:type" content="article">
<meta property="og:image" content="https://cdn.fatbobman.com/card/how-to-dynamically-construct-complex-predicates-for-swiftdata-en.png">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="fatbobman.com">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@fatbobman">
<meta name="twitter:creator" content="@fatbobman"><link rel="alternate" type="application/rss+xml" title="RSS Feed for My Website" href="https://fatbobman.com/en/rss.xml"><link rel="sitemap" href="/sitemap-index.xml"><meta name="keywords" content="Swift 编程,Swift Programming,SwiftUI 教程,SwiftUI Tutorials,Core Data 实践,Core Data Practices,SwiftData 应用,SwiftData Applications,iOS 开发,iOS Development,Swift UI 设计,Swift UI Design,Swift 性能优化,Swift Performance Optimization,Swift 编码技巧,Swift Coding Techniques,iOS 应用开发,iOS App Development,Swift 数据管理,Swift Data Management,SwiftUI 布局,SwiftUI Layout,SwiftUI 动画,SwiftUI Animation"><meta name="apple-mobile-web-app-title" content="Fatbobman's Blog"><link rel="alternate" hreflang="en" href="https://fatbobman.com/en/posts/how-to-dynamically-construct-complex-predicates-for-swiftdata/"><link rel="alternate" hreflang="zh" href="https://fatbobman.com/zh/posts/how-to-dynamically-construct-complex-predicates-for-swiftdata/"><!-- <script is:inline>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?14e5d60a3ea6276655f9d14c58b1fcd0";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script> --><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5C7N4MF5');</script> <!-- End Google Tag Manager --><script>
      // Immediately set theme before page renders
      if (
        localStorage.getItem('color-theme') === 'dark' ||
        (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
      ) {
        document.documentElement.classList.add('dark');
      }
    </script><link rel="stylesheet" href="/_astro/style.BwpIl3wN.css"></head> <body class="antialiased text-default bg-page">  <div class="flex flex-col min-h-screen justify-between "> <div> <header> <div class="bg-block" id="wholeHeader" data-astro-cid-4wsjtibl> <div id="blogTitle"> <a href="/en/"> <div class="flex space-x-4 mx-auto text-center pt-6 sm:pt-6 font-black w-[240px] sm:w-[300px] pb-2 sm:pb-0"> <svg fill="currentColor" class="text-heading" width="500"> <use href="/_astro/blogTitle.Ca1NZNqJ.svg#blog-title"></use> </svg> </div> </a> </div> <div class="bg-block z-50 shadow-custom-light dark:shadow-custom-dark" id="stickyHeader" data-astro-cid-4wsjtibl> <div class="max-w-5xl flex flex-wrap items-center justify-between mx-auto p-2 sm:p-0" data-astro-cid-4wsjtibl> <div class="flex space-x-2" data-astro-cid-4wsjtibl> <div id="lang-data" data-lang="en" style="display: none;"></div> <button id="language-dropdown-button" data-dropdown-toggle="language-dropdown-menu" type="button" class="p-2 w-10 h-10 font-medium text-default hover:text-secondary hover:bg-gray-100 dark:hover:bg-page focus:outline-none focus:ring-2 focus:ring-gray-200 dark:hover:bg-gray-700 dark:focus:ring-gray-600 rounded-lg"> EN </button> <!-- Dropdown --> <div class="z-50 hidden my-4 text-base list-none bg-page divide-y divide-gray-100 rounded-lg shadow dark:bg-gray-700" id="language-dropdown-menu"> <ul class="py-2 font-medium text-sm" role="none"> <li> <a href class="block px-4 py-2 text-default hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" role="menuitem"> <div class="inline-flex items-center">
English
<svg class="w-3.5 h-3.5 ml-2 hidden text-primary" id="EN-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-aifadian"></use> </svg> </div> </a> </li><li> <a href="/zh/posts/how-to-dynamically-construct-complex-predicates-for-swiftdata/" class="block px-4 py-2 text-default hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" role="menuitem"> <div class="inline-flex items-center">
中文
<svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5 ml-2 hidden text-primary" id="ZH-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-aifadian"></use> </svg> </div> </a> </li> <li> <div class="border-t border-gray-200 dark:border-gray-800 w-4/5 mx-auto my-2"></div> <button class="block px-4 py-2 text-default hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" role="menuitem" id="set-default-lang"> <div class="inline-flex items-center"> Set English as Default </div> </button> </li> </ul> <script type="module">function a(){const t=localStorage.getItem("lang"),e=document.getElementById("EN-check"),n=document.getElementById("ZH-check");e!==null&&n!==null&&(t==="en"?(e.classList.remove("hidden"),n.classList.add("hidden")):t==="zh"&&(n.classList.remove("hidden"),e.classList.add("hidden")))}document.addEventListener("DOMContentLoaded",()=>{a()});const l=document.getElementById("set-default-lang");l?.addEventListener("click",()=>{const t=document.getElementById("lang-data");if(t!=null){const e=t.dataset.lang;e!=null&&(localStorage.setItem("lang",e),a())}});</script> </div> <button id="theme-dropdown-button" data-dropdown-toggle="theme-dropdown-menu" type="button" class="group p-2 w-10 h-10 text-default hover:bg-gray-100 dark:hover:bg-page focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600 rounded-lg flex items-center justify-center"> <svg viewBox="0 0 1024 1024" stroke="currentColor" class="w-5 h-5 text-default fill-current group-hover:text-secondary hidden" id="theme_icon_system"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-computer"></use> </svg> <svg viewBox="0 0 1024 1024" stroke="currentColor" class="w-5 h-5 text-default fill-current group-hover:text-secondary hidden" id="theme_icon_dark"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-moon"></use> </svg> <svg viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5 text-default fill-current group-hover:text-secondary hidden" id="theme_icon_light"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-sun"></use> </svg> </button> <!-- Dropdown --> <div class="z-50 hidden my-4 text-base list-none bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-gray-700" id="theme-dropdown-menu"> <ul class="py-2 font-medium" role="none"> <li class="hover:bg-gray-100 dark:hover:bg-gray-600"> <button class="flex px-4 py-2 text-sm align-text-center dark:hover:text-white text-default" id="theme_button_light"> <svg class="w-5 h-5" viewBox="0 0 1024 1024" stroke-width="2" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-sun"></use> </svg> <span class="ml-2 dark:hover:text-white">Light</span> </button> </li> <li class="hover:bg-gray-100 dark:hover:bg-gray-600"> <button class="flex px-4 py-2 text-sm align-text-center dark:hover:text-white text-default" id="theme_button_dark"> <svg class="w-5 h-5"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-moon"></use> </svg> <span class="ml-2 text-default dark:hover:text-white">Dark</span> </button> </li> <li class="hover:bg-gray-100 dark:hover:bg-gray-600"> <button class="flex px-4 py-2 text-sm align-text-center dark:hover:text-white text-default" id="theme_button_system"> <svg class="w-5 h-5"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-computer"></use> </svg> <span class="ml-2 dark:hover:text-white">System</span> </button> </li> </ul> </div> <script>
  // 获取按钮
  var themeButtonLight = document.getElementById('theme_button_light');
  var themeButtonDark = document.getElementById('theme_button_dark');
  var themeButtonSystem = document.getElementById('theme_button_system');
  // 获取图标
  var themeToggleDarkIcon = document.getElementById('theme_icon_dark');
  var themeToggleLightIcon = document.getElementById('theme_icon_light');
  var themeToggleSystemIcon = document.getElementById('theme_icon_system');

  function setTheme() {
    if (
      localStorage.getItem('color-theme') === 'dark' ||
      (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  }

  function setThemeButton() {
    let theme = localStorage.getItem('color-theme');
    if (theme === 'dark') {
      themeToggleDarkIcon.classList.remove('hidden');
      themeToggleLightIcon.classList.add('hidden');
      themeToggleSystemIcon.classList.add('hidden');
    } else if (theme === 'light') {
      themeToggleDarkIcon.classList.add('hidden');
      themeToggleLightIcon.classList.remove('hidden');
      themeToggleSystemIcon.classList.add('hidden');
    } else {
      themeToggleDarkIcon.classList.add('hidden');
      themeToggleLightIcon.classList.add('hidden');
      themeToggleSystemIcon.classList.remove('hidden');
    }
  }

  function resetTheme() {
    setTheme();
    setThemeButton();
  }

  resetTheme();

  // 监听暗黑模式的变化
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
    resetTheme();
  });

  // 保证其他的页面也能够监听到 localStorage 的变化
  window.addEventListener('storage', function (event) {
    if (event.key === 'color-theme') {
      resetTheme();
    }
  });


  // Listen for clicks on the button themeToggleDarkIcon
  themeButtonDark.addEventListener('click', function () {
    localStorage.setItem('color-theme', 'dark');
    resetTheme();
  });

  // // Listen for clicks on the button themeToggleLightIcon
  themeButtonLight.addEventListener('click', function () {
    localStorage.setItem('color-theme', 'light');
    resetTheme();
  });

  // // Listen for clicks on the button themeToggleSystemIcon
  themeButtonSystem.addEventListener('click', function () {
    localStorage.removeItem('color-theme');
    resetTheme();
  });
</script> <div id="docsearch" class="group w-10 h-10 text-default hover:bg-gray-100 dark:hover:bg-page focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600 rounded-lg flex items-center justify-center"> <svg width="20" height="20" viewBox="0 0 20 20" aria-hidden="true" class="DocSearch-Search-Icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg> </div> </div> <button data-collapse-toggle="navbar-solid-bg" type="button" class="inline-flex items-center p-2 mx-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-solid-bg" aria-expanded="false" id="navbar-toggle-button"> <span class="sr-only">Open main menu</span> <svg class="w-5 h-5 text-default" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14"> <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"></path> </svg> </button> <nav class="hidden w-full md:block md:w-auto px-4 z-40" id="navbar-solid-bg"> <ul class="flex flex-col font-bold mt-4 rounded-lg bg-gray-50 md:space-x-8 rtl:space-x-reverse md:flex-row md:mt-0 md:border-0 md:bg-transparent dark:bg-gray-800 md:dark:bg-transparent dark:border-gray-700"> <a href="/en/" class="block py-2 px-3 md:p-0 rounded  text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent"> Home </a><a href="/en/posts/" class="block py-2 px-3 md:p-0 rounded text-invert bg-secondary md:bg-transparent md:text-secondary md:dark:bg-transparent" aria-current="page"> Articles </a><a href="/en/weekly/" class="block py-2 px-3 md:p-0 rounded  text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent"> Weekly </a><a href="/en/snippet/" class="block py-2 px-3 md:p-0 rounded  text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent"> Quick Tips </a><a href="/en/about/" class="block py-2 px-3 md:p-0 rounded  text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent"> About </a> </ul> </nav> </div> </div> <div id="placeholder" class="hidden" data-astro-cid-4wsjtibl></div> </div> <script>(function(){const enableSticky = true;
const enableStickyInMobile = true;

  window.onload = function () {
    checkStickyHeader();
    stickySetup();
  };

  window.addEventListener('resize', stickySetup);

  function checkStickyHeader() {
    const title = document.getElementById('blogTitle');
    const stickyHeader = document.getElementById('stickyHeader');
    const placeholder = document.getElementById('placeholder');

    if (title && stickyHeader && placeholder) {
      const offset = title.offsetTop + title.offsetHeight;

      if (shouldStick() && window.scrollY >= offset) {
        stickyHeader.classList.add('sticky');
        placeholder.style.display = 'block';
        placeholder.style.height = `${stickyHeader.offsetHeight}px`;
      } else {
        stickyHeader.classList.remove('sticky');
        placeholder.style.display = 'none';
      }
    }
  }

  function shouldStick() {
    if (!enableSticky) return false;

    let isMobile = window.matchMedia('(max-width: 640px)').matches;
    if (isMobile && !enableStickyInMobile) return false;

    return true;
  }

  function stickySetup() {
    window.onscroll = checkStickyHeader;
  }
})();</script>  </header> <main class="w-full mx-auto max-w-3xl p-4 md:p-6 "> <div class="container mx-auto space-y-6 sm:space-y-12">   <div class="mx-auto space-y-4 text-center py-10" style="width:80%"> <div class="flex mx-auto justify-center"> <div class="flex mx-auto justify-center"> <a class="text-xs font-medium sm:font-semibold mx-2 text-muted hover:text-secondary" href="/en/tags/SwiftData/">
#SwiftData </a><a class="text-xs font-medium sm:font-semibold mx-2 text-muted hover:text-secondary" href="/en/tags/Swift/">
#Swift </a> <a class="text-xs font-medium sm:font-semibold mx-2 text-muted hover:text-secondary" href="/zh/posts/how-to-dynamically-construct-complex-predicates-for-swiftdata/" id="language-switcher-for-topic"> #中文版 </a> </div> </div> <h1 class="text-2xl font-bold leadi md:text-3xl text-heading">How to Dynamically Construct Complex Predicates for SwiftData</h1> <p class="text-sm text-default"> <a itemprop="author" href="https://x.com/intent/follow?screen_name=fatbobman" target="_blank" class="hover:text-secondary font-medium">Fatbobman</a> <!-- <time datetime={`${post.data.publishDate.toISOString()}`}>{date}</time> --> </p> <p class="text-xs text-muted"> Published on <time datetime="2024-03-07T00:12:00.000Z">Mar 7, 2024</time>  </p> </div> <svg style="display: none;"> <symbol id="icon-clipboard" viewBox="0 0 1024 1024"> <path d="M426.666667 42.666667l170.666667 0q41.344 0 74.325333 23.850667t46.336 61.482667l50.005333 0q52.992 0 90.496 37.504t37.504 90.496l0 597.333333q0 52.992-37.504 90.496t-90.496 37.504l-512 0q-52.992 0-90.496-37.504t-37.504-90.496l0-597.333333q0-52.992 37.504-90.496t90.496-37.504l50.005333 0q13.312-37.674667 46.336-61.482667t74.325333-23.850667zM768 213.333333l-50.005333 0q-13.312 37.674667-46.336 61.482667t-74.325333 23.850667l-170.666667 0q-41.344 0-74.325333-23.850667t-46.336-61.482667l-50.005333 0q-17.664 0-30.165333 12.501333t-12.501333 30.165333l0 597.333333q0 17.664 12.501333 30.165333t30.165333 12.501333l512 0q17.664 0 30.165333-12.501333t12.501333-30.165333l0-597.333333q0-17.664-12.501333-30.165333t-30.165333-12.501333zM597.333333 128l-170.666667 0q-17.664 0-30.165333 12.501333t-12.501333 30.165333 12.501333 30.165333 30.165333 12.501333l170.666667 0q17.664 0 30.165333-12.501333t12.501333-30.165333-12.501333-30.165333-30.165333-12.501333z"></path> </symbol> <symbol id="icon-check" viewBox="0 0 1024 1024"> <path d="M421.858 683.366l401.796-448.518c18.66-20.828 50.668-22.586 71.498-3.928 20.828 18.66 22.586 50.67 3.928 71.498L463.638 788.494c-18.606 20.768-50.5 22.586-71.344 4.066l-263.29-233.924c-20.906-18.572-22.796-50.576-4.222-71.48 18.574-20.906 50.576-22.796 71.48-4.222L421.86 683.366z"></path> </symbol> </svg> <div class="relative" id="article-area"> <article class="prose dark:prose-invert mx-auto w-full"> <div> 

<p><code>NSCompoundPredicate</code> allows developers to combine multiple <code>NSPredicate</code> objects into a single compound predicate. This mechanism is particularly suited for scenarios that require data filtering based on multiple criteria. However, in the new Foundation framework restructured with Swift, the direct functionality corresponding to <code>NSCompoundPredicate</code> is missing. This change poses a significant challenge for developers who wish to build applications using SwiftData. This article aims to explore how to dynamically construct complex predicates that meet the requirements of SwiftData, utilizing <code>PredicateExpression</code>, under the current technical conditions.</p>
<blockquote>
<p>Update on March 11, 2024: Within less than a week of this article’s publication, Noah Kamara has developed a predicate merging solution compatible with SwiftData — <a href="https://github.com/NoahKamara/CompoundPredicate?&utm_source=Fatbobman%20Blog&utm_medium=web&utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">CompoundPredicate</a>. An introduction and explanation of this solution are provided at the end of the article.</p>
<p>Update on Jun 2024: introduces a new official predicate combine method compatible with iOS 17.4+ / macOS 14.4+.</p>
</blockquote>
<div class="dynamic-ad-container pt-4"></div>
<h2 id="challenge-implementing-flexible-data-filtering-capabilities">Challenge: Implementing Flexible Data Filtering Capabilities</h2>
<p>During the development of the new version of the <a href="/healthnotes/" target="_blank">Health Notes</a> app, I decided to replace the traditional Core Data with SwiftData to leverage the modern features of the Swift language. One of the core aspects of this data-centric application is to provide users with flexible and powerful data filtering capabilities. In this process, I faced a key challenge: how to construct diversified filtering schemes for user data retrieval. Here are some predicates used for fetching Memo instances:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">extension</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Memo</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">  public</span><span style="color:#AB5959;--shiki-dark:#F286C4"> static</span><span style="color:#AB5959;--shiki-dark:#F286C4"> func</span><span style="color:#59873A;--shiki-dark:#62E884"> predicateFor</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#59873A;--shiki-dark:#62E884">_</span><span style="color:#393A34;font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic"> filter</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: MemoPredicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Predicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#999999;--shiki-dark:#F286C4">?</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    var</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> result: Predicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#999999;--shiki-dark:#F286C4">?</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    switch</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filter </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    case</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">filterAllMemo</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#7B7F8B">      // nil</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">      break</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    case</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">filterAllGlobalMemo</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">      result </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">itemData</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ==</span><span style="color:#1E754F;--shiki-dark:#BF9EEE"> nil</span><span style="color:#999999;--shiki-dark:#F6F6F4"> }</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    case</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#998418;--shiki-dark:#97E1F1">filterAllMemoOfRootNote</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">noteID</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">      result </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        if</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> itemData </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.itemData, </span><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> item </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> itemData.item, </span><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> note </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> item.note </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">          return</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> note.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">persistentModelID</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ==</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> noteID </span><span style="color:#AB5959;--shiki-dark:#F286C4">||</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> note.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">parent</span><span style="color:#AB5959;--shiki-dark:#F286C4">?</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">persistentModelID</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ==</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> noteID</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        }</span><span style="color:#1E754F;--shiki-dark:#F286C4"> else</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">          return</span><span style="color:#1E754F;--shiki-dark:#BF9EEE"> false</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">      }</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    case</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">filterMemoWithImage</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">      result </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">hasImages</span><span style="color:#999999;--shiki-dark:#F6F6F4"> }</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    case</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">filterMemoWithStar</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">      result </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">star</span><span style="color:#999999;--shiki-dark:#F6F6F4"> }</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    case</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#998418;--shiki-dark:#97E1F1">filterMemoContainsKeyword</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">keyword</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">      result </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        if</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> content </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.content </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">          return</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> content.</span><span style="color:#998418;--shiki-dark:#97E1F1">localizedStandardContains</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">keyword</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        }</span><span style="color:#1E754F;--shiki-dark:#F286C4"> else</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">          return</span><span style="color:#1E754F;--shiki-dark:#BF9EEE"> false</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">      }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    }</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    return</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> result</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<p>In the early versions of the application, users could flexibly combine filtering conditions, such as incorporating star marks with images, or filtering by specific notes and keywords. Previously, such dynamic combination requirements could be easily achieved using <code>NSCompoundPredicate</code>, which allows developers to dynamically combine multiple predicates and use the result as the retrieval condition for Core Data. However, after switching to SwiftData, I found the corresponding functionality to dynamically combine Swift Predicates was missing, which posed a significant constraint on the core functionality of the application. Addressing this issue is crucial for maintaining the functionality of the app and the satisfaction of its users.</p>
<h2 id="combining-nspredicate-methods">Combining NSPredicate Methods</h2>
<p><code>NSCompoundPredicate</code> offers a powerful way for developers to dynamically combine multiple <code>NSPredicate</code> instances into a single compound predicate. Here is an example demonstrating how to use the <code>AND</code> logical operator to combine two separate predicates <code>a</code> and <code>b</code> into a new predicate:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> a </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> NSPredicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">format</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">name = %@</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> b </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> NSPredicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">format</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">age &lt; %d</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#2F798A;--shiki-dark:#BF9EEE">100</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> result </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> NSCompoundPredicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">type</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">and</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#998418;--shiki-dark:#97E1F1">subpredicates</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> [a, b]</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span></code></pre></div>
<p>Moreover, since <code>NSPredicate</code> allows for construction via strings, developers can utilize this feature to manually build new predicate expressions by combining the <code>predicateFormat</code> property. This method offers additional flexibility, enabling developers to directly manipulate and combine the string representations of existing predicates:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> a </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> NSPredicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">format</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">name = %@</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> b </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> NSPredicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">format</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">age &lt; %d</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#2F798A;--shiki-dark:#BF9EEE">100</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> andFormatString </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> a.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">predicateFormat</span><span style="color:#AB5959;--shiki-dark:#F286C4"> +</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98"> AND </span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#AB5959;--shiki-dark:#F286C4"> +</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> b.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">predicateFormat</span><span style="color:#A0ADA0;--shiki-dark:#7B7F8B"> // name == &quot;fat&quot; AND age &lt; 100</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> result </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> NSPredicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">format</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> andFormatString</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span></code></pre></div>
<p>Unfortunately, while these methods are very effective and flexible when using <code>NSPredicate</code>, they are not applicable to Swift Predicate. This means that when transitioning to using SwiftData, we need to explore new ways to achieve similar dynamic predicate combination functionality.</p>
<h2 id="the-challenge-of-combining-swift-predicates">The Challenge of Combining Swift Predicates</h2>
<p>In the previous article “<a href="/en/posts/swift-predicate-usage-composition-and-considerations/" target="_blank">Swift Predicate: Usage, Composition, and Considerations</a>,” we explored the structure and composition of Swift Predicates in detail. In essence, developers construct the <code>Predicate</code> structure by declaring types that conform to the <code>PredicateExpression</code> protocol. Due to the potentially complex nature of this process, Foundation provides the <code>#Predicate</code> macro to simplify the operation.</p>
<p>When we build Swift Predicates, the <code>#Predicate</code> macro automatically converts these operators into corresponding predicate expressions:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> predicate </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">name</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ==</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#AB5959;--shiki-dark:#F286C4"> &amp;&amp;</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">age</span><span style="color:#AB5959;--shiki-dark:#F286C4"> &lt;</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 100</span><span style="color:#999999;--shiki-dark:#F6F6F4"> }</span></span></code></pre></div>
<p>After the macro is expanded, we can see the detailed composition of the predicate expression:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">Foundation.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4">({</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">    PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Conjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">        lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Equal</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">            lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_KeyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">                root</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">$0</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">                keyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> \.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">name</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">            )</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">            rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        )</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">        rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Comparison</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">            lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_KeyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">                root</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">$0</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">                keyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> \.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">age</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">            )</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">            rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#2F798A;--shiki-dark:#BF9EEE">100</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">            op</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">lessThan</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        )</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    )</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">})</span></span></code></pre></div>
<p>Here, <code>PredicateExpressions.build_Conjunction</code> creates a <code>PredicateExpressions.Conjunction</code> expression corresponding to the <code>&amp;&amp;</code> operator. It connects two expressions that return Boolean values, forming a complete expression. Theoretically, if we could extract and combine expressions from Swift Predicates individually, we could dynamically combine predicates based on the <code>AND</code> logic.</p>
<blockquote>
<p>The expression types corresponding to <code>||</code> and <code>!</code> are <code>PredicateExpressions.Disjunction</code> and <code>PredicateExpressions.Negation</code>, respectively.</p>
</blockquote>
<p>Given that Swift Predicate provides an <code>expression</code> attribute, it’s natural to consider utilizing this attribute to achieve such dynamic combinations:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> a </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People1</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">name</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ==</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> b </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People1</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">age</span><span style="color:#AB5959;--shiki-dark:#F286C4"> &lt;</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 10</span><span style="color:#999999;--shiki-dark:#F6F6F4"> }</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> combineExpression </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Conjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> a.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">expression</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#998418;--shiki-dark:#97E1F1">rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> b.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">expression</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span></code></pre></div>
<p>However, attempting the above code results in a compilation error:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">Type &#39;</span><span style="color:#1E754F;--shiki-dark:#F286C4">any</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> StandardPredicateExpression</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">&#39; cannot conform to &#39;PredicateExpression&#39;</span></span></code></pre></div>
<p>A deeper exploration into the implementation of the <code>Predicate</code> structure and <code>PredicateExpressions.Conjunction</code> reveals the constraints involved:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">public</span><span style="color:#AB5959;--shiki-dark:#F286C4"> struct</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Predicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#1E754F;--shiki-dark:#F286C4">each</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> Input</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> :</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Sendable </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    public</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> expression : </span><span style="color:#1E754F;--shiki-dark:#F286C4">any</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> StandardPredicateExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    public</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> variable: </span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#1E754F;--shiki-dark:#F286C4">repeat</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.Variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#1E754F;--shiki-dark:#F286C4">each</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Input</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">    </span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    public</span><span style="color:#AB5959;--shiki-dark:#F286C4"> init</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#59873A;--shiki-dark:#62E884">_</span><span style="color:#393A34;font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic"> builder</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: </span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#1E754F;--shiki-dark:#F286C4">repeat</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.Variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#1E754F;--shiki-dark:#F286C4">each</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Input</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;)</span><span style="color:#999999;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#1E754F;--shiki-dark:#F286C4"> any</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> StandardPredicateExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;)</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">        self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">variable</span><span style="color:#AB5959;--shiki-dark:#F286C4"> =</span><span style="color:#999999;--shiki-dark:#F6F6F4"> (</span><span style="color:#1E754F;--shiki-dark:#F286C4">repeat</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Variable</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#1E754F;--shiki-dark:#F286C4">each</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Input</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4">())</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">        self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">expression</span><span style="color:#AB5959;--shiki-dark:#F286C4"> =</span><span style="color:#998418;--shiki-dark:#97E1F1"> builder</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#1E754F;--shiki-dark:#F286C4">repeat</span><span style="color:#1E754F;--shiki-dark:#F286C4"> each</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    }</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">    </span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    public</span><span style="color:#AB5959;--shiki-dark:#F286C4"> func</span><span style="color:#59873A;--shiki-dark:#62E884"> evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#59873A;--shiki-dark:#62E884">_</span><span style="color:#393A34;font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic"> input</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: </span><span style="color:#1E754F;--shiki-dark:#F286C4">repeat</span><span style="color:#1E754F;--shiki-dark:#F286C4"> each</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Input</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> throws</span><span style="color:#AB5959;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        try</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> expression.</span><span style="color:#998418;--shiki-dark:#97E1F1">evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">            .</span><span style="color:#AB5959;--shiki-dark:#F286C4">init</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#1E754F;--shiki-dark:#F286C4">repeat</span><span style="color:#999999;--shiki-dark:#F6F6F4"> (</span><span style="color:#1E754F;--shiki-dark:#F286C4">each</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> variable, </span><span style="color:#1E754F;--shiki-dark:#F286C4">each</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> input</span><span style="color:#999999;--shiki-dark:#F6F6F4">))</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        )</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">extension</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> PredicateExpressions</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    public</span><span style="color:#AB5959;--shiki-dark:#F286C4"> struct</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Conjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">        LHS</span><span style="color:#999999;--shiki-dark:#F6F6F4"> :</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> PredicateExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">        RHS</span><span style="color:#999999;--shiki-dark:#F6F6F4"> :</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> PredicateExpression</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    &gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> :</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> PredicateExpression</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    where</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">        LHS.Output </span><span style="color:#AB5959;--shiki-dark:#F286C4">==</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Bool</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">        RHS.Output </span><span style="color:#AB5959;--shiki-dark:#F286C4">==</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Bool</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        public</span><span style="color:#1E754F;--shiki-dark:#F286C4"> typealias</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Output</span><span style="color:#999999;--shiki-dark:#F286C4"> =</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Bool</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">        </span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        public</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> lhs: LHS</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        public</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> rhs: RHS</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">        </span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        public</span><span style="color:#AB5959;--shiki-dark:#F286C4"> init</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#62E884;--shiki-dark-font-style:italic">lhs</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: LHS, </span><span style="color:#59873A;font-style:inherit;--shiki-dark:#62E884;--shiki-dark-font-style:italic">rhs</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: RHS</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">            self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">lhs</span><span style="color:#AB5959;--shiki-dark:#F286C4"> =</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> lhs</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">            self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">rhs</span><span style="color:#AB5959;--shiki-dark:#F286C4"> =</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> rhs</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        }</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">        </span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        public</span><span style="color:#AB5959;--shiki-dark:#F286C4"> func</span><span style="color:#59873A;--shiki-dark:#62E884"> evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#59873A;--shiki-dark:#62E884">_</span><span style="color:#393A34;font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic"> bindings</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: PredicateBindings</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> throws</span><span style="color:#AB5959;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">            try</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> lhs.</span><span style="color:#998418;--shiki-dark:#97E1F1">evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">bindings</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> &amp;&amp;</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> rhs.</span><span style="color:#998418;--shiki-dark:#97E1F1">evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">bindings</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    }</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">    </span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    public</span><span style="color:#AB5959;--shiki-dark:#F286C4"> static</span><span style="color:#AB5959;--shiki-dark:#F286C4"> func</span><span style="color:#59873A;--shiki-dark:#62E884"> build_Conjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">LHS</span><span style="color:#999999;--shiki-dark:#F6F6F4">,</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> RHS</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;(</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#62E884;--shiki-dark-font-style:italic">lhs</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: LHS, </span><span style="color:#59873A;font-style:inherit;--shiki-dark:#62E884;--shiki-dark-font-style:italic">rhs</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: RHS</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Conjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">LHS, RHS</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">        Conjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> lhs, </span><span style="color:#998418;--shiki-dark:#97E1F1">rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<p>The issue lies in the <code>expression</code> property being of the type <code>any StandardPredicateExpression&lt;Bool&gt;</code>, which doesn’t contain sufficient information to identify the specific <code>PredicateExpression</code> implementation type. Since <code>Conjunction</code> requires the exact types of the left and right sub-expressions for initialization, we are unable to use the <code>expression</code> property directly to dynamically construct new combined expressions.</p>
<h2 id="dynamic-predicate-construction-strategy">Dynamic Predicate Construction Strategy</h2>
<p>Although we cannot directly utilize the <code>expression</code> attribute of Swift Predicate, there are still alternative ways to achieve the goal of dynamically constructing predicates. The key lies in understanding how to extract or independently create expressions from existing predicates and utilize expression builders such as <code>build_Conjunction</code> or <code>build_Disjunction</code> to generate new predicate expressions.</p>
<h3 id="utilizing-the-predicate-macro-to-construct-expressions">Utilizing the <code>#Predicate</code> Macro to Construct Expressions</h3>
<p>Directly constructing predicates based on expression types can be quite cumbersome. A more practical method is to use the <code>#Predicate</code> macro, allowing developers to indirectly build and extract predicate expressions. This approach is inspired by the contribution of community member <a href="https://stackoverflow.com/users/11450810/nok?&utm_source=Fatbobman%20Blog&utm_medium=web&utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">nOk</a> on <a href="https://stackoverflow.com/a/76861465/12260342?&utm_source=Fatbobman%20Blog&utm_medium=web&utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">Stack Overflow</a>.</p>
<p>For example, consider the predicate built using the <code>#Predicate</code> macro:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filterByName </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">name</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ==</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> }</span></span></code></pre></div>
<p>By examining the code expanded from the macro, we can extract the part of the code that forms the predicate expression:</p>
<p><picture>
                    <source media="(max-width: 479px)" srcset="https://cdn.fatbobman.com/image-20240304161732812-zipic.png?imageView2/0/w/500"/>
                    <source media="(max-width: 767px)" srcset="https://cdn.fatbobman.com/image-20240304161732812-zipic.png?imageView2/0/w/768"/>
                    <source media="(max-width: 1024px)" srcset="https://cdn.fatbobman.com/image-20240304161732812-zipic.png?imageView2/0/w/1024"/>
                    <img src="https://cdn.fatbobman.com/image-20240304161732812-zipic.png" alt="image-20240304161732812" loading="lazy" decoding="async"/>
                  </picture></p>
<p>Since constructing an instance of PredicateExpression requires different parameters based on the type of expression, the following method cannot be used to generate the correct expression:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> expression </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Equal</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">  lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_KeyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">      root</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">$0</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#A0ADA0;--shiki-dark:#7B7F8B">// error: Anonymous closure argument not contained in a closure</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">      keyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> \.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">name</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  )</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">  rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span></code></pre></div>
<p>Although we cannot directly replicate the expression to create a new <code>PredicateExpression</code> instance, we can redefine the same expression using a closure:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> expression </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#999999;--shiki-dark:#F6F6F4"> (</span><span style="color:#998418;--shiki-dark:#97E1F1">people</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Variable</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#1E754F;--shiki-dark:#F286C4"> in</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">  PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Equal</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">      lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_KeyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">          root</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">people</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">          keyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> \.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">name</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">      )</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">      rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  )</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<h3 id="creating-parameterized-expression-closures">Creating Parameterized Expression Closures</h3>
<p>Since the right-hand side value of the expression (such as <code>&quot;fat&quot;</code>) might need to be dynamically assigned, we can design a closure that returns another expression closure. This allows the name to be determined at runtime:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filterByNameExpression </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#999999;--shiki-dark:#F6F6F4"> (</span><span style="color:#998418;--shiki-dark:#97E1F1">name</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> String</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#1E754F;--shiki-dark:#F286C4"> in</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  {</span><span style="color:#999999;--shiki-dark:#F6F6F4"> (</span><span style="color:#998418;--shiki-dark:#97E1F1">people</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Variable</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#1E754F;--shiki-dark:#F286C4"> in</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">    PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Equal</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">      lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_KeyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">        root</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">people</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">        keyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> \.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">name</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">      )</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">      rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">name</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    )</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<p>Using this closure that returns an expression, we can dynamically construct the predicate:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> name </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> predicate </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">filterByNameExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">name</span><span style="color:#999999;--shiki-dark:#F6F6F4">))</span></span></code></pre></div>
<h3 id="combining-expressions-to-construct-new-predicates">Combining Expressions to Construct New Predicates</h3>
<p>Once we have defined the closures that return expressions, we can use <code>PredicateExpressions.build_Conjunction</code> or other logical constructors to create new predicates containing complex logic:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#7B7F8B">// #Predicate&lt;People&gt; { $0.age &lt; 10 }</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filterByAgeExpression </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#999999;--shiki-dark:#F6F6F4"> (</span><span style="color:#998418;--shiki-dark:#97E1F1">age</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Int</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#1E754F;--shiki-dark:#F286C4"> in</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  {</span><span style="color:#999999;--shiki-dark:#F6F6F4"> (</span><span style="color:#998418;--shiki-dark:#97E1F1">people</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Variable</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#1E754F;--shiki-dark:#F286C4"> in</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">    PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Comparison</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">        lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_KeyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">            root</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">people</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">            keyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> \.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">age</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        )</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">        rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">age</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">        op</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">lessThan</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    )</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#7B7F8B">// Combine new Predicate</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> predicate </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">  PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">Conjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">    lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#998418;--shiki-dark:#97E1F1"> filterByNameExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">name</span><span style="color:#999999;--shiki-dark:#F6F6F4">)(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">$0</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">    rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#998418;--shiki-dark:#97E1F1"> filterByAgeExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">age</span><span style="color:#999999;--shiki-dark:#F6F6F4">)(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">$0</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  )</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<p>The complete process is as follows:</p>
<ol>
<li>Use the <code>#Predicate</code> macro to construct the initial predicate.</li>
<li>Extract the expression from the expanded macro code and create a closure that generates the expression.</li>
<li>Combine two expressions into a new one using a Boolean logic expression (such as <code>Conjunction</code>), thereby constructing a new predicate instance.</li>
<li>Repeat the above steps if multiple expressions need to be combined.</li>
</ol>
<p>This method, although requiring some additional steps to manually create and combine expressions, provides a possibility for dynamically constructing complex Swift Predicates.</p>
<h3 id="dynamic-combination-of-expressions">Dynamic Combination of Expressions</h3>
<p>Having mastered the complete process from predicate to expression and back to predicate, I now need to create a method that can dynamically combine expressions and generate predicates according to the requirements of my current project.</p>
<p>Drawing inspiration from an example provided by Jeremy Schonfeld on <a href="https://forums.swift.org/t/pitch-swift-predicates/62000/50?&utm_source=Fatbobman%20Blog&utm_medium=web&utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">Swift Forums</a>, we can construct a method to dynamically synthesize predicates for retrieving Memo data, as shown below:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">extension</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Memo</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">  static</span><span style="color:#AB5959;--shiki-dark:#F286C4"> func</span><span style="color:#59873A;--shiki-dark:#62E884"> combinePredicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#59873A;--shiki-dark:#62E884">_</span><span style="color:#393A34;font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic"> filters</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: </span><span style="color:#999999;--shiki-dark:#F6F6F4">[</span><span style="color:#393A34;--shiki-dark:#F6F6F4">MemoPredicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">])</span><span style="color:#AB5959;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Predicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">    func</span><span style="color:#59873A;--shiki-dark:#62E884"> buildConjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#62E884;--shiki-dark-font-style:italic">lhs</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: </span><span style="color:#1E754F;--shiki-dark:#F286C4">some</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> StandardPredicateExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#59873A;font-style:inherit;--shiki-dark:#62E884;--shiki-dark-font-style:italic">rhs</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: </span><span style="color:#1E754F;--shiki-dark:#F286C4">some</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> StandardPredicateExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#1E754F;--shiki-dark:#F286C4"> any</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> StandardPredicateExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">      PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">Conjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> lhs, </span><span style="color:#998418;--shiki-dark:#97E1F1">rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    return</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4">({</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> memo </span><span style="color:#1E754F;--shiki-dark:#F286C4">in</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">      var</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> conditions: </span><span style="color:#999999;--shiki-dark:#F6F6F4">[</span><span style="color:#1E754F;--shiki-dark:#F286C4">any</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> StandardPredicateExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;]</span><span style="color:#AB5959;--shiki-dark:#F286C4"> =</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> []</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">      for</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filter </span><span style="color:#1E754F;--shiki-dark:#F286C4">in</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filters </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        switch</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filter </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        case</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">filterAllMemo</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">          conditions.</span><span style="color:#998418;--shiki-dark:#97E1F1">append</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">Self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Expressions</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">allMemos</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">))</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        case</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">filterAllGlobalMemo</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">          conditions.</span><span style="color:#998418;--shiki-dark:#97E1F1">append</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">Self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Expressions</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">allGlobalMemos</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">))</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        case</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#998418;--shiki-dark:#97E1F1">filterAllMemoOfRootNote</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">noteID</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">          conditions.</span><span style="color:#998418;--shiki-dark:#97E1F1">append</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">Self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Expressions</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">memosOfRootNote</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">noteID</span><span style="color:#999999;--shiki-dark:#F6F6F4">)(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">))</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        case</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">filterMemoWithImage</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">          conditions.</span><span style="color:#998418;--shiki-dark:#97E1F1">append</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">Self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Expressions</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">memoWithImage</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">))</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        case</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">filterMemoWithStar</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">          conditions.</span><span style="color:#998418;--shiki-dark:#97E1F1">append</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">Self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Expressions</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">memosWithStar</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">))</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        case</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> .</span><span style="color:#998418;--shiki-dark:#97E1F1">filterMemoContainsKeyword</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">keyword</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">          conditions.</span><span style="color:#998418;--shiki-dark:#97E1F1">append</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">Self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Expressions</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">memosContainersKeyword</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">keyword</span><span style="color:#999999;--shiki-dark:#F6F6F4">)(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">))</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">      }</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">      guard</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> first </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> conditions.</span><span style="color:#998418;--shiki-dark:#BF9EEE">first</span><span style="color:#1E754F;--shiki-dark:#F286C4"> else</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        return</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Value</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#1E754F;--shiki-dark:#BF9EEE">true</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">      let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> closure: </span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#1E754F;--shiki-dark:#F286C4">any</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> StandardPredicateExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#1E754F;--shiki-dark:#F286C4">any</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> StandardPredicateExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;)</span><span style="color:#999999;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#1E754F;--shiki-dark:#F286C4"> any</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> StandardPredicateExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#AB5959;--shiki-dark:#F286C4"> =</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">        buildConjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">lhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#998418;--shiki-dark:#97E1F1">rhs</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $1</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">      return</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> conditions.</span><span style="color:#998418;--shiki-dark:#97E1F1">dropFirst</span><span style="color:#999999;--shiki-dark:#F6F6F4">()</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">reduce</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">first, closure</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    })</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<p>Usage example:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> predicate </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> Memo.</span><span style="color:#998418;--shiki-dark:#97E1F1">combinePredicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">[.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">filterMemoWithImage</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,.</span><span style="color:#998418;--shiki-dark:#97E1F1">filterMemoContainsKeyword</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">keyword</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">]</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span></code></pre></div>
<p>In the current implementation, due to Swift’s strong type system (each filtering logic corresponds to a specific predicate expression type), constructing a flexible and generic combination mechanism similar to <code>NSCompoundPredicate</code> appears relatively complex. The challenge we face is how to maintain type safety while implementing a sufficiently flexible strategy for combining expressions.</p>
<p>For my application scenario, the primary requirement is to handle combinations of the <code>Conjunction</code> (logical AND) type, which is relatively straightforward. If future requirements extend to include <code>Disjunction</code> (logical OR), we will need to introduce additional logical judgments and identifiers in the combination process to flexibly address different logical combination requirements while maintaining code readability and maintainability. This may require more meticulous design to adapt to the variable combination logic while ensuring not to sacrifice Swift’s type safety features.</p>
<blockquote>
<p>The complete code can be viewed <a href="https://gist.github.com/fatbobman/8e10c7a811c6cd384b943d1a25206b7b?&utm_source=Fatbobman%20Blog&utm_medium=web&utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">here</a>.</p>
</blockquote>
<h2 id="an-implementation-inapplicable-to-swiftdata">An Implementation Inapplicable to SwiftData</h2>
<blockquote>
<p>The updated solution provided by Noah Kamara is referenced in the following section.</p>
</blockquote>
<p>Noah Kamara showcased a snippet of code in his <a href="https://gist.github.com/NoahKamara/d8660881b2ef8d6be18b8e26ed349bb7?&utm_source=Fatbobman%20Blog&utm_medium=web&utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">Gist</a> that provides capabilities similar to <code>NSCompoundPredicate</code>, making the combination of Swift Predicates straightforward and convenient. This method appears to be an intuitive and powerful solution:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> people </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> People</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">name</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#998418;--shiki-dark:#97E1F1">age</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 50</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filterByName </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">name</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ==</span><span style="color:#B5695977;--shiki-dark:#DEE492"> &quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">fat</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> }</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filterByAge </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">age</span><span style="color:#AB5959;--shiki-dark:#F286C4"> &lt;</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 10</span><span style="color:#999999;--shiki-dark:#F6F6F4"> }</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> combinedPredicate </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> [filterByName, filterByAge].</span><span style="color:#998418;--shiki-dark:#97E1F1">conjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">()</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">try</span><span style="color:#998418;--shiki-dark:#97E1F1"> XCTAssertFalse</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">combinedPredicate.</span><span style="color:#998418;--shiki-dark:#97E1F1">evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">people</span><span style="color:#999999;--shiki-dark:#F6F6F4">))</span><span style="color:#A0ADA0;--shiki-dark:#7B7F8B"> // return false</span></span></code></pre></div>
<p>Despite its appeal, we cannot adopt this method in SwiftData. Why does this seemingly perfect solution encounter obstacles in SwiftData?</p>
<p>Noah Kamara introduced a custom type named <code>VariableWrappingExpression</code> in the code, which implements the <code>StandardPredicateExpression</code> protocol to encapsulate the expression extracted from the Predicate’s <code>expression</code> attribute. This encapsulation method does not involve the specific type of the expression; it merely calls the evaluation method of the encapsulated expression during the predicate evaluation.</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">struct</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> VariableWrappingExpression</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;:</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> StandardPredicateExpression </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> predicate: Predicate</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> variable: PredicateExpressions.Variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">    </span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">    func</span><span style="color:#59873A;--shiki-dark:#62E884"> evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#59873A;--shiki-dark:#62E884">_</span><span style="color:#393A34;font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic"> bindings</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: PredicateBindings</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> throws</span><span style="color:#AB5959;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Bool</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#7B7F8B">        // resolve the variable</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> value </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#1E754F;--shiki-dark:#F286C4"> try</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> variable.</span><span style="color:#998418;--shiki-dark:#97E1F1">evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">bindings</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">        </span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#7B7F8B">        // create bindings for the expression of the predicate</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> innerBindings </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> bindings.</span><span style="color:#998418;--shiki-dark:#97E1F1">binding</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">predicate.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">variable</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#998418;--shiki-dark:#97E1F1">to</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> value</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">        </span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        return</span><span style="color:#1E754F;--shiki-dark:#F286C4"> try</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> predicate.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">expression</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">innerBindings</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<p>Outside the SwiftData environment, this dynamically combined predicate can function correctly because it directly relies on the evaluation logic of Swift Predicate. However, SwiftData operates differently. When filtering data with SwiftData, it does not directly invoke the evaluation method of Swift Predicate. Instead, SwiftData parses the expression tree in the Predicate’s <code>expression</code> attribute and converts these expressions into SQL statements to perform data retrieval in the SQLite database. This means the evaluation process is accomplished by generating and executing SQL commands, operating entirely at the database level.</p>
<p>Therefore, when SwiftData attempts to convert this dynamically combined predicate into SQL commands, the inability to recognize the custom <code>VariableWrappingExpression</code> type results in a runtime error of <code>unSupport Predicate</code>.</p>
<p>If your scenario does not involve using predicates in SwiftData, Noah Kamara’s solution might be a good choice. However, if your requirement is to build dynamically combined predicates within the SwiftData environment, you might still need to rely on the strategy introduced in this article.</p>
<h2 id="compoundpredicate-a-predicate-merging-solution-for-swiftdata">CompoundPredicate: A Predicate Merging Solution for SwiftData</h2>
<p>In previous discussions, we unveiled a significant obstacle: developers were unable to directly use the <code>expression</code> attribute of Predicate to compose complex predicates due to the absence of specific predicate expression types. A few days after this article was published, Noah Kamara introduced an innovative solution—<a href="https://github.com/NoahKamara/CompoundPredicate/?&utm_source=Fatbobman%20Blog&utm_medium=web&utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">CompoundPredicate</a>. This new strategy abandons the previous reliance on a custom <code>StandardPredicateExpression</code> implementation, opting instead for a type-casting strategy that effectively concretizes the information of <code>expression</code>. This improvement means developers can avoid the cumbersome process of manually extracting and combining expressions.</p>
<p>Noah Kamara designed the <code>VariableReplacing</code> protocol and implemented it for each type of PredicateExpression, as shown below:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">public</span><span style="color:#AB5959;--shiki-dark:#F286C4"> protocol</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> VariableReplacing</span><span style="color:#393A34;--shiki-dark:#F6F6F4">&lt;Output&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> PredicateExpression </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    associatedtype</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> Output</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    typealias</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> Variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#999999;--shiki-dark:#F286C4"> =</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.Variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">    func</span><span style="color:#59873A;--shiki-dark:#62E884"> replacing</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;(</span><span style="color:#59873A;--shiki-dark:#62E884">_</span><span style="color:#393A34;font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic"> variable</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: Variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#59873A;--shiki-dark:#62E884">with</span><span style="color:#393A34;font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic"> replacement</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: Variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> Self</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">extension</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> PredicateExpressions</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.Variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> VariableReplacing </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    public</span><span style="color:#AB5959;--shiki-dark:#F286C4"> func</span><span style="color:#59873A;--shiki-dark:#62E884"> replacing</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;(</span><span style="color:#59873A;--shiki-dark:#62E884">_</span><span style="color:#393A34;font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic"> variable</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: Variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#59873A;--shiki-dark:#62E884">with</span><span style="color:#393A34;font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic"> replacement</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: Variable</span><span style="color:#999999;--shiki-dark:#F6F6F4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">T</span><span style="color:#999999;--shiki-dark:#F6F6F4">&gt;)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> Self</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">        if</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> replacement </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> replacement </span><span style="color:#AB5959;--shiki-dark:#F286C4">as?</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> Self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, variable.key </span><span style="color:#AB5959;--shiki-dark:#F286C4">==</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> key </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">            return</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> replacement</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        }</span><span style="color:#1E754F;--shiki-dark:#F286C4"> else</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">            return</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> self</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<p>This method enables the automatic acquisition of the exact type of expressions inside the Predicate during the predicate combination process, facilitating an automated and efficient combination of predicates.</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> notTooShort </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Book</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">    $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">pages</span><span style="color:#AB5959;--shiki-dark:#F286C4"> &gt;</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 50</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> notTooLong </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Book</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">    $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">pages</span><span style="color:#AB5959;--shiki-dark:#F286C4"> &lt;=</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 350</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> lengthFilter </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> [notTooShort, notTooShort].</span><span style="color:#998418;--shiki-dark:#97E1F1">conjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#7B7F8B">// Match books that are just the right length</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> titleFilter </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Book</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">    $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">title</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">contains</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">Swift</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#7B7F8B">// Match books that contain &quot;Swift&quot; in the title or</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#7B7F8B">// are just the right length</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filter </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> [lengthFilter, titleFilter].</span><span style="color:#998418;--shiki-dark:#97E1F1">disjunction</span><span style="color:#999999;--shiki-dark:#F6F6F4">()</span></span></code></pre></div>
<p>Importantly, this approach does not introduce expressions unrecognized by SwiftData, so the combined predicates can be directly used with SwiftData. This solution can be considered the most ideal interim strategy provided to developers before an official, more comprehensive solution is released.</p>
<h2 id="optimizing-swift-predicate-expression-compilation-efficiency">Optimizing Swift Predicate Expression Compilation Efficiency</h2>
<p>Constructing complex Swift Predicate expressions can significantly impact compilation efficiency. The Swift compiler needs to parse and generate complex type information when processing these expressions. When the expressions are overly complex, the time required for the compiler to perform type inference can dramatically increase, slowing down the compilation process.</p>
<p>Consider the following predicate example:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> result </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">  if</span><span style="color:#1E754F;--shiki-dark:#F286C4"> let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> itemData </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic"> $0</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.itemData, </span><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> item </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> itemData.item, </span><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> note </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> item.note </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    return</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> note.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">persistentModelID</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ==</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> noteID </span><span style="color:#AB5959;--shiki-dark:#F286C4">||</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> note.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">parent</span><span style="color:#AB5959;--shiki-dark:#F286C4">?</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">persistentModelID</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ==</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> noteID</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  }</span><span style="color:#1E754F;--shiki-dark:#F286C4"> else</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    return</span><span style="color:#1E754F;--shiki-dark:#BF9EEE"> false</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<p>In this example, even minor code changes can cause the compilation time for this file to exceed 10 seconds. This delay can also occur when generating expressions using closures. To alleviate this issue, we can utilize Xcode’s auxiliary features to clarify the type of the expression. Using Option + Click on the closure reveals the exact type of the expression, allowing us to provide a precise type annotation for the closure’s return value.</p>
<p><picture>
                    <source media="(max-width: 479px)" srcset="https://cdn.fatbobman.com/image-20240304183427052-zipic.png?imageView2/0/w/500"/>
                    <source media="(max-width: 767px)" srcset="https://cdn.fatbobman.com/image-20240304183427052-zipic.png?imageView2/0/w/768"/>
                    <source media="(max-width: 1024px)" srcset="https://cdn.fatbobman.com/image-20240304183427052-zipic.png?imageView2/0/w/1024"/>
                    <img src="https://cdn.fatbobman.com/image-20240304183427052-zipic.png" alt="image-20240304183427052" loading="lazy" decoding="async"/>
                  </picture></p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> memosWithStar </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#999999;--shiki-dark:#F6F6F4"> (</span><span style="color:#998418;--shiki-dark:#97E1F1">memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Variable</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> -&gt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">KeyPath</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">PredicateExpressions.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">Variable</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">Memo</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Bool</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#1E754F;--shiki-dark:#F286C4"> in</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">  PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_KeyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">    root</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> PredicateExpressions.</span><span style="color:#998418;--shiki-dark:#97E1F1">build_Arg</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">memo</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">    keyPath</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> \.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">star</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  )</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<p>The specific type of the expression in the above complex predicate is shown as follows:</p>
<p><picture>
                    <source media="(max-width: 479px)" srcset="https://cdn.fatbobman.com/image-20240304202411294-zipic.png?imageView2/0/w/500"/>
                    <source media="(max-width: 767px)" srcset="https://cdn.fatbobman.com/image-20240304202411294-zipic.png?imageView2/0/w/768"/>
                    <source media="(max-width: 1024px)" srcset="https://cdn.fatbobman.com/image-20240304202411294-zipic.png?imageView2/0/w/1024"/>
                    <img src="https://cdn.fatbobman.com/image-20240304202411294-zipic.png" alt="image-20240304202411294" loading="lazy" decoding="async"/>
                  </picture></p>
<p>Specifying the expression’s type can help the compiler process the code faster, significantly improving the overall compilation efficiency because it avoids the time the compiler spends on type inference.</p>
<blockquote>
<p>This strategy is applicable not only in cases where predicates need to be combined but also in situations involving complex predicates without combination. By extracting expressions and specifying types explicitly, developers can significantly improve the compilation time for complex predicates, ensuring a more efficient development experience.</p>
</blockquote>
<h2 id="ios-174--macos-144">iOS 17.4+ / macOS 14.4</h2>
<p>Starting from iOS 17.4, developers can dynamically <a href="https://github.com/apple/swift-foundation/pull/343?&utm_source=Fatbobman%20Blog&utm_medium=web&utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">combine</a> predicates using the following method:</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#999999;--shiki-dark:#F286C4">@</span><span style="color:#AB5959;--shiki-dark:#F286C4">Model</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">final</span><span style="color:#AB5959;--shiki-dark:#F286C4"> class</span><span style="color:#2E8F82;--shiki-dark:#97E1F1"> People</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">  var</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> age: </span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Int</span><span style="color:#AB5959;--shiki-dark:#F286C4"> =</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 9</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">  init</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#62E884;--shiki-dark-font-style:italic">age</span><span style="color:#393A34;--shiki-dark:#F6F6F4">: </span><span style="color:#998418;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic">Int</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">    self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">age</span><span style="color:#AB5959;--shiki-dark:#F286C4"> =</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> age</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> minAge </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 10</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> notTooYong </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> item </span><span style="color:#1E754F;--shiki-dark:#F286C4">in</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">  item.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">age</span><span style="color:#AB5959;--shiki-dark:#F286C4"> &gt;=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> minAge</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> maxAge </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 50</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> notTooOld </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> item </span><span style="color:#1E754F;--shiki-dark:#F286C4">in</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">  item.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">age</span><span style="color:#AB5959;--shiki-dark:#F286C4"> &lt;=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> maxAge</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> enableMin </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#1E754F;--shiki-dark:#BF9EEE"> true</span><span style="color:#A0ADA0;--shiki-dark:#7B7F8B"> // enable minAge filter</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> enableMax </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#1E754F;--shiki-dark:#BF9EEE"> false</span><span style="color:#A0ADA0;--shiki-dark:#7B7F8B"> // enable maxAge filter</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">let</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> filterByAge </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#998418;--shiki-dark:#97E1F1"> #Predicate</span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">People</span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> item </span><span style="color:#1E754F;--shiki-dark:#F286C4">in</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">  (</span><span style="color:#393A34;--shiki-dark:#F6F6F4">enableMin </span><span style="color:#AB5959;--shiki-dark:#F286C4">?</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> notTooYong.</span><span style="color:#998418;--shiki-dark:#97E1F1">evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">item</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> :</span><span style="color:#1E754F;--shiki-dark:#BF9EEE"> true</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#A0ADA0;--shiki-dark:#7B7F8B"> // &gt;= minAge</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">    &amp;&amp;</span><span style="color:#999999;--shiki-dark:#F6F6F4"> (</span><span style="color:#393A34;--shiki-dark:#F6F6F4">enableMax </span><span style="color:#AB5959;--shiki-dark:#F286C4">?</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> notTooOld.</span><span style="color:#998418;--shiki-dark:#97E1F1">evaluate</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#393A34;--shiki-dark:#F6F6F4">item</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#AB5959;--shiki-dark:#F286C4"> :</span><span style="color:#1E754F;--shiki-dark:#BF9EEE"> true</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#A0ADA0;--shiki-dark:#7B7F8B"> // &lt;= maxAge</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<p>This method requires all conditions to be listed in advance. It is not as flexible as <a href="https://github.com/NoahKamara/CompoundPredicate/?&utm_source=Fatbobman%20Blog&utm_medium=web&utm_campaign=Fatbobman%20Blog" rel="noreferrer noopener">CompoundPredicate</a> when forming complex predicates.</p>
<div class="dynamic-ad-container pt-4"></div>
<h2 id="conclusion">Conclusion</h2>
<p>This article explored methods for dynamically constructing complex predicates within the SwiftData environment. Although the current solutions may not be as elegant and straightforward as we might hope, they do provide a viable way for applications relying on SwiftData to implement flexible data querying capabilities without being limited by the absence of certain features.</p>
<p>Despite having found methods that work within the current technological constraints, we still hope that future versions of Foundation and SwiftData will offer built-in support to make constructing dynamic, complex predicates simpler and more intuitive. Enhancing these capabilities would further augment the practicality of Swift Predicate and SwiftData, enabling developers to implement complex data processing logic more efficiently.</p> </div> </article> <script type="module" src="/_astro/WeeklySubscribeModal.astro_astro_type_script_index_0_lang.Bs-YSeM_.js"></script> <!-- Modal toggle --><button data-modal-target="default-modal" data-modal-toggle="default-modal" class="hidden text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800" type="button">
Toggle modal
</button> <!-- Modal backdrop with flex centering --> <div id="modal-backdrop" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40 items-center justify-center"> <div id="default-modal" class="hidden relative p-4 w-full max-w-2xl"> <!-- Modal content --> <div class="relative bg-white rounded-lg shadow-2xl dark:bg-gray-800 border-gray-200 border dark:border-gray-600"> <!-- Modal header --> <div class="flex items-center justify-between px-4 md:px-5 pt-4 pb-0 rounded-t dark:border-gray-600"> <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="default-modal"> <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14"> <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"></path> </svg> <span class="sr-only">Close modal</span> </button> </div> <!-- Modal body --> <div class="px-4 md:px-5 pb-4"> <div class="w-full mx-auto text-center px-6 pb-6"> <div class="text-lg font-semibold text-gray-900 dark:text-blue-100 pt-4 pb-8">Every Monday, sharing handpicked Swift and SwiftUI development highlights with you.</div> <div id="custom-substack-embed1"></div> <!-- <div class="text-gray-700 dark:text-blue-200 text-xs font-medium pt-4">{bottomTip}</div> --> <script type="module" src="/_astro/WeeklySubscribe1.astro_astro_type_script_index_0_lang.BKbVN22B.js"></script> <script>(function(){const subscribeText = "Join Now";
const placeholder = "Subscribe with your email";

    window.CustomSubstackWidget = {
      substackUrl: 'weekly.fatbobman.com',
      placeholder: placeholder,
      buttonText: subscribeText,
      theme: 'custom',
      colors: {
        primary: '#F50000',
        input: '#000000',
        email: '#777777',
        text: '#000000',
      },
    };

    // 创建一个新的 MutationObserver 实例
    const observer = new MutationObserver((mutationsList, observer) => {
      // 遍历所有的 mutations
      for (let mutation of mutationsList) {
        // 如果这个 mutation 是一个子节点的添加或删除
        if (mutation.type === 'childList') {
          // 查找订阅框
          const widget = document.querySelector('.custom-substack-widget1');
          if (widget) {
            // 查找 input 元素
            const input = widget.querySelector('input');
            const button = widget.querySelector('button');
            // 根据当前的颜色方案修改订阅框的样式
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
              // 暗黑模式
              widget.style.border = 'var(--subscribe-widget-border)';
              widget.style.padding = '0.3rem';
              widget.style.borderRadius = '0.7rem 0.7rem 0.7rem 0.7rem';
              widget.style.backgroundColor = 'var(--subscribe-input-background)';
              input.style.border = '0px solid #000';
              input.style.backgroundColor = 'var(--subscribe-input-background)';
              input.style.padding = '0.5rem';
              // input.style.border = '1px solid #E2E8F0';
              input.style.outline = 'none';
              button.style.backgroundColor = 'var(--subscribe-button-background)';
              button.style.color = 'var(--subscribe-button-text)';
              button.style.fontWeight = 'bold';
              button.style.padding = '0.5rem 1rem';
              button.style.borderRadius = '0.5rem 0.5rem 0.5rem 0.5rem';
              button.style.maxWidth = '100px';
            } else {
              // 正常模式
              widget.style.border = 'var(--subscribe-widget-border)';
              widget.style.padding = '0.3rem';
              widget.style.borderRadius = '0.7rem 0.7rem 0.7rem 0.7rem';
              widget.style.backgroundColor = 'var(--subscribe-input-background)';
              input.style.border = '0px solid #000';
              input.style.backgroundColor = 'var(--subscribe-input-background)';
              input.style.padding = '0.5rem';
              // input.style.border = '1px solid #E2E8F0';
              input.style.outline = 'none';
              button.style.backgroundColor = 'var(--subscribe-button-background)';
              button.style.color = 'var(--subscribe-button-text)';
              button.style.fontWeight = 'bold';
              button.style.padding = '0.5rem 1rem';
              button.style.borderRadius = '0.5rem 0.5rem 0.5rem 0.5rem';
              button.style.maxWidth = '100px';
            }

            if (window.matchMedia('(max-width: 640px)').matches) {
              // 屏幕尺寸小于 640px
              widget.style.maxWidth = '325px';
            } else {
              // 屏幕尺寸大于或等于 640px
              widget.style.maxWidth = '600px';
            }
            // 停止观察
            observer.disconnect();
          }
        }
      }
    });

    // 开始观察 #custom-substack-embed 元素的子节点的变化
    observer.observe(document.getElementById('custom-substack-embed1'), { childList: true });
  })();</script> </div> <div class="flex justify-center pb-6"> <button data-modal-hide="default-modal" type="button" class="text-gray-600 dark:text-gray-400 bg-transparent hover:text-gray-800 dark:hover:text-gray-200 font-medium rounded-lg text-sm px-8 py-2.5 text-center transition-colors">Continue Reading</button> </div> </div> </div> </div> </div> <script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "author": {
    "@type": "Person",
    "name": "Fatbobman",
    "url": "https://twitter.com/fatbobman"
  },
  "dateModified": "2024-03-07T00:12:00.000Z",
  "datePublished": "2024-03-07T00:12:00.000Z",
  "description": "Explore dynamically creating predicates for SwiftData, similar to NSCompoundPredicate, using PredicateExpression for flexible data filtering.",
  "headline": "How to Dynamically Construct Complex Predicates for SwiftData",
  "image": {
    "@type": "ImageObject",
    "url": [
      {
        "url": "https://cdn.fatbobman.com/card/how-to-dynamically-construct-complex-predicates-for-swiftdata-en.png"
      }
    ]
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://fatbobman.com/en/posts/how-to-dynamically-construct-complex-predicates-for-swiftdata/"
  },
  "url": "https://fatbobman.com/en/posts/how-to-dynamically-construct-complex-predicates-for-swiftdata/",
  "publisher": {
    "@type": "Organization",
    "name": "Fatbobman's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://fatbobman.com/images/blog-card.png"
    }
  }
}</script> <div class="w-full mx-auto text-center pb-0 sm:pb-6 pt-8"> <div id="custom-substack-embed"></div> <div class="text-xs font-medium text-heading p-4">Get weekly handpicked updates on Swift and SwiftUI!</div> <script>(function(){const subscribeText = "Join Now";
const placeholder = "Subscribe with your email";

    window.CustomSubstackWidget = {
      substackUrl: 'weekly.fatbobman.com',
      placeholder: placeholder,
      buttonText: subscribeText,
      theme: 'custom',
      colors: {
        primary: '#F50000',
        input: '#000000',
        email: '#777777',
        text: '#000000',
      },
    };
  
    const observer = new MutationObserver(() => {
      const widget = document.querySelector('.custom-substack-widget');
      if (widget) {
        const input = widget.querySelector('input');
        const button = widget.querySelector('button');
  
        // 设置样式（合并暗黑模式与默认模式逻辑）
        // const darkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        widget.style.padding = '0.5rem';
        widget.style.borderRadius = '1.2rem';
        widget.style.border = '0.1px solid var(--aw-color-text-muted)';
        input.style.border = '0px solid #000';
        input.style.backgroundColor = 'var(--aw-background-color)';
        button.style.backgroundColor = 'var(--subscribe-button-background)';
        button.style.color = 'var(--subscribe-button-text)';
        button.style.borderRadius = '0.8rem';
        button.style.maxWidth = '100px';
        button.style.fontWeight = 'bold';
  
        // 响应式调整
        widget.style.maxWidth = window.matchMedia('(max-width: 640px)').matches
          ? '325px'
          : '400px';
  
        observer.disconnect(); // 停止观察
      }
    });
  
    // 开始观察
    observer.observe(document.getElementById('custom-substack-embed'), { childList: true });
  })();</script> <script src="https://substackapi.com/widget.js" defer></script> </div> <div class="pt-6 pb-6  dark:border-gray-700"> <!-- <p class="flex justify-center align-center text-sm font-medium text-heading">
    { lang === Lang.ZH && <SupportMeTextZH /> }
    { lang === Lang.EN && <SupportMeTextEN /> }
  </p> --> <div class="flex flex-col sm:flex-row justify-center items-center mx-auto sm:space-x-8 align-center pt-2"> <button type="button" class="text-gray-900 bg-yellow-200 hover:bg-yellow-300 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm px-8 py-4 text-center inline-flex items-center dark:focus:ring-gray-600 dark:border-gray-700 me-2 mb-2" onclick="window.open('https://www.buymeacoffee.com/fatbobman')"> <svg class="w-5 h-5 me-2 -ms-1" fill="none" stroke="none" xmlns="http://www.w3.org/2000/svg"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-buymecoffee"></use> </svg> <span class="text-black font-bold">Buy me a coffee</span> </button> <div class="pt-4 sm:pt-0">  <button type="button" class="bg-[#3b82f6] hover:bg-blue-700 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm px-8 py-4 text-center inline-flex items-center dark:focus:ring-gray-600 dark:border-gray-700 me-2 mb-2" onclick="window.open('https://www.paypal.com/paypalme/fatbobman')"> <svg width="24" height="24" class="w-4 h-4 me-2 -ms-1" aria-hidden="true" stroke="none"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-paypal"></use> </svg> <span class="text-white font-bold hover:text-yellow-100">Donate via Paypal</span> </button> </div> </div> </div> <!-- <WeeklySubscribe1 lang={lang} top={0} bottom={4}/> --> <div id="copy-alert" class="hidden fixed bottom-28 right-5"> <div id="alert-1" class="flex items-center p-4 mb-4 text-blue-800 rounded-lg bg-blue-50/90 dark:bg-gray-800/90 dark:text-blue-400" role="alert"> <div class="text-sm font-medium">Link copied</div> </div> </div> <style>
  .copy-icon {
    position: absolute;
    left: -30px; /* 根据您的布局调整位置 */
    top: 50%; /* 将图标定位到标题的中间高度 */
    transform: translateY(-50%); /* 垂直居中对齐图标 */
    cursor: pointer;
    transition: opacity 0.6s ease;
    pointer-events: all; /* 始终响应鼠标事件 */
  }

  article h2,
  article h3,
  article h4,
  article h5 {
    position: relative;
  }

  #copy-alert {
    position: fixed;
    bottom: -100px; /* 初始在视窗下方 */
    right: 20px;
    transition: bottom 0.5s ease-in-out;
  }

  /* 进入动画 */
  @keyframes slideIn {
    from {
      bottom: -100px;
    }
    to {
      bottom: 0px;
    }
  }

  /* 消失动画 */
  @keyframes slideOut {
    from {
      bottom: 20px;
    }
    to {
      bottom: -100px;
    }
  }
</style> <script>
  var hideTimeout; // 用于保存自动隐藏定时器的引用
  document.querySelectorAll('article h2, article h3, article h4, article h5').forEach(function (header) {
    var copyIcon = document.createElement('span');
    copyIcon.innerHTML =
      '<svg fill="currentColor" aria-hidden="true" stroke="currentColor" class="w-5 h-5 hidden md:block hover:text-secondary" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M861.866667 164.266667c-87.466667-87.466667-230.4-89.6-320-2.133334l-68.266667 68.266667c-12.8 12.8-12.8 32 0 44.8s32 12.8 44.8 0l68.266667-68.266667c64-61.866667 166.4-61.866667 230.4 2.133334 64 64 64 168.533333 2.133333 232.533333l-117.333333 119.466667c-34.133333 34.133333-81.066667 51.2-128 49.066666-46.933333-4.266667-91.733333-27.733333-119.466667-66.133333-10.666667-14.933333-29.866667-17.066667-44.8-6.4-14.933333 10.666667-17.066667 29.866667-6.4 44.8 40.533333 53.333333 100.266667 87.466667 166.4 91.733333h17.066667c59.733333 0 119.466667-23.466667 162.133333-68.266666l117.333333-119.466667c83.2-89.6 83.2-234.666667-4.266666-322.133333z"></path><path d="M505.6 750.933333l-66.133333 68.266667c-64 61.866667-166.4 61.866667-230.4-2.133333-64-64-64-168.533333-2.133334-232.533334l117.333334-119.466666c34.133333-34.133333 81.066667-51.2 128-49.066667 46.933333 4.266667 91.733333 27.733333 119.466666 66.133333 10.666667 14.933333 29.866667 17.066667 44.8 6.4 14.933333-10.666667 17.066667-29.866667 6.4-44.8-40.533333-53.333333-100.266667-87.466667-166.4-91.733333-66.133333-4.266667-130.133333 19.2-177.066666 66.133333l-117.333334 119.466667c-85.333333 89.6-85.333333 234.666667 2.133334 322.133333 44.8 44.8 102.4 66.133333 162.133333 66.133334 57.6 0 115.2-21.333333 160-64l66.133333-68.266667c12.8-12.8 12.8-32 0-44.8-14.933333-10.666667-34.133333-10.666667-46.933333 2.133333z"></path></svg>'; // 使用您选择的图标
    copyIcon.className = 'copy-icon';
    copyIcon.style.opacity = '0'; // 默认透明
    header.insertBefore(copyIcon, header.firstChild);

    header.addEventListener('mouseover', function () {
      copyIcon.style.opacity = '1';
    });
    header.addEventListener('mouseout', function () {
      copyIcon.style.opacity = '0';
    });

    copyIcon.addEventListener('click', function () {
        var url = window.location.href.split('#')[0] + '#' + header.id;
        navigator.clipboard.writeText(url).then(function () {
            var alertDiv = document.getElementById('copy-alert');
            if (alertDiv) {
                alertDiv.classList.remove('hidden'); // 确保提示框是可见的
                alertDiv.style.display = 'block'; // 显示提示框
                clearTimeout(hideTimeout); // 清除之前的定时器
                alertDiv.style.animation = 'none'; // 先清除之前的动画
                setTimeout(function () {
                    alertDiv.style.animation = 'slideIn 0.5s forwards'; // 应用新动画
                }, 10);

                // 设置自动隐藏定时器
                hideTimeout = setTimeout(function () {
                    alertDiv.style.animation = 'slideOut 0.5s forwards'; // 应用消失动画
                    setTimeout(function () {
                        alertDiv.style.display = 'none';
                    }, 500);
                }, 3000);
            }
        });
    });
  });
</script> <script>
function copyCode(button, event) {
  event.preventDefault();
  const codeBlock = button.parentNode.nextElementSibling.textContent; // 获取代码内容
  navigator.clipboard.writeText(codeBlock).then(() => {
    // 显示 "Copied"
    button.querySelector('.copy-text').style.display = 'none';
    button.querySelector('.copied-text').style.display = 'inline';

    // 3秒后恢复
    setTimeout(() => {
      button.querySelector('.copy-text').style.display = 'inline';
      button.querySelector('.copied-text').style.display = 'none';
    }, 3000);
  });
}
</script> <script>(function(){const url = "https://fatbobman.com/ads/en";

  // 根据中英文对应不同的 adCacheKey
  const adCacheKey = 'dynamicAdCache' + (window.location.pathname.includes('/zh/') ? 'ZH' : 'EN');

  // 尝试从缓存中获取广告
  const cachedAd = JSON.parse(localStorage.getItem(adCacheKey));
  const now = Date.now();

  if (cachedAd && cachedAd.expiresAt > now) {
    console.log('Using cached ad');
    console.log(cachedAd.expiresAt - now);
    // 如果缓存有效，直接使用缓存的广告
    renderAd(cachedAd.content);
  } else {
    console.log('Fetching ad from the server');
    // 如果缓存无效，从服务器获取广告
    fetch(url, {
      headers: {
        'Accept': 'text/html',
      },
      cache: 'default'
    })
      .then(response => {
        const maxAgeMatch = response.headers.get('Cache-Control')?.match(/max-age=(\d+)/);
        const maxAge = maxAgeMatch ? parseInt(maxAgeMatch[1], 10) : 0;

        if (!response.ok || maxAge <= 0) {
          throw new Error('Invalid response or missing Cache-Control');
        }

        return response.text().then(adContent => {
          const expiresAt = now + maxAge * 1000; // 计算失效时间
          // 缓存广告内容
          localStorage.setItem(adCacheKey, JSON.stringify({ content: adContent, expiresAt }));
          // 渲染广告
          renderAd(adContent);
        });
      })
      .catch(error => console.error('Error loading the ad:', error));
  }

  // 渲染广告函数
  function renderAd(html) {
    const adSlots = document.querySelectorAll('.dynamic-ad-container');
    adSlots.forEach(slot => {
      slot.innerHTML = html;
    });
  }
})();</script> <script type="module">var c=document.querySelectorAll("article");c.forEach(function(r){var a=r.querySelectorAll("a");a.forEach(function(e){var t=e.getAttribute("href");t&&t.startsWith("http")&&!t.includes("fatbobman.com")&&!t.includes("fatbobman.github.com")&&!t.includes("localhost")&&e.setAttribute("target","_blank")})});</script> <!-- <LeaveFeedback lang={lang} /> --> <section class="pt-10"><div class="max-w-5xl sm:px-4 py-2 mx-auto"><div class="grid gap-4 sm:gap-2 sm:mx-4 sm:grid-cols-12"><div class="col-span-12 sm:col-span-3 hidden sm:block"><div class="text-center sm:text-left mt-3 mb-14 before:block before:w-24 before:h-1 before:mb-3 before:rounded before:mx-auto sm:before:mx-0 before:bg-secondary"><h3 class="text-lg font-medium text-default">Related Posts</h3></div></div><div class="sm:hidden text-lg font-medium text-heading col-span-12 text-left">Related Posts</div><div class="relative col-span-12 sm:px-4 space-y-6 sm:col-span-9"><div class="col-span-12 space-y-2 relative sm:px-4 sm:col-span-8 sm:space-y-4 sm:before:absolute sm:before:top-2 sm:before:bottom-0 sm:before:w-0.5 sm:before:-left-3 before:bg-block"><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/en/posts/swift-predicate-usage-composition-and-considerations/" id="relatedPosts-Swift Predicate: Usage, Composition, and Considerations"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">Swift Predicate: Usage, Composition, and Considerations</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/en/posts/how-to-handle-optional-values-in-swiftdata-predicates/" id="relatedPosts-How to Handle Optional Values in SwiftData Predicates"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">How to Handle Optional Values in SwiftData Predicates</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/en/posts/use-core-data-features-in-swiftdata-by-swiftdatakit/" id="relatedPosts-SwiftDataKit: Unleashing Advanced Core Data Features in SwiftData"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">SwiftDataKit: Unleashing Advanced Core Data Features in SwiftData</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/en/posts/from-data-model-construction-to-managed-object-instances-in-core-data/" id="relatedPosts-Exploring CoreData - From Data Model Creation to Managed Object Instances"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">Exploring CoreData - From Data Model Creation to Managed Object Instances</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/en/posts/persistent-history-tracking-in-swiftdata/" id="relatedPosts-How to Observe Data Changes in SwiftData using Persistent History Tracking"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">How to Observe Data Changes in SwiftData using Persistent History Tracking</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/en/posts/relationships-in-swiftdata-changes-and-considerations/" id="relatedPosts-Relationships in SwiftData: Changes and Considerations"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">Relationships in SwiftData: Changes and Considerations</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/en/weekly/issue-045" id="relatedPosts-Weekly #45 - We Need More &#34;Wukong&#34;"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">Weekly #45 - We Need More &quot;Wukong&quot;</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/en/posts/concurret-programming-in-swiftdata/" id="relatedPosts-Concurrent Programming in SwiftData"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">Concurrent Programming in SwiftData</h3></div></a><a class="flex flex-col sm:relative sm:before:absolute sm:before:top-2 sm:before:w-2 sm:before:h-2 sm:before:rounded-full sm:before:left-[-31px] sm:before:z-[1] before:bg-secondary group cursor-pointer" href="/en/posts/what-s-new-in-core-data-in-wwdc23/" id="relatedPosts-WWDC 2023, What’s New in Core Data"><div class="flex items-start"><div class="w-[7px] h-[7px] bg-secondary ml-4 mr-2 flex-shrink-0 mt-2 sm:hidden" style="border-radius: 50%;"></div><h3 class="text-default group-hover:text-secondary">WWDC 2023, What’s New in Core Data</h3></div></a></div></div></div></div></section> <!-- <BottomWeeklySubscribe lang={lang} /> --> <div><div id="gitalk-container" data-comment-id="如何为 SwiftData 动态的构建复杂的谓词" data-lang="en"></div><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" defer></script></div>

    <script>
      document.addEventListener('DOMContentLoaded', async function () {
        const response = await fetch('https://fatbobman.com/status/comment');
        const data = await response.text();
        console.log(data);
        if (data === '1') {
          var container = document.getElementById('gitalk-container');
          if (container) {
            var commentID = container.getAttribute('data-comment-id');
            var lang = container.getAttribute('data-lang');

            var gitalk = new Gitalk({
              clientID: 'fcf61195c7f73253dc8b',
              clientSecret: '0ac2907be08248a1fcb5312e27480ad535c682e5',
              repo: 'blogComments',
              owner: 'fatbobman',
              admin: ['fatbobman'],
              id: commentID.split('/').pop().substring(0, 49),
              distractionFreeMode: true,
              createIssueManually: true,
              language: lang,
            });

            gitalk.render('gitalk-container');
          }
        }
      });
    </script> <div class="hidden xl:block w-44 lg:absolute" id="toc" style="left: -30px; top: 0px"> <div class="text-muted items-center justify-center overflow-x-clip"> <div class="w-full flex justify-end pb-2" id="toc-button"> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <svg fill="currentColor" stroke="currentColor" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" id="toc-list-switcher"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-toc"></use> </svg>  </div> </div> <div class="text-default text-xs hidden" id="toc-list"> <ul> <li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#challenge-implementing-flexible-data-filtering-capabilities" class=""> Challenge: Implementing Flexible Data Filtering Capabilities </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#combining-nspredicate-methods" class=""> Combining NSPredicate Methods </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#the-challenge-of-combining-swift-predicates" class=""> The Challenge of Combining Swift Predicates </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#dynamic-predicate-construction-strategy" class=""> Dynamic Predicate Construction Strategy </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#utilizing-the--macro-to-construct-expressions" class=""> Utilizing the #Predicate Macro to Construct Expressions </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#creating-parameterized-expression-closures" class=""> Creating Parameterized Expression Closures </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#combining-expressions-to-construct-new-predicates" class=""> Combining Expressions to Construct New Predicates </a> </div> </li><li class="pl-2 pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#dynamic-combination-of-expressions" class=""> Dynamic Combination of Expressions </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#an-implementation-inapplicable-to-swiftdata" class=""> An Implementation Inapplicable to SwiftData </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#compoundpredicate-a-predicate-merging-solution-for-swiftdata" class=""> CompoundPredicate: A Predicate Merging Solution for SwiftData </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#optimizing-swift-predicate-expression-compilation-efficiency" class=""> Optimizing Swift Predicate Expression Compilation Efficiency </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#ios-174-/-macos-144" class=""> iOS 17.4+ / macOS 14.4 </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary items-center justify-start"> <a href="#conclusion" class=""> Conclusion </a> </div> </li> </ul> </div> </div> </div> <style>
  #toc-list {
    transition: all 0.9s ease-in-out;
  }

  #toc-button {
    transition: all 0.9s ease-in-out;
  }
</style> <script>
  function getOffsetTop(element) {
    var offsetTop = 0;
    while (element) {
      offsetTop += element.offsetTop;
      element = element.offsetParent;
    }
    return offsetTop;
  }

  var toc = document.querySelector('#toc');
  // 获取 sidebar 在浏览器中的初始 top 值
  var initialTop = getOffsetTop(toc);
  var positioningElement = document.querySelector('#article-area'); // 定位视图的选择器
  var stickyPoint = 150;
  var tocPadding = 30;
  var tocTopOffset = 4;
  var sidebarWidth = toc.offsetWidth;

  function adjustTocPosition() {
    var sidebarOffsetTop = toc.getBoundingClientRect().top;
    if (sidebarOffsetTop <= stickyPoint) {
      // 获取 positioningElement 的左侧侧与浏览器左侧之间的距离
      var positioningElementRight = (window.innerWidth - positioningElement.getBoundingClientRect().width) / 2;
      toc.style.position = 'fixed';
      toc.style.top = stickyPoint + 'px';
      toc.style.left = positioningElementRight - toc.getBoundingClientRect().width - tocPadding + 'px';
    }

    if (window.scrollY <= initialTop - stickyPoint) {
      toc.style.position = 'absolute';
      toc.style.top = tocTopOffset + 'px';
      toc.style.left = -(tocPadding + toc.getBoundingClientRect().width) + 'px';
    }
  }

  document.addEventListener('scroll', adjustTocPosition);
  window.addEventListener('resize', adjustTocPosition);
  // doc 加载完成后，调整 toc 的位置
  toc.style.left = -(tocPadding + toc.getBoundingClientRect().width) + 'px';

  document.addEventListener('DOMContentLoaded', function () {
    const tocList = document.getElementById('toc-list');
    const tocButton = document.getElementById('toc-button');

    // 更新toc-list和toc-button的显示状态
    function updateDisplay() {
      const showToc = localStorage.getItem('showToc') === 'true';
      if (showToc) {
        tocList.classList.remove('hidden');
        tocButton.classList.add('justify-start');
        tocButton.classList.remove('justify-end');
      } else {
        tocList.classList.add('hidden');
        tocButton.classList.remove('justify-start');
        tocButton.classList.add('justify-end');
      }
    }

    // 初始状态检查
    updateDisplay();

    // 点击事件监听器，用于切换toc-list的显示状态并更新按钮位置
    tocButton.addEventListener('click', function () {
      const isHidden = tocList.classList.contains('hidden');
      localStorage.setItem('showToc', isHidden);
      updateDisplay();
    });
  });
</script> <div class="hidden md:block md:absolute" id="sidebar" style="right: -50px; top: 0px"> <div class="invisible flex flex-col space-y-4 text-muted items-center justify-center opacity-0 transition-all duration-1000 delay-300 ease-out" id="sidebar-content"> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <a href="/en/posts/swift-predicate-usage-composition-and-considerations/" data-tooltip-target="tooltip-next-post" data-tooltip-placement="left" id="sidebar-next-post" class> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-previous"></use> </svg> </a>  </div> <div id="tooltip-next-post" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-44 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Swift Predicate: Usage, Composition, and Considerations</div> <div class="text-xs text-yellow-200 font-extrabold pt-2">⌥ + ←</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div> <script>(function(){const url = "/en/posts/swift-predicate-usage-composition-and-considerations/";
const isHidden = false;

  document.addEventListener('keydown', (e) => {
    // Check if Alt+RightArrow or just RightArrow was pressed
    if (e.altKey && e.key === 'ArrowLeft') {
      // Only navigate if there's a URL and the button isn't hidden
      if (url && !isHidden) {
        e.preventDefault(); // Prevent default browser behavior
        window.location.href = url;
      }
    }
  });
})();</script> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <a href="/en/posts/tips-and-considerations-for-using-lazy-containers-in-swiftui/" data-tooltip-target="tooltip-previous-post" data-tooltip-placement="left" id="sidebar-previous-post" class> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-next"></use> </svg> </a>  </div> <div id="tooltip-previous-post" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-44 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Tips and Considerations for Using Lazy Containers in SwiftUI</div> <div class="text-xs text-yellow-200 font-extrabold pt-2">⌥ + →</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div> <script>(function(){const url = "/en/posts/tips-and-considerations-for-using-lazy-containers-in-swiftui/";
const isHidden = false;

  document.addEventListener('keydown', (e) => {
    // Check if Alt+RightArrow or just RightArrow was pressed
    if (e.altKey && e.key === 'ArrowRight') {
      // Only navigate if there's a URL and the button isn't hidden
      if (url && !isHidden) {
        e.preventDefault(); // Prevent default browser behavior
        window.location.href = url;
      }
    }
  });
})();</script> <!-- <DictButton lang={lang} post = {post}/> --> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <a href="https://x.com/intent/tweet?text=How%20to%20Dynamically%20Construct%20Complex%20Predicates%20for%20SwiftData&url=https%3A%2F%2Ffatbobman.com%2Fen%2Fposts%2Fhow-to-dynamically-construct-complex-predicates-for-swiftdata%2F&hashtags=ios%2Cswiftlang&via=fatbobman" target="_blank" id="sidebar-share-with-twitter"> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-twitter"></use> </svg> </a>  </div> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <a href="https://bsky.app/intent/compose?text=How%20to%20Dynamically%20Construct%20Complex%20Predicates%20for%20SwiftData%0A by %40fatbobman.bsky.social %0Ahttps%3A%2F%2Ffatbobman.com%2Fen%2Fposts%2Fhow-to-dynamically-construct-complex-predicates-for-swiftdata%2F%0A #ios #swift" target="_blank" id="sidebar-share-with-bluesky"> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="0.4" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-bluesky"></use> </svg> </a>  </div> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <a href="https://www.facebook.com/sharer/sharer.php?u=https%253A%252F%252Ffatbobman.com%252Fen%252Fposts%252Fhow-to-dynamically-construct-complex-predicates-for-swiftdata%252F" target="_blank" id="sidebar-share-with-facebook"> <svg stroke="currentColor" fill="currentColor" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-facebook"></use> </svg> </a>  </div>  <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:16px; height:16px;">  <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ffatbobman.com%2Fen%2Fposts%2Fhow-to-dynamically-construct-complex-predicates-for-swiftdata%2F" target="_blank" id="sidebar-share-with-linkedin"> <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="0.1" viewBox="0 0 15 15"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-linkedin"></use> </svg> </a>  </div> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <a href="mailto:?subject=Article%3A%E3%80%90How%20to%20Dynamically%20Construct%20Complex%20Predicates%20for%20SwiftData%E3%80%91&#38;body=Here's%20an%20article%20you%20may%20find%20interesting%3A%0A%0AHow%20to%20Dynamically%20Construct%20Complex%20Predicates%20for%20SwiftData%0A%0ALink%3A%20https%3A%2F%2Ffatbobman.com%2Fen%2Fposts%2Fhow-to-dynamically-construct-complex-predicates-for-swiftdata%2F" target="_blank" id="sidebar-share-with-email"> <svg fill="currentColor" stroke="currentColor" stroke-width="20" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-email"></use> </svg> </a>  </div> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <svg fill="currentColor" stroke="currentColor" stroke-width="20" id="comment-button" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-comment"></use> </svg>  </div> <script>
  const SCROLL_OFFSET = 80;
  
  document.addEventListener('DOMContentLoaded', function() {
    const commentButton = document.getElementById('comment-button');
    if (commentButton) {
      commentButton.addEventListener('click', function() {
        const gitalkContainer = document.getElementById('gitalk-container');
        if (gitalkContainer) {
          const topPosition = gitalkContainer.getBoundingClientRect().top + window.scrollY - SCROLL_OFFSET;
          window.scrollTo({ top: topPosition, behavior: 'smooth' });
        }
      });
    }
  });
</script> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <svg fill="currentColor" stroke="currentColor" onclick="window.scrollTo({top:0,behavior:'smooth'})" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <!-- <path d="M862.464 161.536l-700.928 0c-30.976 0-56.096-25.12-56.096-56.096l0-28.064c0-30.944 25.12-56.064 56.096-56.064l700.896 0c30.976 0 56.096 25.12 56.096 56.064l0 28.032c0 31.008-25.12 56.096-56.096 56.096l0 0 0 0zM138.528 531.68c0 0 306.816-245.792 309.888-248.864 14.304-13.888 31.904-22.368 49.952-25.312 1.76-0.32 3.488-0.608 5.248-0.8 2.816-0.32 5.6-0.352 8.384-0.352 2.816-0.032 5.568 0.032 8.352 0.352 1.792 0.192 3.552 0.48 5.28 0.8 18.048 2.976 35.616 11.424 49.92 25.312 3.104 3.008 309.856 248.864 309.856 248.864 33.152 32.224 30.304 65.44-2.784 97.696s-77.376 3.04-110.496-29.216l-190.08-150.432 0 496.864c0 31.008-25.088 56.096-56.096 56.096l-28 0c-30.976 0-56.096-25.12-56.096-56.096l0-496.864-190.048 150.432c-33.088 32.288-77.408 61.536-110.496 29.216-33.056-32.256-35.872-65.44-2.816-97.696l0 0 0 0z"></path> --> <use href="/_astro/iconCollection.BDk6xFEU.svg#icon-top"></use> </svg>  </div> </div> </div> <script type="module" src="/_astro/SideBar.astro_astro_type_script_index_0_lang.XHrm3OJt.js"></script> </div>   </div> </main> </div> <footer> <footer class="bg-block"> <div class="mx-auto w-full max-w-3xl px-4 md:px-6"> <div class="container flex flex-col items-center pt-10"> <div class="flex flex-row justify-around w-full space-x-3"> <div class="flex flex-col space-y-4"> <h2 class="font-bold text-heading">Website</h2> <div class="flex flex-col space-y-2 text-sm text-default font-medium"> <a href="https://apps.apple.com/us/app/id1534513553" class="hover:text-secondary" target="_blank">Health Notes</a> <a href="https://discord.gg/zhou-zi-de-swiftji-shi-ben-967978112509935657" class="hover:text-secondary" target="_blank">Discord</a> <a href="/en/posts/" class="hover:text-secondary">Posts</a> <a href="/en/tags/" class="hover:text-secondary">Tags</a> <a href="/en/collections/" class="hover:text-secondary">Collections</a> <a href="/en/snippet/" class="hover:text-secondary">Quick Tips</a> </div> </div> <div class="flex flex-col space-y-4"> <h2 class="font-bold text-heading">Follow</h2> <div class="flex flex-col space-y-2 text-sm text-default font-medium"> <a href="https://weekly.fatbobman.com" class="hover:text-secondary">Newsletter</a> <a href="https://x.com/intent/follow?screen_name=fatbobman" class="hover:text-secondary" target="_blank">Twitter</a> <a href="https://mastodon.social/@fatbobman" class="hover:text-secondary" target="_blank">Mastodon</a> <a href="https://www.linkedin.com/in/fatbobman/" class="hover:text-secondary" target="_blank">Linkedin</a> <a href="https://bsky.app/profile/fatbobman.bsky.social" class="hover:text-secondary" target="_blank">Blue Sky</a>  <a href="https://github.com/fatbobman" class="hover:text-secondary" target="_blank">GitHub</a> <a href="/rss.xml" class="hover:text-secondary hover:font-medium" target="_blank">RSS</a> </div> </div> <div class="flex flex-col space-y-4"> <h2 class="font-bold text-heading">Info</h2> <div class="flex flex-col space-y-2 text-sm text-default font-medium"> <a href="/en/about/" class="hover:text-secondary">About</a> <a href="/en/sponsorship/" class="hover:text-secondary"> Sponsor </a> </div> </div> </div> <div class="pb-0"> <div class="flex items-center justify-center w-full px-6 pt-12 text-sm"> <span class="text-muted text-xs">Copyright ©  2025 <a href="https://x.com/fatbobman" class="border-b-secondary border-b-[1px]">Fatbobman Digital Limited</a>. All Rights
            Reserved.</span> </div> <div class="flex items-center justify-center w-full px-6 pt-2 text-sm pb-10"> <span> <a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank" class="block text-xs text-muted">
辽ICP备20006550号-1
</a> </span> </div> </div> </div> </div> </footer> </footer> </div>  <script src="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.js" async></script> <script>
  // 为每个需要清除 focus 状态的按钮都添加一个 clear-focus 类, 下面的代码将在点击后自动移除 focus 状态
  document.addEventListener('DOMContentLoaded', () => {
    // 获取所有具有 'clear-focus' 类的按钮
    const buttons = document.querySelectorAll('.clear-focus');

    buttons.forEach((button) => {
      button.addEventListener('click', () => {
        setTimeout(() => {
          button.blur();
        }, 0);
      });
    });
  });

  window.onpageshow = function () {
    document.documentElement.classList.add('motion-safe:scroll-smooth');
  };
</script> <div id="docsearch-container-data" data-lang="en" data-searchtext="Search..."></div> <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" defer></script> <script type="module">function r(e,t){const a={button:{buttonText:"搜索",buttonAriaLabel:"搜索"},modal:{searchBox:{resetButtonTitle:"清除搜索关键字",resetButtonAriaLabel:"清除搜索关键字",cancelButtonText:"取消",cancelButtonAriaLabel:"取消"},startScreen:{recentSearchesTitle:"最近搜索",noRecentSearchesText:"当前没有搜索历史记录",saveRecentSearchButtonTitle:"保存本次搜索",removeRecentSearchButtonTitle:"从搜索历史中移除",favoriteSearchesTitle:"收藏夹",removeFavoriteSearchButtonTitle:"从收藏夹移除"},errorScreen:{titleText:"无法获取结果",helpText:"请检查网络连接"},footer:{selectText:"选择",selectKeyAriaLabel:"选择",navigateText:"切换",navigateUpKeyAriaLabel:"Arrow up",navigateDownKeyAriaLabel:"Arrow down",closeText:"退出",closeKeyAriaLabel:"Escape key",searchByText:"引擎支持"},noResultsScreen:{noResultsText:"无法找到对应结果",suggestedQueryText:"可以尝试搜索如下内容",reportMissingResultsText:"确认本次搜索应该返回内容？",reportMissingResultsLinkText:"请告知我们"}}};if(typeof window<"u"){const n=window.docsearch;n({appId:"MVXKD4F4BR",apiKey:"a1b4111c3de8b9f60eeca6da001711da",indexName:"fatbobman",container:"#docsearch",insights:!0,placeholder:t,maxResultsPerGroup:50,translations:e==="zh"?a:void 0,searchParameters:{facetFilters:[`lang:${e}`],hitsPerPage:50}})}}function o(){const e=document.getElementById("docsearch-container-data");if(!e){console.error("Search container not found");return}const t=e.dataset.lang,a=e.dataset.searchtext;r(t,a)}window.addEventListener("load",()=>{document.querySelector('script[src*="docsearch"]')&&o()});</script> <!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5C7N4MF5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!-- End Google Tag Manager (noscript) --> <!--Magic Fix 解决在 Safari 下搜索框取消后会滚动到页面底部--> <div class="fixed"> <input type="text"> </div> </body></html>