<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="sitemap" href="/sitemap-index.xml"><!-- <link rel="shortcut icon" href={iconSVG.src} /> --><link rel="icon" type="image/png" sizes="16x16" href="/_astro/favicon-16x16.2312221518-2.DhhY-2ao.png"><link rel="icon" type="image/png" sizes="32x32" href="/_astro/favicon-32x32.2312221518-2.BbUzUdRZ.png"><link rel="mask-icon" href="/_astro/faviconSVG-32x32.2312221518-2.ll_gTgJS.svg"><link rel="apple-touch-icon" sizes="180x180" href="/_astro/apple-touch-icon.2312227635.BE1WvNvp.png"><title>Ask Apple 2022 Q&amp;A Related to SwiftUI (Part 1)</title>
<meta name="description" content="Explore SwiftUI solutions from Ask Apple 2022 Q&amp;A. This article provides developer insights on UIActivityViewController, contextAction, testing @State, and more. Learn from Apple engineers.">
<meta name="robots" content="index,follow">
<link rel="canonical" href="https://fatbobman.com/en/posts/swiftui-of-ask-apple-2022-1/">
<meta property="og:title" content="Ask Apple 2022 Q&amp;A Related to SwiftUI (Part 1)">
<meta property="og:description" content="Explore SwiftUI solutions from Ask Apple 2022 Q&amp;A. This article provides developer insights on UIActivityViewController, contextAction, testing @State, and more. Learn from Apple engineers.">
<meta property="og:url" content="https://fatbobman.com/en/posts/swiftui-of-ask-apple-2022-1/">
<meta property="og:type" content="article">
<meta property="og:image" content="https://fatbobman.com/images/blog-card.png">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="fatbobman.com">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@fatbobman">
<meta name="twitter:creator" content="@fatbobman"><link rel="alternate" type="application/rss+xml" title="RSS Feed for My Website" href="https://fatbobman.com/en/rss.xml"><link rel="sitemap" href="/sitemap-index.xml"><!-- 其他路径的 hreflang -->
  <link rel="alternate" hreflang="en" href="https://fatbobman.com/en/posts/swiftui-of-ask-apple-2022-1/">
  <link rel="alternate" hreflang="zh-CN" href="https://fatbobman.com/zh/posts/swiftui-of-ask-apple-2022-1/">
  <link rel="alternate" hreflang="x-default" href="https://fatbobman.com/en/posts/swiftui-of-ask-apple-2022-1/"><script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.async = true; // Add async attribute
    hm.src = "https://hm.baidu.com/hm.js?14e5d60a3ea6276655f9d14c58b1fcd0";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script> <!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5C7N4MF5');</script> <!-- End Google Tag Manager --><script>
      // Immediately set theme before page renders
      if (
        localStorage.getItem('color-theme') === 'dark' ||
        (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
      ) {
        document.documentElement.classList.add('dark');
      }
    </script><script type='application/ld+json'>{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "author": {
    "@id": "#author"
  },
  "dateModified": "2022-10-27T00:12:00.000Z",
  "datePublished": "2022-10-27T00:12:00.000Z",
  "description": "Explore SwiftUI solutions from Ask Apple 2022 Q&A. This article provides developer insights on UIActivityViewController, contextAction, testing @State, and more. Learn from Apple engineers.",
  "headline": "Ask Apple 2022 Q&A Related to SwiftUI (Part 1)",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://fatbobman.com/en/posts/swiftui-of-ask-apple-2022-1/"
  },
  "url": "https://fatbobman.com/en/posts/swiftui-of-ask-apple-2022-1/",
  "publisher": {
    "@type": "Organization",
    "name": "Fatbobman's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://fatbobman.com/images/blog-card.png"
    }
  },
  "articleSection": [
    "SwiftUI",
    "Apple Event"
  ],
  "inLanguage": "en"
}</script><script type='application/ld+json'>{
  "@context": "https://schema.org",
  "@type": "Person",
  "@id": "#author",
  "name": "东坡肘子 (徐杨)",
  "alternateName": "Fatbobman (Xu Yang)",
  "jobTitle": "Apple Developer",
  "description": "苹果生态开发者，专注 Swift 和 SwiftUI 开发。Fatbobman's Blog 作者。",
  "url": "https://fatbobman.com",
  "image": {
    "@type": "ImageObject",
    "url": "https://cdn.fatbobman.com/FatWithBoys.png"
  },
  "sameAs": [
    "https://github.com/fatbobman",
    "https://x.com/fatbobman",
    "https://www.linkedin.com/in/fatbobman/",
    "https://bsky.app/profile/fatbobman.com",
    "https://mastodon.social/@fatbobman",
    "https://web.okjike.com/u/e32947ef-7751-4363-9456-b340eef2efd3",
    "https://fatbobman.com/zh/about/",
    "https://fatbobman.com/en/about/"
  ],
  "worksFor": {
    "@type": "Organization",
    "name": "Fatbobman's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://fatbobman.com/images/blog-card.png"
    }
  }
}</script><link rel="stylesheet" href="/_astro/about.BADXEtGE.css">
<link rel="stylesheet" href="/_astro/_slug_.BRLGXoDU.css">
<style>.sticky[data-astro-cid-4wsjtibl]{position:fixed;top:0;left:50%;transform:translate(-50%);width:100%;max-width:100%}
</style></head> <body class="antialiased text-default bg-page">  <div class="flex flex-col min-h-screen justify-between "> <div> <header> <div class="bg-block" id="wholeHeader" data-astro-cid-4wsjtibl> <div id="blogTitle"> <a href="/en/"> <div class="flex space-x-4 mx-auto text-center pt-6 sm:pt-6 font-black w-[240px] sm:w-[300px] pb-2 sm:pb-0"> <svg fill="currentColor" class="text-heading" width="500"> <use href="/_astro/blogTitle.Ca1NZNqJ.svg#blog-title"></use> </svg> </div> </a> </div> <div class="bg-block z-50 shadow-custom-light dark:shadow-custom-dark" id="stickyHeader" data-astro-cid-4wsjtibl> <div class="max-w-5xl flex flex-wrap items-center justify-between mx-auto p-2 sm:p-0" data-astro-cid-4wsjtibl> <div class="flex space-x-2" data-astro-cid-4wsjtibl> <div id="lang-data" data-lang="en" style="display: none;"></div> <button id="language-dropdown-button" data-dropdown-toggle="language-dropdown-menu" type="button" class="p-2 w-10 h-10 font-medium text-default hover:text-secondary hover:bg-gray-100 dark:hover:bg-page focus:outline-none focus:ring-2 focus:ring-gray-200 dark:hover:bg-gray-700 dark:focus:ring-gray-600 rounded-lg"> EN </button> <!-- Dropdown --> <div class="z-50 hidden my-4 text-base list-none bg-page divide-y divide-gray-100 rounded-lg shadow dark:bg-gray-700" id="language-dropdown-menu"> <ul class="py-2 font-medium text-sm" role="none"> <li> <button type="button" onclick="
            try {
                if ('#' !== '#') {
                    window.location.href = '#';
                }
            } catch (e) {
                console.log('Navigation failed:', e);
            }
        " class="w-full text-left px-4 py-2 text-default hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" role="menuitem"> <div class="inline-flex items-center">
English
<svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5 ml-2 hidden text-primary" id="EN-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-aifadian"></use> </svg> </div> </button> </li><li> <button type="button" onclick="
              try {
                  if ('/zh/posts/swiftui-of-ask-apple-2022-1/' !== '#') {
                      window.location.href = '/zh/posts/swiftui-of-ask-apple-2022-1/';
                  }
              } catch (e) {
                  console.log('Navigation failed:', e);
              }
          " class="w-full text-left px-4 py-2 text-default hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" role="menuitem"> <div class="inline-flex items-center">
中文
<svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5 ml-2 hidden text-primary" id="ZH-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-aifadian"></use> </svg> </div> </button> </li> <li> <div class="border-t border-gray-200 dark:border-gray-800 w-4/5 mx-auto my-2"></div> <button class="block px-4 py-2 text-default hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" role="menuitem" id="set-default-lang"> <div class="inline-flex items-center"> Set English as Default </div> </button> </li> </ul> <script type="module">function a(){const t=localStorage.getItem("lang"),e=document.getElementById("EN-check"),n=document.getElementById("ZH-check");e!==null&&n!==null&&(t==="en"?(e.classList.remove("hidden"),n.classList.add("hidden")):t==="zh"&&(n.classList.remove("hidden"),e.classList.add("hidden")))}document.addEventListener("DOMContentLoaded",()=>{a()});const l=document.getElementById("set-default-lang");l?.addEventListener("click",()=>{const t=document.getElementById("lang-data");if(t!=null){const e=t.dataset.lang;e!=null&&(localStorage.setItem("lang",e),a())}});</script> </div> <button id="theme-dropdown-button" data-dropdown-toggle="theme-dropdown-menu" type="button" class="group p-2 w-10 h-10 text-default hover:bg-gray-100 dark:hover:bg-page focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600 rounded-lg flex items-center justify-center"> <svg viewBox="0 0 1024 1024" stroke="currentColor" class="w-5 h-5 text-default fill-current group-hover:text-secondary hidden" id="theme_icon_system"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-computer"></use> </svg> <svg viewBox="0 0 1024 1024" stroke="currentColor" class="w-5 h-5 text-default fill-current group-hover:text-secondary hidden" id="theme_icon_dark"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-moon"></use> </svg> <svg viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5 text-default fill-current group-hover:text-secondary hidden" id="theme_icon_light"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-sun"></use> </svg> </button> <!-- Dropdown --> <div class="z-50 hidden my-4 text-base list-none bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-gray-700" id="theme-dropdown-menu"> <ul class="py-2 font-medium" role="none"> <li class="hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white text-default"> <button class="flex px-4 py-2 text-sm align-text-center" id="theme_button_light"> <svg class="w-5 h-5" viewBox="0 0 1024 1024" stroke-width="2" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-sun"></use> </svg> <span class="ml-2 dark:hover:text-white">Light</span> </button> </li> <li class="hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white text-default"> <button class="flex px-4 py-2 text-sm align-text-center " id="theme_button_dark"> <svg class="w-5 h-5"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-moon"></use> </svg> <span class="ml-2">Dark</span> </button> </li> <li class="hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white text-default"> <button class="flex px-4 py-2 text-sm align-text-center " id="theme_button_system"> <svg class="w-5 h-5"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-computer"></use> </svg> <span class="ml-2 dark:hover:text-white">System</span> </button> </li> </ul> </div> <script>
  // 获取按钮
  var themeButtonLight = document.getElementById('theme_button_light');
  var themeButtonDark = document.getElementById('theme_button_dark');
  var themeButtonSystem = document.getElementById('theme_button_system');
  // 获取图标
  var themeToggleDarkIcon = document.getElementById('theme_icon_dark');
  var themeToggleLightIcon = document.getElementById('theme_icon_light');
  var themeToggleSystemIcon = document.getElementById('theme_icon_system');

  function setTheme() {
    if (
      localStorage.getItem('color-theme') === 'dark' ||
      (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  }

  function setThemeButton() {
    let theme = localStorage.getItem('color-theme');
    if (theme === 'dark') {
      themeToggleDarkIcon.classList.remove('hidden');
      themeToggleLightIcon.classList.add('hidden');
      themeToggleSystemIcon.classList.add('hidden');
    } else if (theme === 'light') {
      themeToggleDarkIcon.classList.add('hidden');
      themeToggleLightIcon.classList.remove('hidden');
      themeToggleSystemIcon.classList.add('hidden');
    } else {
      themeToggleDarkIcon.classList.add('hidden');
      themeToggleLightIcon.classList.add('hidden');
      themeToggleSystemIcon.classList.remove('hidden');
    }
  }

  function resetTheme() {
    setTheme();
    setThemeButton();
  }

  resetTheme();

  // 监听暗黑模式的变化
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
    resetTheme();
  });

  // 保证其他的页面也能够监听到 localStorage 的变化
  window.addEventListener('storage', function (event) {
    if (event.key === 'color-theme') {
      resetTheme();
    }
  });


  // Listen for clicks on the button themeToggleDarkIcon
  themeButtonDark.addEventListener('click', function () {
    localStorage.setItem('color-theme', 'dark');
    resetTheme();
  });

  // // Listen for clicks on the button themeToggleLightIcon
  themeButtonLight.addEventListener('click', function () {
    localStorage.setItem('color-theme', 'light');
    resetTheme();
  });

  // // Listen for clicks on the button themeToggleSystemIcon
  themeButtonSystem.addEventListener('click', function () {
    localStorage.removeItem('color-theme');
    resetTheme();
  });
</script> <div id="docsearch" class="group w-10 h-10 text-default hover:bg-gray-100 dark:hover:bg-page focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600 rounded-lg flex items-center justify-center"> <svg width="20" height="20" viewBox="0 0 20 20" aria-hidden="true" class="DocSearch-Search-Icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg> </div> </div> <button data-collapse-toggle="navbar-solid-bg" type="button" class="inline-flex items-center p-2 mx-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-solid-bg" aria-expanded="false" id="navbar-toggle-button"> <span class="sr-only">Open main menu</span> <svg class="w-5 h-5 text-default" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14"> <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"></path> </svg> </button> <nav class="hidden w-full md:block md:w-auto px-4 z-40" id="navbar-solid-bg"> <ul class="flex flex-col font-bold mt-4 rounded-lg bg-gray-50 md:space-x-8 rtl:space-x-reverse md:flex-row md:mt-0 md:border-0 md:bg-transparent dark:bg-gray-800 md:dark:bg-transparent dark:border-gray-700"> <a href="/en/" class="block py-2 px-3 md:p-0 rounded text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent "> Home </a><a href="/en/posts/" class="block py-2 px-3 md:p-0 rounded text-invert bg-secondary md:bg-transparent md:text-secondary md:dark:bg-transparent " aria-current="page"> Articles </a><a href="/en/weekly/" class="block py-2 px-3 md:p-0 rounded text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent "> Weekly </a><a href="/en/snippet/" class="block py-2 px-3 md:p-0 rounded text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent "> Tips </a><a href="/en/sponsorship/" class="block py-2 px-3 md:p-0 rounded text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent "> Sponsorship </a><a href="/en/about/" class="block py-2 px-3 md:p-0 rounded text-heading md:hover:text-secondary hover:bg-gray-100 dark:hover:bg-gray-700 md:hover:bg-transparent md:dark:hover:bg-transparent "> About </a> </ul> </nav> </div> </div> <div id="placeholder" class="hidden" data-astro-cid-4wsjtibl></div> </div> <script>(function(){const enableSticky = true;
const enableStickyInMobile = true;

  window.onload = function () {
    checkStickyHeader();
    stickySetup();
  };

  window.addEventListener('resize', stickySetup);

  function checkStickyHeader() {
    const title = document.getElementById('blogTitle');
    const stickyHeader = document.getElementById('stickyHeader');
    const placeholder = document.getElementById('placeholder');

    if (title && stickyHeader && placeholder) {
      const offset = title.offsetTop + title.offsetHeight;

      if (shouldStick() && window.scrollY >= offset) {
        stickyHeader.classList.add('sticky');
        placeholder.style.display = 'block';
        placeholder.style.height = `${stickyHeader.offsetHeight}px`;
      } else {
        stickyHeader.classList.remove('sticky');
        placeholder.style.display = 'none';
      }
    }
  }

  function shouldStick() {
    if (!enableSticky) return false;

    let isMobile = window.matchMedia('(max-width: 640px)').matches;
    if (isMobile && !enableStickyInMobile) return false;

    return true;
  }

  function stickySetup() {
    window.onscroll = checkStickyHeader;
  }
})();</script>  </header>  <main class="w-full mx-auto max-w-3xl p-4 md:p-6 "> <div class="container mx-auto space-y-6 sm:space-y-12">   <div class="mx-auto space-y-4 text-center py-10 " style="width:80%"> <div class="flex mx-auto justify-center"> <div class="flex mx-auto justify-center"> <a class="text-xs font-medium sm:font-semibold mx-2 text-muted hover:text-secondary tracking-normal" href="/en/tags/SwiftUI/">
#SwiftUI </a><a class="text-xs font-medium sm:font-semibold mx-2 text-muted hover:text-secondary tracking-normal" href="/en/tags/Apple-Event/">
#Apple Event </a> <a class="text-xs font-medium sm:font-semibold mx-2 text-muted hover:text-secondary tracking-wide" href="/zh/posts/swiftui-of-ask-apple-2022-1/" id="language-switcher-for-topic"> #中文版 </a> </div> </div> <h1 class="text-2xl font-bold leadi md:text-3xl text-heading ">Ask Apple 2022 Q&amp;A Related to SwiftUI (Part 1)</h1> <p class="text-sm text-default"> <a itemprop="author" href="https://x.com/intent/follow?screen_name=fatbobman" target="_blank" class="hover:text-secondary font-medium">Fatbobman</a> <!-- <time datetime={`${post.data.publishDate.toISOString()}`}>{date}</time> --> </p> <p class="text-xs text-muted"> Published on <time datetime="2022-10-27T00:12:00.000Z">Oct 27, 2022</time>  </p> </div> <svg style="display: none;"> <symbol id="icon-clipboard" viewBox="0 0 1024 1024"> <path d="M426.666667 42.666667l170.666667 0q41.344 0 74.325333 23.850667t46.336 61.482667l50.005333 0q52.992 0 90.496 37.504t37.504 90.496l0 597.333333q0 52.992-37.504 90.496t-90.496 37.504l-512 0q-52.992 0-90.496-37.504t-37.504-90.496l0-597.333333q0-52.992 37.504-90.496t90.496-37.504l50.005333 0q13.312-37.674667 46.336-61.482667t74.325333-23.850667zM768 213.333333l-50.005333 0q-13.312 37.674667-46.336 61.482667t-74.325333 23.850667l-170.666667 0q-41.344 0-74.325333-23.850667t-46.336-61.482667l-50.005333 0q-17.664 0-30.165333 12.501333t-12.501333 30.165333l0 597.333333q0 17.664 12.501333 30.165333t30.165333 12.501333l512 0q17.664 0 30.165333-12.501333t12.501333-30.165333l0-597.333333q0-17.664-12.501333-30.165333t-30.165333-12.501333zM597.333333 128l-170.666667 0q-17.664 0-30.165333 12.501333t-12.501333 30.165333 12.501333 30.165333 30.165333 12.501333l170.666667 0q17.664 0 30.165333-12.501333t12.501333-30.165333-12.501333-30.165333-30.165333-12.501333z"></path> </symbol> <symbol id="icon-check" viewBox="0 0 1024 1024"> <path d="M421.858 683.366l401.796-448.518c18.66-20.828 50.668-22.586 71.498-3.928 20.828 18.66 22.586 50.67 3.928 71.498L463.638 788.494c-18.606 20.768-50.5 22.586-71.344 4.066l-263.29-233.924c-20.906-18.572-22.796-50.576-4.222-71.48 18.574-20.906 50.576-22.796 71.48-4.222L421.86 683.366z"></path> </symbol> </svg> <div class="relative" id="article-area"> <article class="prose dark:prose-invert mx-auto w-full "> <div> 

<p>Ask Apple provides an opportunity for developers to directly communicate with Apple engineers outside of WWDC. This article compiles some of the Q&amp;A related to SwiftUI from the event, and includes some personal insights. This is Part 1 of the article.</p>
<h2 id="qa">Q&amp;A</h2>
<h3 id="uiactivityviewcontroller">UIActivityViewController</h3>
<p>Q: Is there any plan to add “native” SwiftUI support to the UIActivityViewController for iOS?</p>
<p>A: It is already available! Please check out <a href="https://developer.apple.com/documentation/swiftui/sharelink/?utm_source=Fatbobman%20Blog&utm_medium=web" rel="noreferrer noopener">ShareLink</a>.</p>
<h3 id="contextaction">contextAction</h3>
<p>Q: In the early iOS 16 and macOS 13 beta versions, we saw a new <code>.contextAction</code> modifier, which was later removed. Is there any suggestion for detecting row selection in a list, similar to “NavigationLink”, but without navigating to another view (e.g., showing a sheet or selecting an option from the list)? A button might work for iOS and iPadOS, but not so much for macOS. Also, <code>.contextAction</code> supports multiple selection. Will it come back?</p>
<p>A: Take a look at the primaryAction parameter of the contextMenu modifier. This API also has a forSelectionType parameter that supports multiple selection.</p>
<blockquote>
<p>In SwiftUI 4.0, the contextMenu modifier has been significantly improved. For example, a context menu can have multiple options, support primaryAction, and have a customizable preview view. The contextMenu with the primaryAction parameter mentioned above can not only be used for List but also for Table.</p>
</blockquote>
<p><img src="https://cdn.fatbobman.com/contextMenu_2022-10-26_14.01.21.2022-10-26%2014_02_29.gif" alt="https://cdn.fatbobman.com/contextMenu_2022-10-26_14.01.21.2022-10-26%2014_02_29.gif"/></p>
<h3 id="how-to-test-state-variables">How to test @State variables</h3>
<p>Q: Is there a recommended way to test @State variables in SwiftUI views? Is the only way to refactor these variables into a view model?</p>
<p>A: If there are multiple interrelated @State properties in the same view, extracting them into a structure might be a good choice. Extracting them into a view model is also a strategy, but not necessary.</p>
<blockquote>
<p>It is difficult to test dependencies (conforming to the DynamicProperty protocol) in SwiftUI views during unit testing. This is also one of the advantages of Redux-like frameworks (extracting state from views for easy testing). Please read the article “<a href="https://www.swiftbysundell.com/articles/writing-testable-code-when-using-swiftui/?utm_source=Fatbobman%20Blog&utm_medium=web" rel="noreferrer noopener">Writing testable code when using SwiftU</a>I” to learn how to write test-friendly view code.</p>
</blockquote>
<h3 id="creating-a-bottom-text-input-bar-similar-to-an-im-application">Creating a bottom text input bar similar to an IM application</h3>
<p>Q: Hello, my question is about TextField. Suppose we want to create a view similar to iMessage, where you can see a list of messages (irrelevant to this example) and at the bottom of the view there is a text field. When the user clicks on the text field, the keyboard appears in its toolbar. I tried adding a TextField in ToolbarItemGroup(place: .bottomBar), a second one in ToolbarItemGroup(place: .keyboard), and then, with the help of the @FocusState variable, I can hide one and move the focus to the keyboard. This is a bit cumbersome, and I don’t think having two text fields is the right approach. Also, with this approach, the @FocusState variable becomes unresponsive and it cannot be set to nil (the keyboard is not removed when returning to the previous view). Is it possible to achieve this in pure SwiftUI (without using UIKit)? Can you give me some direction to accomplish it?</p>
<p>A: Generally, I recommend using <code>.safeAreaInset(edge: .bottom)</code> to implement the bottom text field. Then customize its display style based on its focus state. I hope this is useful for your design.</p>
<blockquote>
<p>Since the release of safeAreaInset view modifier in SwiftUI 3.0, implementing the case in the problem will no longer be difficult. For more information, please refer to the article <a href="/en/posts/safearea/" target="_blank">Mastering Safe Area in SwiftUI</a>.</p>
</blockquote>
<h3 id="how-to-avoid-recomputing-the-view-that-creates-an-instance-when-using-environmentobject">How to avoid recomputing the view that creates an instance when using environmentObject</h3>
<p>Q: How can I share state (such as ObservableObject) between two sibling views in different sub-trees without recomputing the top-level view body? For example, I can have a StateObject in the parent view and pass that object through EnvironmentObject. However, if the @Published property inside it changes, both the parent view and its sub-tree are recomputed.</p>
<p>A: EnvironmentObject is a great tool. If you don’t want the parent view to be updated, you can create the object without using @StateObject or @ObservedObject.</p>
<blockquote>
<p>Note that if there is a need to modify the environment object instance in the parent view, it should be ensured that the parent view is not repeatedly reconstructed (SwiftUI recreates instances of view types). For details, please refer to <a href="/en/posts/stateobject_and_observedobject/" target="_blank">SwiftUI’s StateObject and ObservedObject: The Key Differences</a> as advised by Apple engineers.</p>
</blockquote>
<h3 id="navigationpath">NavigationPath</h3>
<p>Q: I’m glad to see the new NavigationStack/NavigationPath, they work well for me. I’m wondering if I can inspect the NavigationPath to determine if my SearchView has entered a certain view (just as an example). I already have an idea of using NavigationPath.CodableRepresentation, but I’m concerned that this may not be the best or most sustainable way to observe NavigationPath. Thanks!</p>
<p>A: There’s no way to introspect NavigationPath. If you need to know the contents of the path, a good approach is to use a homogeneous PATH, like <code>@State private var path: [MyEnum]</code>, and then toggle on the navigationDestination on that enum type.</p>
<blockquote>
<p>NavigationPath creates a completely type-erased collection of data that only requires elements to conform to the Hashable protocol. NavigationPath has an interesting and powerful feature of being able to encode and decode itself to JSON in the absence of all type information of its elements. Read the article <a href="https://www.pointfree.co/blog/posts/78-reverse-engineering-swiftui-s-navigationpath-codability?utm_source=Fatbobman%20Blog&utm_medium=web" rel="noreferrer noopener">Reverse Engineering SwiftUI’s NavigationPath Codability</a> to learn about how it’s implemented.</p>
</blockquote>
<h3 id="locking-the-y-axis-scale-for-charts">Locking the Y-axis Scale for Charts</h3>
<p>Q: I have a Swift chart and I’ve implemented a RuleMark that displays while dragging by listening to drag events. During the drag, the Y-axis scale gets larger. In my example, it goes from 0 to 75 when not dragging and from 0 to 100 when dragging. Is there a way to prevent this?</p>
<p>A: You can use <code>.chartYScale(domain: 0 ... 75)</code> to lock the Y-axis scale domain.</p>
<h3 id="implicit-and-explicit-animations">Implicit and Explicit Animations</h3>
<p>Q: Hello! Is there any other way to animate views directly based on state changes without using the onChange decorator? Here is my code.</p>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">onChange</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">of</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> modle.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">state</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">aChange</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> value </span><span style="color:#1E754F;--shiki-dark:#F286C4">in</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">    withAnimation</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#AB5959;--shiki-dark:#F286C4">...</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#A65E2B;font-style:inherit;--shiki-dark:#BF9EEE;--shiki-dark-font-style:italic">        self</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#B07D48;--shiki-dark:#F6F6F4">isAnimated</span><span style="color:#AB5959;--shiki-dark:#F286C4"> =</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> value</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">   }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span></code></pre></div>
<p>A: You can animate specific state changes directly by using <code>.animation(.easeInOut, value: model.state)</code>. Any changes to <code>model.state</code> will trigger the animation.</p>
<blockquote>
<p>By using the animation modifier bound to a specific state (the old version of the animation modifier has been deprecated), more precise animation effects can be achieved. Read the article “<a href="/en/posts/the_animation_mechanism_of_swiftui/" target="_blank">Demystifying SwiftUI Animation: A Comprehensive Guide</a>” to learn more about animations.</p>
</blockquote>
<h3 id="adaptive-height-sheet">Adaptive Height Sheet</h3>
<p>Q: How can I present a Sheet in iOS 16 that matches the height of dynamic content? I want to use the view’s height in presentationDetents.</p>
<p>A: Thank you for your question. This is currently not possible, but it is something we are interested in.</p>
<blockquote>
<p>It is estimated that Apple’s engineers are busy and have not seriously considered this issue. In iOS 16, by combining presentationDetents with GeometryReader, a Sheet that matches the content height can be created. <a href="https://gist.github.com/fatbobman/5feab313dbade52cfc66c4f1fd101f66?utm_source=Fatbobman%20Blog&utm_medium=web" rel="noreferrer noopener">Here</a> is the complete code.</p>
</blockquote>
<p><img src="https://cdn.fatbobman.com/adaptiveSheet_2022-10-22_08.50.29.gif" alt="https://cdn.fatbobman.com/adaptiveSheet_2022-10-22_08.50.29.gif"/></p>
<h3 id="toolbarcontentbuilder">ToolbarContentBuilder</h3>
<p>Q: I would like to see better support for code like @ToolbarBuilder or <code>if condition { ToolbarItem(a) } else { ToolbarItem(b) }</code>.</p>
<p>A: You will never see @ToolbarBuilder because @ToolbarContentBuilder has been enhanced in iOS 16. @ToolbarContentBuilder now provides support for <code>if else</code> and can use dynamic properties such as @Environment / @EnvironmentObject in custom types that conform to ToolbarContent.</p>
<h3 id="windowgroup">WindowGroup</h3>
<p>Q：Good morning! I’m a SwiftUI beginner. My question is about scenes. In almost all tutorials and sample code repositories, only one WindowGroup scene is used, with all content nested within ContentView. Is there any guidance or examples on how to use multiple scenes? Or do most applications only need one WindowGroup?</p>
<p>A: Multiple scenes are useful for building complex applications, especially on macOS. For example, you may want an application that defines both a “window group” and a “document group” simultaneously, or an application that has a “window group” and an auxiliary “window” scene. The content view of a scene defines the view content in the windows created by the scene, but the scene itself defines the overall structure of the application.</p>
<blockquote>
<p>In SwiftUI 4.0, WindowGroup has received significant updates, truly enabling the development of macOS applications. For more information, please read “<a href="/en/posts/building-multiple-platforms-swiftui-app/" target="_blank">Building Adaptable SwiftUI Applications for Multiple Platforms</a>” and WWDC 2022 Session.</p>
</blockquote>
<h3 id="documentgroup">DocumentGroup</h3>
<p>Q：When using SwiftUI application lifecycle and DocumentGroup on macOS, if the application is only a data reader, can new file creation be disabled?
A: DocumentGroup provides an <a href="https://developer.apple.com/documentation/swiftui/documentgroup/init(viewing:viewer:)-6dq9n?utm_source=Fatbobman%20Blog&utm_medium=web" rel="noreferrer noopener">initializer</a> to create a reader-type application. It only allows opening files of that content type, but not editing them.</p>
<h3 id="mvvm">MVVM</h3>
<p>Q：During the UIKit era, MVVM was a common architecture where the data for the view display came from a separate viewModel class. This still applies in SwiftUI, or is the struct itself now considered the viewModel?</p>
<p>A: SwiftUI attempts to be agnostic to the overall architecture of the application. However, in the traditional sense of viewModel, I do not recommend using the view (the struct itself) as the viewModel. This could lead to some undesirable consequences, such as reducing the reusability of the view and tying business logic to the lifecycle of the SwiftUI view, making handling business logic more difficult. In short, we do not recommend using the view as the viewModel. However, SwiftUI does provide tools to implement the classic MVVM architecture (such as StateObjects, ObservedObjects).</p>
<h3 id="onappearinitviewdidload">onAppear、init、viewDidLoad</h3>
<p>Q：In my application, I host SwiftUI views in a UIHostingController, all of which are within a UITabBarController. Recently, I noticed that the onAppear of SwiftUI views is triggered at unexpected times, such as when the UITabBarController is created, rather than when the view itself appears. I’m wondering: 1. When should onAppear be called for SwiftUI views in a UITabBarController like this? 2. What is the recommended way to execute code when a view appears in a UITabBarController?</p>
<p>A: When using a UIHostingController in other types of UIViewControllers, you may trigger the view loading early by calling methods on the hosting controller. For non-lazy views (such as LazyVStack), onAppear will be called once the hosting controller’s view is initialized. For lazy views, the view is initialized when layoutSubviews or sizeThatFits is called on the hosting controller’s view. So, if you see the view being initialized in your UITabBarController’s init method, you need to see what exactly is being done in init. Try moving that work to viewDidLoad of the UITabBarController.</p>
<blockquote>
<p>Views in lazy containers will repeatedly call onAppear and onDisappear depending on whether they appear in the visible area. However, onAppear and onDisappear are not the starting and ending points of a view’s lifespan. In fact, these views (views in lazy containers) will persist until the lazy container is destroyed. Please read <a href="/en/posts/onappear-call-timing/" target="_blank">Timing of onAppear Invocation</a> for more information.</p>
</blockquote>
<h3 id="universal-navigation-model">Universal Navigation Model</h3>
<p>Q：We are using NavigationStack with path parameters, but we are having trouble with the “transition” path when the user resizes the window from Regular to Compact in the stage manager. In regular width, we have a sidebar with a navigation stack in the detail view. In compact width, we have a tab bar with each tab having a navigation stack.</p>
<p>A: The best approach currently is to build a navigation state model object, which holds a canonical representation of the navigation state. It can provide specialized programmatic bindings for your regular and compact displays. For example, in your model, you have multiple paths, one for each tab, but in the split view, only one path’s details are projected. Use a common underlying data source, and project it to the UI’s needs, so that the model can be unit tested to ensure consistency between regular and compact projections.</p>
<blockquote>
<p>In SwiftUI 4, compact and regular correspond to two different controls: NavigationStack and NavigationSplitView. They have completely different driving modes. Developers are currently trying to create a model that can elegantly provide paths for both modes simultaneously. Read about the <a href="/en/posts/new_navigator_of_swiftui_4/" target="_blank">New Navigation System</a> to learn about their differences.</p>
</blockquote>
<h3 id="methods-and-efficiency-of-position-offset">Methods and Efficiency of Position Offset</h3>
<p>Q: What is the best method to render circular images in a non-linear position (with 2 axes)? Currently, I am using ZStack and offsetting the images to place them where I want them, but I am not sure if this is the most efficient method.</p>
<p>A: As long as the performance is good enough to meet your use case, it is a viable method. For me, this seems like a completely reasonable implementation. If you encounter performance issues or want to significantly increase the number of images you are drawing, you can try using .drawingGroup and Canvas APIs, both of which can be used for denser drawing.</p>
<blockquote>
<p>In SwiftUI, there are many ways to achieve offset, such as offset, alignmentGuide, padding, position, etc. In addition to personal preference, you should also consider whether the offset view will affect the surrounding views (on the layout level). For more details, please read <a href="/en/posts/layout-in-swiftui-way/" target="_blank">Layout in SwiftUI Way</a>.</p>
</blockquote>
<h3 id="size-rules-for-navigationsplitview">Size rules for NavigationSplitView</h3>
<p>Q：Hi there! I have started using NavigationSplitView and I really like it. In some cases, I want to make decisions based on whether the view is collapsed or not (for example, display a message in the detail view if it’s expanded, or display a warning or other indication if it’s collapsed). Can I assume that if the horizontal size class is compact, it’s collapsed? Or is there a more reliable way to determine this?</p>
<p>A: Compact does indeed correspond to a collapsed navigation split view.</p>
<h3 id="how-to-improve-the-efficiency-of-a-view-containing-a-large-number-of-uitextfield">How to improve the efficiency of a view containing a large number of UITextField</h3>
<p>Q: I have a SwiftUI view containing 132 UITextFields. I know that this is a large number, but it is determined by the business logic. After a lot of struggle with memory leaks, I managed to make it work. However, the transition from one text field to the next doesn’t feel smooth enough, and every time I enter a letter in a text field, my CPU usage seems to skyrocket to 70% - 100%. In addition, when implementing the same functionality with UIKit, there are no performance issues.</p>
<p>A: If you encounter performance issues using UITextField on iOS, you can try to avoid having each view be a UITextField. Default rendering as Text, and dynamically switch to UITextField when the text is clicked.</p>
<h3 id="cross-view-hierarchical-sharing">Cross-View Hierarchical Sharing</h3>
<p>Q: What is the best way to share data between multiple views when the data comes from API response? I’m using environmentObject as a wrapper for all views in ContentView, and I use @EnvironmentObject to access this data in each view. Is this the best approach for this situation? The only problem with this approach is that memory usage increases when I add new data.</p>
<p>A: @EnvironmentObject/environmentObject may be the best tool for sharing the same model across view hierarchies. Using them should create only one instance, which can be read in child views. This shouldn’t increase memory usage (if it does, please provide feedback). If you append more and more data to your model object, you may increase memory usage, which is normal. To overcome this, a technique is to save some data on external storage, keep only the most relevant data and an identifier in memory, so that the rest of the data can be fully retrieved.</p>
<h3 id="task-vs-onappear">task vs onAppear</h3>
<p>Q: Is there any difference between <code>.task</code> and <code>.onAppear</code> for synchronous operations? In other words, if I write <code>Color.green.task { self.someState += }</code>, can I guarantee that the state will change before the view appears for the first time? I ask this because I like to use <code>.task(id:...)</code> instead of <code>.onAppear</code> and <code>.onChange(of:)</code>.</p>
<p>A: Both onAppear and task are called before we run the body on the view for the first time. For your use case, they are equivalent in behavior.</p>
<blockquote>
<p>Read <a href="/en/posts/mastering_swiftui_task_modifier/" target="_blank">Mastering the SwiftUI task Modifier</a> to learn more about task.</p>
</blockquote>
<h3 id="windowgroup-和-openwindowaction">WindowGroup 和 OpenWindowAction</h3>
<p>Q: Is it possible to attach parameters when creating a new window on macOS? I am creating a new managed object in the same sub-context and would like to send this object to a new window. Currently, my approach is to save references to the sub-context and managed object in a singleton, and then open a new window with a URL that checks for the context and object in the singleton. It would be better if we could launch a new window with custom parameters.
A: In macOS Ventura, we introduced new APIs on WindowGroup that allow you to pass data to a window when it is opened. This can also be used in conjunction with OpenWindowAction. Please note that your data needs to be optional or specify a default value because in some cases, the framework itself will create windows (e.g. when selecting the New Window menu item). It can also work on iPadOS by creating a new scene, which is either a 2/3 or 1/3 split.</p>
<h3 id="initializing-stateobject-in-the-constructor">Initializing @StateObject in the constructor</h3>
<p>Q: Is there a way to initialize a @StateObject with a view’s struct parameter in SwiftUI?</p>
<p>A: Yes, you can achieve this by manually initializing the @StateObject in the init method. <code>self._store = StateObject(wrappedValue: Store(id: id))</code>. To clarify, the underscore makes it look a bit weird, but accessing the underlying storage is not wrong. The official documentation mainly tries to point out the most common use cases so that people don’t try to directly initialize their property wrappers right from the start. By the way, trying to initialize @State through the underlying storage is something we warned about in the past. Not because it doesn’t work, but because if you don’t have a deep understanding of how @State and identity work, its behavior can be quite confusing.</p>
<blockquote>
<p>Property wrapper types are translated by the compiler at compile time by first looking at the user-defined code for the property wrapper type. For the meaning and usage of the underscore, see <a href="/en/posts/adding-published-ability-to-custom-property-wrapper-types/" target="_blank">Going Beyond @Published<span class="mdx-Empowering"></span> Custom Property Wrappers</a>.</p>
</blockquote>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lSC8_14wCndXLY4RH3aNmA.png" alt="Untitled"/></p>
<h3 id="san-francisco-width-styles">San Francisco Width Styles</h3>
<p>Q: How to use the three new width styles (Compressed, Condensed, Expanded) added to the SF font family in SwiftUI?</p>
<p>A: You can use the fontWidth modifier to make adjustments.</p>
<blockquote>
<p>Unfortunately, it only supports SF and does not have any effect on Chinese. Please read the article “<a href="https://sarunw.com/posts/swiftui-font-width/?utm_source=Fatbobman%20Blog&utm_medium=web" rel="noreferrer noopener">How to change SwiftUI Font Width</a>” to learn about specific usage.</p>
</blockquote>
<p><picture>
                    <source media="(max-width: 479px)" srcset="https://cdn.fatbobman.com/image-20221022135907441.png?imageView2/0/w/500"/>
                    <source media="(max-width: 767px)" srcset="https://cdn.fatbobman.com/image-20221022135907441.png?imageView2/0/w/768"/>
                    <source media="(max-width: 1024px)" srcset="https://cdn.fatbobman.com/image-20221022135907441.png?imageView2/0/w/1024"/>
                    <img src="https://cdn.fatbobman.com/image-20221022135907441.png" alt="https://cdn.fatbobman.com/image-20221022135907441.png" loading="lazy" decoding="async"/>
                  </picture></p>
<h3 id="adding-shortcuts-to-stepper">Adding Shortcuts to Stepper</h3>
<p>Q: How can we add increment and decrement shortcuts to the SwiftUI Stepper (on MacOS)?</p>
<p>A: One way to achieve similar behavior is to use commands in a menu to provide the same actions. Normally, there should be a list to let people know which keyboard shortcuts are available. However, if this does not fit your use case, we would be interested in feedback on enhancements in this area.</p>
<blockquote>
<p>You can achieve similar requirements by hiding a Button that includes shortcuts.</p>
</blockquote>
<div>
        <div class="flex justify-between items-center h-8 font-semibold bg-block border border-gray-200 dark:border-[#4b5563] shadow-md text-heading text-xs rounded-tl-md rounded-tr-md">
          <span class="px-4 py-1">Swift</span>
          <button class="copy-button py-1 px-4" onclick="copyCode(this, event)">
          <div class="copy-text">
            <span class="flex items-center justify-center sm:hover:text-secondary">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                <use xlink:href="#icon-clipboard"></use>
              </svg>
            </span>
          </div>
          <div class="copied-text hidden">
            <span class="flex items-center justify-center">
              <svg class="w-3 h-3 mr-1" fill="currentColor" stroke="currentColor">
                  <use xlink:href="#icon-check"></use>
             </svg>
              Copied!
            </span>
          </div>
        </button>
        </div>
      <pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="swift"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#F286C4">struct</span><span style="color:#2E8F82;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> ContentView</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#59873A;font-style:inherit;--shiki-dark:#97E1F1;--shiki-dark-font-style:italic"> View </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F286C4">    @</span><span style="color:#AB5959;--shiki-dark:#F286C4">State</span><span style="color:#1E754F;--shiki-dark:#F286C4"> var</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> value </span><span style="color:#AB5959;--shiki-dark:#F286C4">=</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 10</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F286C4">    var</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> body: </span><span style="color:#1E754F;--shiki-dark:#F286C4">some</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> View </span><span style="color:#999999;--shiki-dark:#F6F6F4">{</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">        Form</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">            Stepper</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">value</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> $value, </span><span style="color:#998418;--shiki-dark:#97E1F1">in</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 0</span><span style="color:#AB5959;--shiki-dark:#F286C4">...</span><span style="color:#2F798A;--shiki-dark:#BF9EEE">100</span><span style="color:#393A34;--shiki-dark:#F6F6F4">, </span><span style="color:#998418;--shiki-dark:#97E1F1">label</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#998418;--shiki-dark:#97E1F1"> Text</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">Value:</span><span style="color:#999999;--shiki-dark:#F286C4">\(</span><span style="color:#B56959;--shiki-dark:#E7EE98">value</span><span style="color:#B56959;--shiki-dark:#F286C4">)</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#999999;--shiki-dark:#F6F6F4"> })</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#F6F6F4">                .</span><span style="color:#998418;--shiki-dark:#97E1F1">background</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">                    VStack</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">                        Button</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">+</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> value </span><span style="color:#AB5959;--shiki-dark:#F286C4">+=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> value </span><span style="color:#AB5959;--shiki-dark:#F286C4">&lt;</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 100</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ?</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 1</span><span style="color:#AB5959;--shiki-dark:#F286C4"> :</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 0</span><span style="color:#999999;--shiki-dark:#F6F6F4"> }</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">keyboardShortcut</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">+</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span><span style="color:#998418;--shiki-dark:#97E1F1">modifiers</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> []</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#97E1F1">                        Button</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">-</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#999999;--shiki-dark:#F6F6F4"> {</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> value </span><span style="color:#AB5959;--shiki-dark:#F286C4">-=</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> value </span><span style="color:#AB5959;--shiki-dark:#F286C4">&gt;</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 1</span><span style="color:#AB5959;--shiki-dark:#F286C4"> ?</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 1</span><span style="color:#AB5959;--shiki-dark:#F286C4"> :</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 0</span><span style="color:#999999;--shiki-dark:#F6F6F4"> }</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">keyboardShortcut</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#B56959;--shiki-dark:#E7EE98">-</span><span style="color:#B5695977;--shiki-dark:#DEE492">&quot;</span><span style="color:#393A34;--shiki-dark:#F6F6F4">,</span><span style="color:#998418;--shiki-dark:#97E1F1">modifiers</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#393A34;--shiki-dark:#F6F6F4"> []</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">                    }</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">frame</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#998418;--shiki-dark:#97E1F1">width</span><span style="color:#999999;--shiki-dark:#F6F6F4">:</span><span style="color:#2F798A;--shiki-dark:#BF9EEE"> 0</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span><span style="color:#393A34;--shiki-dark:#F6F6F4">.</span><span style="color:#998418;--shiki-dark:#97E1F1">opacity</span><span style="color:#999999;--shiki-dark:#F6F6F4">(</span><span style="color:#2F798A;--shiki-dark:#BF9EEE">0</span><span style="color:#999999;--shiki-dark:#F6F6F4">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">                )</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">        }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">    }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#F6F6F4">}</span></span></code></pre></div>
<h3 id="labeledcontent">LabeledContent</h3>
<p>Q: Labels are sometimes (mistakenly) used to provide textual explanations for a value (e.g. account balance is 10 dollars), but some developers are unaware that this explanation cannot be read by VoiceOver. Besides creating a LabeledValue component, are there any other solutions provided by SwiftUI?</p>
<p>A: SwiftUI now has a <a href="https://developer.apple.com/documentation/swiftui/labeledcontent?utm_source=Fatbobman%20Blog&utm_medium=web" rel="noreferrer noopener">LabeledContent</a> view that you can use to label some content. LabeledContent comes with built-in formatting support! For example, <code>LabeledContent(&quot;Age&quot;, value: person.age, format: .number)</code>.</p>
<blockquote>
<p>Read <a href="https://swiftwithmajid.com/2022/07/13/mastering-labeledcontent-in-swiftui/?utm_source=Fatbobman%20Blog&utm_medium=web" rel="noreferrer noopener">Mastering LabeledContent in SwiftUI</a> for more use cases of LabeledContent.</p>
</blockquote>
<h3 id="if-statements-in-viewbuilder">if Statements in ViewBuilder</h3>
<p>Q: I know that SwiftUI is based on ResultBuilder. So if statements are operated through a tree structure and buildEither. Are there any considerations when using if statements in SwiftUI?</p>
<p>A: Regarding if/else, it is important to consider how they affect the identity of the views, which was discussed in a great <a href="https://developer.apple.com/videos/play/wwdc2021/10022/?utm_source=Fatbobman%20Blog&utm_medium=web" rel="noreferrer noopener">session</a> at WWDC.</p>
<blockquote>
<p>In some cases, using lazy view modifiers not only maintains the stability of the view identity but also allows for more optimizations in SwiftUI. For example, using .opacity(value &lt; 10 ? 1 : 0.5) instead of if value &lt; 10  else </p>
</blockquote>
<h3 id="initializing-state">Initializing @State</h3>
<p>Q: What is the correct way to set the value of a @State var during initialization? I know @State should be an internal value, but in some cases, we need to pass in a value from the outside, which doesn’t seem feasible for onAppear. The following method doesn’t always work for some reason.</p>
<pre class="astro-code astro-code-themes vitesse-light dracula-soft" style="background-color:#ffffff;--shiki-dark-bg:#282A36;color:#393a34;--shiki-dark:#f6f6f4;overflow-x:auto" tabindex="0" data-language="plaintext"><code><span class="line"><span>init(id: UUID) {</span></span>
<span class="line"><span>    self._store = StateObject(wrappedValue: Store(id: id))</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<blockquote>
<p>The developer may have misunderstood the question and provided the same answer as for StateObject above. The asker may want to reinitialize the value of State by continuously modifying the value of the id parameter in the parent view. This involves a feature of all property wrappers that conform to the DynamicProperty protocol: only the instance initialized the first time during the view’s lifetime will be associated with the view creation. Please read <a href="/en/posts/avoid_repeated_calculations_of_swiftui_views/" target="_blank">How to Avoid Repeating SwiftUI View Updates</a> for more information. Passing it through the environment value from the parent view should meet the asker’s current needs: the parent view can pass in a new value, and the current view can also change that value within the view’s scope.</p>
</blockquote>
<h2 id="summary">Summary:</h2>
<p>I overlooked the issue of not obtaining a conclusion. I hope the above summary can be helpful to you.</p>
<p>This Q&amp;A article covers various topics related to SwiftUI discussed during the Ask Apple 2022 event. This is the second of two parts.</p> </div> <div class="mt-12 grid grid-cols-1 sm:grid-cols-2 gap-4"><a href="https://www.buymeacoffee.com/fatbobman" target="_blank" rel="noopener" class="block p-5 bg-orange-50/80 dark:bg-blue-900/30 border-2 border-orange-200 dark:border-blue-700 rounded-xl hover:shadow-lg hover:scale-[1.02] transition-all group"><div class="flex items-start gap-3"><div class="text-3xl">☕️</div><div class="flex-1"><div class="text-base font-bold text-heading mb-1 group-hover:text-orange-700 dark:group-hover:text-blue-200 transition-colors">
Buy Me a Coffee
</div><div class="text-sm text-default">
Support my work with a coffee
</div></div><svg class="w-5 h-5 text-orange-600 dark:text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path></svg></div></a><a href="/en/sponsorship/" class="block p-5 bg-orange-50/80 dark:bg-blue-900/30 border-2 border-orange-200 dark:border-blue-700 rounded-xl hover:shadow-lg hover:scale-[1.02] transition-all group"><div class="flex items-start gap-3"><div class="text-3xl">📢</div><div class="flex-1"><div class="text-base font-bold text-heading mb-1 group-hover:text-orange-700 dark:group-hover:text-blue-200 transition-colors">
Sponsorship
</div><div class="text-sm text-default">
Reach 50,000+ Swift developers
</div></div><svg class="w-5 h-5 text-orange-600 dark:text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path></svg></div></a></div> </article> <section class="pt-10 pb-10" id="related-posts"><div class="grid grid-cols-1 gap-2 md:grid-cols-2 lg:grid-cols-3 md:gap-4" id="more-tips"><a class="group rounded-md py-3 px-4 bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 
            hover:bg-gray-200 dark:hover:bg-gray-700 active:bg-gray-300 dark:active:bg-gray-600 flex items-stretch gap-2
            " href="/en/posts/the_animation_mechanism_of_swiftui/" id="relatedPosts-Demystifying SwiftUI Animation: A Comprehensive Guide"><span class="font-medium text-sm text-heading  group-hover:dark:text-white group-hover:text-black">Demystifying SwiftUI Animation: A Comprehensive Guide</span></a><a class="group rounded-md py-3 px-4 bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 
            hover:bg-gray-200 dark:hover:bg-gray-700 active:bg-gray-300 dark:active:bg-gray-600 flex items-stretch gap-2
            " href="/en/posts/impressions-of-wwdc23/" id="relatedPosts-WWDC 23, First Impressions of SwiftUI 5 and SwiftData"><span class="font-medium text-sm text-heading  group-hover:dark:text-white group-hover:text-black">WWDC 23, First Impressions of SwiftUI 5 and SwiftData</span></a><a class="group rounded-md py-3 px-4 bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 
            hover:bg-gray-200 dark:hover:bg-gray-700 active:bg-gray-300 dark:active:bg-gray-600 flex items-stretch gap-2
            " href="/en/posts/avoid_repeated_calculations_of_swiftui_views/" id="relatedPosts-How to Avoid Repeating SwiftUI View Updates"><span class="font-medium text-sm text-heading  group-hover:dark:text-white group-hover:text-black">How to Avoid Repeating SwiftUI View Updates</span></a><a class="group rounded-md py-3 px-4 bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 
            hover:bg-gray-200 dark:hover:bg-gray-700 active:bg-gray-300 dark:active:bg-gray-600 flex items-stretch gap-2
            " href="/en/posts/core-data-of-ask-apple-2022-2/" id="relatedPosts-Ask Apple 2022 Q&#38;A Related on Core Data (Part 2)"><span class="font-medium text-sm text-heading  group-hover:dark:text-white group-hover:text-black">Ask Apple 2022 Q&amp;A Related on Core Data (Part 2)</span></a><a class="group rounded-md py-3 px-4 bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 
            hover:bg-gray-200 dark:hover:bg-gray-700 active:bg-gray-300 dark:active:bg-gray-600 flex items-stretch gap-2
            hidden lg:flex" href="/en/posts/swiftui-of-ask-apple-2022-2/" id="relatedPosts-Ask Apple 2022 Q&#38;A Related to SwiftUI (Part 2)"><span class="font-medium text-sm text-heading  group-hover:dark:text-white group-hover:text-black">Ask Apple 2022 Q&amp;A Related to SwiftUI (Part 2)</span></a></div></section> <div class="w-full mx-auto text-center pb-0 sm:pb-6 pt-8"> <div id="custom-substack-embed" data-subscribeText="Subscribe" data-placeholder="Enter email" data-anchor="related-posts" style="opacity: 0; transition: opacity 0.3s;"></div> <iframe class="sm:w-80 w-[480px] mx-auto dark:opacity-80 dark:rounded-lg dark:shadow-2xl dark:border-gray-600" src="https://weekly.fatbobman.com/embed" height="320" style="border:1px solid #EEE; background:white; width: 100%; max-width: 480px;"></iframe> <div class="text-xs font-medium text-heading p-4 ">Weekly Swift &amp; SwiftUI highlights!</div> </div> <!-- <Author lang={lang} /> --> <div id="copy-alert" class="hidden fixed bottom-28 right-5"> <div id="alert-1" class="flex items-center p-4 mb-4 text-blue-800 rounded-lg bg-blue-50/90 dark:bg-gray-800/90 dark:text-blue-400" role="alert"> <div class="text-sm font-medium">Link copied</div> </div> </div> <style>
  .copy-icon {
    position: absolute;
    left: -30px; /* 根据您的布局调整位置 */
    top: 50%; /* 将图标定位到标题的中间高度 */
    transform: translateY(-50%); /* 垂直居中对齐图标 */
    cursor: pointer;
    transition: opacity 0.6s ease;
    pointer-events: all; /* 始终响应鼠标事件 */
  }

  article h2,
  article h3,
  article h4,
  article h5 {
    position: relative;
  }

  #copy-alert {
    position: fixed;
    bottom: -100px; /* 初始在视窗下方 */
    right: 20px;
    transition: bottom 0.5s ease-in-out;
  }

  /* 进入动画 */
  @keyframes slideIn {
    from {
      bottom: -100px;
    }
    to {
      bottom: 0px;
    }
  }

  /* 消失动画 */
  @keyframes slideOut {
    from {
      bottom: 20px;
    }
    to {
      bottom: -100px;
    }
  }
</style> <script defer>
  var hideTimeout; // 用于保存自动隐藏定时器的引用
  document.querySelectorAll('article h2, article h3, article h4, article h5').forEach(function (header) {
    var copyIcon = document.createElement('span');
    copyIcon.innerHTML =
      '<svg fill="currentColor" aria-hidden="true" stroke="currentColor" class="w-5 h-5 hidden md:block hover:text-secondary" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M861.866667 164.266667c-87.466667-87.466667-230.4-89.6-320-2.133334l-68.266667 68.266667c-12.8 12.8-12.8 32 0 44.8s32 12.8 44.8 0l68.266667-68.266667c64-61.866667 166.4-61.866667 230.4 2.133334 64 64 64 168.533333 2.133333 232.533333l-117.333333 119.466667c-34.133333 34.133333-81.066667 51.2-128 49.066666-46.933333-4.266667-91.733333-27.733333-119.466667-66.133333-10.666667-14.933333-29.866667-17.066667-44.8-6.4-14.933333 10.666667-17.066667 29.866667-6.4 44.8 40.533333 53.333333 100.266667 87.466667 166.4 91.733333h17.066667c59.733333 0 119.466667-23.466667 162.133333-68.266666l117.333333-119.466667c83.2-89.6 83.2-234.666667-4.266666-322.133333z"></path><path d="M505.6 750.933333l-66.133333 68.266667c-64 61.866667-166.4 61.866667-230.4-2.133333-64-64-64-168.533333-2.133334-232.533334l117.333334-119.466666c34.133333-34.133333 81.066667-51.2 128-49.066667 46.933333 4.266667 91.733333 27.733333 119.466666 66.133333 10.666667 14.933333 29.866667 17.066667 44.8 6.4 14.933333-10.666667 17.066667-29.866667 6.4-44.8-40.533333-53.333333-100.266667-87.466667-166.4-91.733333-66.133333-4.266667-130.133333 19.2-177.066666 66.133333l-117.333334 119.466667c-85.333333 89.6-85.333333 234.666667 2.133334 322.133333 44.8 44.8 102.4 66.133333 162.133333 66.133334 57.6 0 115.2-21.333333 160-64l66.133333-68.266667c12.8-12.8 12.8-32 0-44.8-14.933333-10.666667-34.133333-10.666667-46.933333 2.133333z"></path></svg>'; // 使用您选择的图标
    copyIcon.className = 'copy-icon';
    copyIcon.style.opacity = '0'; // 默认透明
    header.insertBefore(copyIcon, header.firstChild);

    header.addEventListener('mouseover', function () {
      copyIcon.style.opacity = '1';
    });
    header.addEventListener('mouseout', function () {
      copyIcon.style.opacity = '0';
    });

    copyIcon.addEventListener('click', function () {
        var url = window.location.href.split('#')[0] + '#' + header.id;
        navigator.clipboard.writeText(url).then(function () {
            var alertDiv = document.getElementById('copy-alert');
            if (alertDiv) {
                alertDiv.classList.remove('hidden'); // 确保提示框是可见的
                alertDiv.style.display = 'block'; // 显示提示框
                clearTimeout(hideTimeout); // 清除之前的定时器
                alertDiv.style.animation = 'none'; // 先清除之前的动画
                setTimeout(function () {
                    alertDiv.style.animation = 'slideIn 0.5s forwards'; // 应用新动画
                }, 10);

                // 设置自动隐藏定时器
                hideTimeout = setTimeout(function () {
                    alertDiv.style.animation = 'slideOut 0.5s forwards'; // 应用消失动画
                    setTimeout(function () {
                        alertDiv.style.display = 'none';
                    }, 500);
                }, 3000);
            }
        });
    });
  });
</script> <script>
function copyCode(button, event) {
  event.preventDefault();
  const codeBlock = button.parentNode.nextElementSibling.textContent; // 获取代码内容
  navigator.clipboard.writeText(codeBlock).then(() => {
    // 显示 "Copied"
    button.querySelector('.copy-text').style.display = 'none';
    button.querySelector('.copied-text').style.display = 'inline';

    // 3秒后恢复
    setTimeout(() => {
      button.querySelector('.copy-text').style.display = 'inline';
      button.querySelector('.copied-text').style.display = 'none';
    }, 3000);
  });
}
</script> <script>(function(){const url = "https://fatbobman.com/ads/en";

  // 根据中英文对应不同的 adCacheKey
  const adCacheKey = 'dynamicAdCache' + (window.location.pathname.includes('/zh/') ? 'ZH' : 'EN');

  // 尝试从缓存中获取广告
  const cachedAd = JSON.parse(localStorage.getItem(adCacheKey));
  const now = Date.now();

  if (cachedAd && cachedAd.expiresAt > now) {
    console.log('Using cached ad');
    console.log(cachedAd.expiresAt - now);
    // 如果缓存有效，直接使用缓存的广告
    renderAd(cachedAd.content);
  } else {
    console.log('Fetching ad from the server');
    // 如果缓存无效，从服务器获取广告
    fetch(url, {
      headers: {
        'Accept': 'text/html',
      },
      cache: 'default'
    })
      .then(response => {
        const maxAgeMatch = response.headers.get('Cache-Control')?.match(/max-age=(\d+)/);
        const maxAge = maxAgeMatch ? parseInt(maxAgeMatch[1], 10) : 0;

        if (!response.ok || maxAge <= 0) {
          throw new Error('Invalid response or missing Cache-Control');
        }

        return response.text().then(adContent => {
          // const expiresAt = now + maxAge * 1000; // 计算失效时间
          // 解析 max-age
          const cc = response.headers.get('Cache-Control') || '';
          const maxAge = parseInt((cc.match(/(?:^|,)\s*max-age=(\d+)/)?.[1] ?? '0'), 10);

          // 读取 CDN Age 与服务端时间
          const age = parseInt(response.headers.get('Age') || '0', 10);
          // const serverDate = response.headers.get('Date');

          // 计算剩余 TTL（优先用 Age 抵扣）
          const ttlLeftMs = Math.max(0, (maxAge - age) * 1000);

          // 失效时间：以当前本地时间加剩余 TTL（若要完全按服务端时间，可用 serverDate 做基线）
          const expiresAt = Date.now() + ttlLeftMs;

          // 缓存广告内容
          localStorage.setItem(adCacheKey, JSON.stringify({ content: adContent, expiresAt }));
          // 渲染广告
          renderAd(adContent);
        });
      })
      .catch(error => console.error('Error loading the ad:', error));
  }

  // 渲染广告函数
  function renderAd(html) {
    const adSlots = document.querySelectorAll('.dynamic-ad-container');
    adSlots.forEach(slot => {
      slot.innerHTML = html;
    });
  }
})();</script> <script type="module">var c=document.querySelectorAll("article");c.forEach(function(r){var a=r.querySelectorAll("a");a.forEach(function(e){var t=e.getAttribute("href");t&&t.startsWith("http")&&!t.includes("fatbobman.com")&&!t.includes("fatbobman.github.com")&&!t.includes("localhost")&&e.setAttribute("target","_blank")})});</script> <!-- <LeaveFeedback lang={lang} /> --> <!-- <BottomWeeklySubscribe lang={lang} /> --> <div id="gitalk-container" data-comment-id="Ask Apple 2022 与 SwiftUI 有关的问答（上）" data-lang="en" data-repo="blogComments" data-createIssueManually="true" data-anchor="related-posts" class="pb-16"></div>

    <script defer>
      document.addEventListener('DOMContentLoaded', async function () {
      const container = document.getElementById('custom-substack-embed');
      let anchor = '';
      if (container) {
        anchor = container.getAttribute('data-anchor') || '';
      }
        // 提前检查是否需要加载评论
        try {
          const response = await fetch('https://fatbobman.com/status/comment');
          const data = await response.text();
          console.log(data, "comment");

          if (data !== '1') {
            console.log('评论功能未启用，跳过监控和加载操作。');
            return; // 提前返回，跳过后续逻辑
          }
        } catch (error) {
          console.error('检查评论状态时出错：', error);
          return; // 出现错误时也跳过后续逻辑
        }

        // 如果返回值为 "1"，则启动观察器
        const observerTarget = document.getElementById(anchor);
        if (observerTarget) {
          const observer = new IntersectionObserver(async (entries, observer) => {
            const entry = entries[0];
            if (entry.isIntersecting) {
              console.log("load comment")
              // 停止观察，避免重复触发
              observer.unobserve(observerTarget);

              // 动态加载评论区脚本
              await loadGitalk();
            }
          }, {
            root: null, // 相对于视口
            rootMargin: '20%', // 提前 20% 的位置触发
            threshold: 0.1, // 元素显示 10% 即触发
          });

          observer.observe(observerTarget);
        }

        // 动态加载 Gitalk 脚本并初始化评论区
        async function loadGitalk() {
          const container = document.getElementById('gitalk-container');
          if (container) {
            const commentID = container.getAttribute('data-comment-id');
            const lang = container.getAttribute('data-lang');
            const repo = container.getAttribute('data-repo')
            const createIssueManually = container.getAttribute('data-createIssueManually')

            console.log(repo);
            console.log(createIssueManually)

            // 动态加载 Gitalk 脚本
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js';
            script.defer = true;
            script.onload = () => {
              const gitalk = new Gitalk({
                clientID: 'fcf61195c7f73253dc8b',
                clientSecret: '0ac2907be08248a1fcb5312e27480ad535c682e5',
                repo: repo,
                owner: 'fatbobman',
                admin: ['fatbobman'],
                id: commentID.split('/').pop().substring(0, 49),
                distractionFreeMode: true,
                createIssueManually: createIssueManually,
                language: lang,
              });

              gitalk.render('gitalk-container');
            };
            document.body.appendChild(script);
          }
        }
      });
    </script> <div class="hidden lg:block w-32 xl:w-44 lg:absolute" id="toc" style="left: -30px; top: 0px"> <div class="text-muted items-center justify-center opacity-0 transition-all duration-1000 delay-300 ease-out" id="toc-content"> <div class="w-full flex justify-end pb-2" id="toc-float-button"> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <svg fill="currentColor" stroke="currentColor" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" id="toc-list-switcher"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-toc"></use> </svg> <svg fill="currentColor" stroke="currentColor" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" id="toc-list-close" class="hidden"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-toc-close"></use> </svg>  </div> </div> <div class="text-default text-xxs xl:text-xs hidden" id="toc-list"> <ul> <li class=" pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#qa" class="inline-block hover:text-secondary text-heading font-medium relative before:hidden xl:before:block before:content-[&#34;▪&#34;] before:absolute before:left-[-15px] before:text-heading before:w-0 py-1 break-words"> Q&amp;A </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#uiactivityviewcontroller" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> UIActivityViewController </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#contextaction" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> contextAction </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#how-to-test-state-variables" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> How to test @State variables </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#creating-a-bottom-text-input-bar-similar-to-an-im-application" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Creating a bottom text input bar similar to an IM application </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#how-to-avoid-recomputing-the-view-that-creates-an-instance-when-using-environmentobject" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> How to avoid recomputing the view that creates an instance when using environmentObject </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#navigationpath" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> NavigationPath </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#locking-the-y-axis-scale-for-charts" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Locking the Y-axis Scale for Charts </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#implicit-and-explicit-animations" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Implicit and Explicit Animations </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#adaptive-height-sheet" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Adaptive Height Sheet </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#toolbarcontentbuilder" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> ToolbarContentBuilder </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#windowgroup" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> WindowGroup </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#documentgroup" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> DocumentGroup </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#mvvm" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> MVVM </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#onappearinitviewdidload" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> onAppear、init、viewDidLoad </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#universal-navigation-model" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Universal Navigation Model </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#methods-and-efficiency-of-position-offset" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Methods and Efficiency of Position Offset </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#size-rules-for-navigationsplitview" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Size rules for NavigationSplitView </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#how-to-improve-the-efficiency-of-a-view-containing-a-large-number-of-uitextfield" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> How to improve the efficiency of a view containing a large number of UITextField </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#cross-view-hierarchical-sharing" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Cross-View Hierarchical Sharing </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#task-vs-onappear" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> task vs onAppear </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#windowgroup-和-openwindowaction" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> WindowGroup 和 OpenWindowAction </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#initializing-stateobject-in-the-constructor" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Initializing @StateObject in the constructor </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#san-francisco-width-styles" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> San Francisco Width Styles </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#adding-shortcuts-to-stepper" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Adding Shortcuts to Stepper </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#labeledcontent" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> LabeledContent </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#if-statements-in-viewbuilder" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> if Statements in ViewBuilder </a> </div> </li><li class="xl:pl-4 pl-1 pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#initializing-state" class="inline-block font-normal relative before:content-[&#34;-&#34;] before:hidden xl:before:block before:absolute before:left-[-10px] before:text-default before:w-0 break-words"> Initializing @State </a> </div> </li><li class=" pb-1"> <div class="text-muted hover:text-secondary hover:font-black"> <a href="#summary" class="inline-block hover:text-secondary text-heading font-medium relative before:hidden xl:before:block before:content-[&#34;▪&#34;] before:absolute before:left-[-15px] before:text-heading before:w-0 py-1 break-words"> Summary: </a> </div> </li>  </ul> </div> </div> </div> <script type="module" src="/_astro/TOC.astro_astro_type_script_index_0_lang.ARhKvemZ.js"></script> <div class="hidden md:block md:absolute" id="sidebar" style="right: -50px; top: 0px"> <div class="invisible flex flex-col space-y-4 text-muted items-center justify-center opacity-0 transition-all duration-1000 delay-300 ease-out" id="sidebar-content"> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <button type="button" onclick="
      try {
        if ('/en/posts/core-data-of-ask-apple-2022-2/' !== '#') {
          window.location.href = '/en/posts/core-data-of-ask-apple-2022-2/';
        }
      } catch (e) {
        console.log('Navigation failed:', e);
      }
    " data-tooltip-target="tooltip-next-post" data-tooltip-placement="left" id="sidebar-next-post" class="cursor-pointer" aria-label="Next post"> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-previous"></use> </svg> </button>  </div> <div id="tooltip-next-post" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-44 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Ask Apple 2022 Q&amp;A Related on Core Data (Part 2)</div> <div class="text-xs text-yellow-200 font-extrabold pt-2">⌥ + ←</div> </div> </div> <script>(function(){const url = "/en/posts/core-data-of-ask-apple-2022-2/";
const isHidden = false;

  document.addEventListener('keydown', (e) => {
    // Check if Alt+RightArrow or just RightArrow was pressed
    if (e.altKey && e.key === 'ArrowLeft') {
      // Only navigate if there's a URL and the button isn't hidden
      if (url && !isHidden) {
        e.preventDefault(); // Prevent default browser behavior
        window.location.href = url;
      }
    }
  });
})();</script> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <button type="button" onclick="
      try {
        if ('/en/posts/swiftui-of-ask-apple-2022-2/' !== '#') {
          window.location.href = '/en/posts/swiftui-of-ask-apple-2022-2/';
        }
      } catch (e) {
        console.log('Navigation failed:', e);
      }
    " data-tooltip-target="tooltip-previous-post" data-tooltip-placement="left" id="sidebar-previous-post" class="cursor-pointer" aria-label="Previous post"> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-next"></use> </svg> </button>  </div> <div id="tooltip-previous-post" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-44 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Ask Apple 2022 Q&amp;A Related to SwiftUI (Part 2)</div> <div class="text-xs text-yellow-200 font-extrabold pt-2">⌥ + →</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div> <script>(function(){const url = "/en/posts/swiftui-of-ask-apple-2022-2/";
const isHidden = false;

  document.addEventListener('keydown', (e) => {
    // Check if Alt+RightArrow or just RightArrow was pressed
    if (e.altKey && e.key === 'ArrowRight') {
      // Only navigate if there's a URL and the button isn't hidden
      if (url && !isHidden) {
        e.preventDefault(); // Prevent default browser behavior
        window.location.href = url;
      }
    }
  });
})();</script> <!-- <DictButton lang={lang} post = {post}/> --> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <a href="https://x.com/intent/tweet?text=Ask%20Apple%202022%20Q%26A%20Related%20to%20SwiftUI%20(Part%201)&url=https%3A%2F%2Ffatbobman.com%2Fen%2Fposts%2Fswiftui-of-ask-apple-2022-1%2F&hashtags=ios%2Cswiftlang&via=fatbobman" target="_blank" id="sidebar-share-with-twitter" data-tooltip-target="tooltip-share-with-twitter" data-tooltip-placement="left"> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-twitter"></use> </svg> </a>  </div> <div id="tooltip-share-with-twitter" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-32 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Share on X</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <button type="button" onclick="
      try {
        window.open('https://bsky.app/intent/compose?text=Ask%20Apple%202022%20Q%26A%20Related%20to%20SwiftUI%20(Part%201)%0A by %40fatbobman.com %0Ahttps%3A%2F%2Ffatbobman.com%2Fen%2Fposts%2Fswiftui-of-ask-apple-2022-1%2F%0A #ios #swift', '_blank');
      } catch (e) {
        console.log('Failed to open BlueSky share');
      }
    " id="sidebar-share-with-bluesky" data-tooltip-target="tooltip-share-with-bluesky" data-tooltip-placement="left" class="cursor-pointer" aria-label="Share on BlueSky"> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="0.4" stroke="currentColor" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-bluesky"></use> </svg> </button>  </div> <div id="tooltip-share-with-bluesky" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-40 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Share on BlueSky</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <a href="https://www.facebook.com/sharer/sharer.php?u=https%253A%252F%252Ffatbobman.com%252Fen%252Fposts%252Fswiftui-of-ask-apple-2022-1%252F" target="_blank" id="sidebar-share-with-facebook" data-tooltip-target="tooltip-share-with-facebook" data-tooltip-placement="left"> <svg stroke="currentColor" fill="currentColor" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-facebook"></use> </svg> </a>  </div> <div id="tooltip-share-with-facebook" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-44 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Share on Facebook</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div>  <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:16px; height:16px;">  <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ffatbobman.com%2Fen%2Fposts%2Fswiftui-of-ask-apple-2022-1%2F" target="_blank" id="sidebar-share-with-linkedin" data-tooltip-target="tooltip-share-with-linkedin" data-tooltip-placement="left"> <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="0.1" viewBox="0 0 15 15"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-linkedin"></use> </svg> </a>  </div> <div id="tooltip-share-with-linkedin" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-40 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Share on Linkedin</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <a href="mailto:?subject=Article%3A%E3%80%90Ask%20Apple%202022%20Q%26A%20Related%20to%20SwiftUI%20(Part%201)%E3%80%91&#38;body=Here's%20an%20article%20you%20may%20find%20interesting%3A%0A%0AAsk%20Apple%202022%20Q%26A%20Related%20to%20SwiftUI%20(Part%201)%0A%0ALink%3A%20https%3A%2F%2Ffatbobman.com%2Fen%2Fposts%2Fswiftui-of-ask-apple-2022-1%2F" target="_blank" id="sidebar-share-with-email" data-tooltip-target="tooltip-share-with-email" data-tooltip-placement="left"> <svg fill="currentColor" stroke="currentColor" stroke-width="20" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-email"></use> </svg> </a>  </div> <div id="tooltip-share-with-email" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-40 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Share via Email</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <svg fill="currentColor" stroke="currentColor" stroke-width="20" id="comment-button" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" data-tooltip-target="tooltip-share-with-comment" data-tooltip-placement="left"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-comment"></use> </svg>  </div> <div id="tooltip-share-with-comment" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-44 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Share Your Thoughts</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div> <script>
  const SCROLL_OFFSET = 80;
  
  document.addEventListener('DOMContentLoaded', function() {
    const commentButton = document.getElementById('comment-button');
    if (commentButton) {
      commentButton.addEventListener('click', function() {
        const gitalkContainer = document.getElementById('gitalk-container');
        if (gitalkContainer) {
          const topPosition = gitalkContainer.getBoundingClientRect().top + window.scrollY - SCROLL_OFFSET;
          window.scrollTo({ top: topPosition, behavior: 'smooth' });
        }
      });
    }
  });
</script> <div class="opacity-50 text-heading hover:opacity-100 hover:text-secondary " style="width:20px; height:20px;">  <svg fill="currentColor" stroke="currentColor" onclick="window.scrollTo({top:0,behavior:'smooth'})" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" data-tooltip-target="tooltip-back-to-top" data-tooltip-placement="left"> <use href="/_astro/iconCollection.C9WNJL2e.svg#icon-top"></use> </svg>  </div> <div id="tooltip-back-to-top" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 w-28 text-sm font-medium text-gray-200 bg-gray-600/90 rounded-lg shadow-sm transition-opacity duration-300 tooltip dark:bg-gray-700/90"> <div> <div>Back to Top</div> </div> <div class="tooltip-arrow" data-popper-arrow></div> </div> </div> </div> <script type="module" src="/_astro/SideBar.astro_astro_type_script_index_0_lang.DVW0R156.js"></script> </div>   </div> </main> </div> <footer> <footer class="bg-block "> <div class="mx-auto w-full max-w-3xl px-4 md:px-6"> <div class="container flex flex-col items-center pt-10"> <div class="flex flex-row justify-around w-full space-x-3"> <div class="flex flex-col space-y-4"> <h2 class="font-bold text-heading">Explore</h2> <div class="flex flex-col space-y-2 text-sm text-default font-medium"> <a href="/en/snippet/" class="hover:text-secondary">Quick Tips</a> <a href="/en/posts/" class="hover:text-secondary">Posts</a> <a href="/en/tags/" class="hover:text-secondary">Tags</a> <a href="/en/collections/" class="hover:text-secondary">Collections</a> </div> </div> <div class="flex flex-col space-y-4"> <h2 class="font-bold text-heading">Subscribe</h2> <div class="flex flex-col space-y-2 text-sm text-default font-medium"> <a href="https://weekly.fatbobman.com/welcome" class="hover:text-secondary" target="_blank">Newsletter</a> <a href="/rss.xml" class="hover:text-secondary hover:font-medium" target="_blank">RSS</a> </div> </div> <div class="flex flex-col space-y-4"> <h2 class="font-bold text-heading">Connect &amp; Support</h2> <div class="flex flex-col space-y-2 text-sm text-default font-medium"> <a href="/en/sponsorship/" class="hover:text-secondary" rel="sponsored"> Promote on Blog </a> <a href="/en/about/#contact" class="hover:text-secondary">Contact Me</a> <a href="https://www.buymeacoffee.com/fatbobman" class="hover:text-secondary" target="_blank">Buy Me a Coffee ☕️</a> </div> </div> </div> <div class="pb-0"> <div class="flex items-center justify-center w-full px-6 pt-12 text-sm"> <span class="text-muted text-xs tracking-normal">Copyright ©  2025
Fatbobman Digital Limited. All Rights
            Reserved.</span> </div> <div class="flex items-center justify-center w-full px-6 pt-2 text-sm pb-10"> <button type="button" onclick="
        try {
          window.open('https://beian.miit.gov.cn/#/Integrated/index', '_blank');
        } catch (e) {
          console.log('Failed to open ICP link:', e);
        }
      " class="text-xxs hover:underline text-muted tracking-wide" aria-label="ICP Registration Information">
辽ICP备20006550号-1
</button> </div> </div> </div> </div> </footer> </footer> </div> <section> <div id="weekly-modal" data-subscribeText="Join Now" data-placeholder="Subscribe with your email"> <div id="popup-modal" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"> <!-- Modal content --> <div class="relative bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 rounded-lg shadow-2xl border-gray-200 border dark:border-gray-600"> <!-- Modal header --> <div class="flex items-center justify-between px-4 md:px-5 pt-4 pb-0 rounded-t dark:border-gray-600"> <button id="popup-modal-close-button" type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"> <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14"> <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"></path> </svg> <span class="sr-only">Close modal</span> </button> </div> <!-- Modal body --> <div class="px-4 md:px-5 pb-4 md:w-[480px] sm:w-80 mx-auto"> <div class="sm:hidden md:block text-base text-center font-bold text-gray-900 dark:text-blue-100 pt-4 pb-2 ">Weekly Swift &amp; SwiftUI Highlights - Every Monday</div> <iframe class="mx-auto sm:w-[320px] md:w-[480px] sm:h-[200px] md:h-[320px] dark:opacity-80 dark:rounded-lg dark:shadow-2xl dark:border-gray-600" src="https://weekly.fatbobman.com/embed" style="border:0px solid #EEE; background:white; width: 100%; max-width: 480px;"></iframe> </div> </div> </div> </div> </section> <script type="module" src="/_astro/WeeklyModalLoader.astro_astro_type_script_index_0_lang.CmhzHyOM.js"></script>  <script src="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.js" async></script> <script src="https://analytics.ahrefs.com/analytics.js" data-key="KF0NNRpbcfyJPzijzZEiOw" async></script> <script>
  // 为每个需要清除 focus 状态的按钮都添加一个 clear-focus 类, 下面的代码将在点击后自动移除 focus 状态
  document.addEventListener('DOMContentLoaded', () => {
    // 获取所有具有 'clear-focus' 类的按钮
    const buttons = document.querySelectorAll('.clear-focus');

    buttons.forEach((button) => {
      button.addEventListener('click', () => {
        setTimeout(() => {
          button.blur();
        }, 0);
      });
    });
  });

  window.onpageshow = function () {
    document.documentElement.classList.add('motion-safe:scroll-smooth');
  };
</script> <div id="docsearch-container-data" data-lang="en" data-searchtext="Search..."></div> <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3.8.3" defer></script> <script type="module">function r(e,t){const a={button:{buttonText:"搜索",buttonAriaLabel:"搜索"},modal:{searchBox:{resetButtonTitle:"清除搜索关键字",resetButtonAriaLabel:"清除搜索关键字",cancelButtonText:"取消",cancelButtonAriaLabel:"取消"},startScreen:{recentSearchesTitle:"最近搜索",noRecentSearchesText:"当前没有搜索历史记录",saveRecentSearchButtonTitle:"保存本次搜索",removeRecentSearchButtonTitle:"从搜索历史中移除",favoriteSearchesTitle:"收藏夹",removeFavoriteSearchButtonTitle:"从收藏夹移除"},errorScreen:{titleText:"无法获取结果",helpText:"请检查网络连接"},footer:{selectText:"选择",selectKeyAriaLabel:"选择",navigateText:"切换",navigateUpKeyAriaLabel:"Arrow up",navigateDownKeyAriaLabel:"Arrow down",closeText:"退出",closeKeyAriaLabel:"Escape key",searchByText:"引擎支持"},noResultsScreen:{noResultsText:"无法找到对应结果",suggestedQueryText:"可以尝试搜索如下内容",reportMissingResultsText:"确认本次搜索应该返回内容？",reportMissingResultsLinkText:"请告知我们"}}};if(typeof window<"u"){const n=window.docsearch;n({appId:"MVXKD4F4BR",apiKey:"a1b4111c3de8b9f60eeca6da001711da",indexName:"fatbobman",container:"#docsearch",insights:!0,placeholder:t,maxResultsPerGroup:50,translations:e==="zh"?a:void 0,searchParameters:{facetFilters:[`lang:${e}`],hitsPerPage:50}})}}function o(){const e=document.getElementById("docsearch-container-data");if(!e){console.error("Search container not found");return}const t=e.dataset.lang,a=e.dataset.searchtext;r(t,a)}window.addEventListener("load",()=>{document.querySelector('script[src*="docsearch"]')&&o()});</script> <!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5C7N4MF5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!-- End Google Tag Manager (noscript) --> <!--Magic Fix 解决在 Safari 下搜索框取消后会滚动到页面底部--> <div class="fixed"> <input type="text"> </div> </body></html>