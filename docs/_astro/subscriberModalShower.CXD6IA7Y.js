import{_ as m}from"./preload-helper.CLcXU_4U.js";import{Modal as u}from"./index.X8V1lpj1.js";const f={backdrop:"dynamic"};function s(){const o=document.getElementById("popup-modal");return o?new u(o,f):(console.error("Modal element not found."),null)}function g({subscribeText:o,placeholder:r,embedUrl:l,iframeClass:n,iframeStyle:a}){const e=s();if(e){p({embedUrl:l,iframeClass:n,iframeStyle:a}),m(async()=>{const{initializeSubscriptionWidget:i}=await import("./subcriberModalCssLoader.BJ4hWkC-.js");return{initializeSubscriptionWidget:i}},[]).then(({initializeSubscriptionWidget:i})=>{i({subscribeText:o,placeholder:r})});const t=document.getElementById("popup-modal-close-button");t&&t.addEventListener("click",()=>{e.hide()});const d=document.getElementById("weekly-modal-continue-button");d&&d.addEventListener("click",()=>{e.hide()}),e.show(),console.log("Modal is now displayed.")}}function p({embedUrl:o,iframeClass:r,iframeStyle:l}){if(!o)return;const n=document.getElementById("weekly-modal-embed");if(!n)return;const a=n.dataset.iframeLoaded;if(a==="pending"||a==="true")return;n.dataset.iframeLoaded="pending";const e=document.createElement("iframe");e.src=o,e.loading="lazy",e.decoding="async",e.referrerPolicy="strict-origin-when-cross-origin",e.className=r||"",e.style.cssText=l||"",e.setAttribute("title","Fatbobman Weekly Subscription"),e.setAttribute("aria-label","Fatbobman Weekly Subscription");const t=n.querySelector("[data-weekly-loader]"),d=t?.dataset.errorText;t&&t.classList.remove("hidden");const i=n.querySelector('[aria-hidden="true"].animate-spin');n.appendChild(e);const c=()=>{t&&t.remove(),i&&i.remove(),n.dataset.iframeLoaded="true"};e.addEventListener("load",c,{once:!0}),e.addEventListener("error",()=>{t&&(t.textContent=d||"Failed to load subscription form. Please retry later.",t.classList.remove("hidden")),i&&i.remove(),n.dataset.iframeLoaded="error"},{once:!0})}function h(){const o=s();o&&(o.hide(),console.log("Modal is now hidden."))}export{h as hideModal,s as initializeModal,g as showModal};
