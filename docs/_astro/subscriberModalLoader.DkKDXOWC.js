const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/subscriberModalShower.i0qlteqo.js","_astro/preload-helper.CLcXU_4U.js"])))=>i.map(i=>d[i]);
import{_ as w}from"./preload-helper.CLcXU_4U.js";const E=40*1e3,p=60*60*4*1e3,h="subcribeModalLastShownTime";let s,n={subscribeText:"",placeholder:""},c=!1,u=!1,f=null;document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&c&&(d(),c=!1)});function m(){const e=localStorage.getItem(h),t=Date.now();return e?t-parseInt(e,10)>=p:!0}function l(){localStorage.setItem(h,Date.now().toString())}function r(){s&&clearTimeout(s),s=setTimeout(()=>{m()?(v(),l(),document.visibilityState==="visible"?d():c=!0):console.log("not load modal")},E)}function d(){w(()=>import("./subscriberModalShower.i0qlteqo.js"),__vite__mapDeps([0,1])).then(e=>{e.showModal({subscribeText:n.subscribeText,placeholder:n.placeholder})})}function o(){d(),l()}function L({subscribeText:e,placeholder:t}){n.subscribeText=e,n.placeholder=t,window.addEventListener("open-subscribe-modal",()=>{o()}),u||(f=function(a){a.target?.closest?.('a[href="#subscript"]')&&(a.preventDefault(),a.stopPropagation(),o())},document.addEventListener("click",f,!0),u=!0);function i(){window.location.hash==="#subscript"&&(o(),window.history.replaceState(null,"",window.location.pathname+window.location.search))}i(),window.addEventListener("hashchange",i)}function b(){["mousemove","keydown","scroll","click"].forEach(t=>{document.addEventListener(t,r)})}function v(){["mousemove","keydown","scroll","click"].forEach(t=>{document.removeEventListener(t,r)})}function T({subscribeText:e,placeholder:t}){n.subscribeText=e,n.placeholder=t,b(),r()}const _={initModalIdleChecker:T,initModalManual:L,triggerModal:o,setupEventListeners:b,removeEventListeners:v,canShowModal:m,updateLastShownTime:l};export{_ as default};
