const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/subscriberModalShower.AjPMrxLC.js","_astro/preload-helper.CLcXU_4U.js"])))=>i.map(i=>d[i]);
import{_ as S}from"./preload-helper.CLcXU_4U.js";const L=40*1e3,T=60*60*4*1e3,v="subcribeModalLastShownTime";let r,e={subscribeText:"",placeholder:"",embedUrl:"",iframeClass:"",iframeStyle:""},c=!1,h=!1,b=null;document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&c&&(m(),c=!1)});function w(){const t=localStorage.getItem(v),i=Date.now();return t?i-parseInt(t,10)>=T:!0}function d(){localStorage.setItem(v,Date.now().toString())}function u(){r&&clearTimeout(r),r=setTimeout(()=>{w()?(p(),d(),document.visibilityState==="visible"?m():c=!0):console.log("not load modal")},L)}function m(){S(()=>import("./subscriberModalShower.AjPMrxLC.js"),__vite__mapDeps([0,1])).then(t=>{t.showModal({subscribeText:e.subscribeText,placeholder:e.placeholder,embedUrl:e.embedUrl,iframeClass:e.iframeClass,iframeStyle:e.iframeStyle})})}function o(){m(),d()}function y({subscribeText:t,placeholder:i,embedUrl:n,iframeClass:a,iframeStyle:l}){e.subscribeText=t,e.placeholder=i,e.embedUrl=n||"",e.iframeClass=a||"",e.iframeStyle=l||"",window.addEventListener("open-subscribe-modal",()=>{o()}),h||(b=function(s){s.target?.closest?.('a[href="#subscript"]')&&(s.preventDefault(),s.stopPropagation(),o())},document.addEventListener("click",b,!0),h=!0);function f(){window.location.hash==="#subscript"&&(o(),window.history.replaceState(null,"",window.location.pathname+window.location.search))}f(),window.addEventListener("hashchange",f)}function E(){["mousemove","keydown","scroll","click"].forEach(i=>{document.addEventListener(i,u)})}function p(){["mousemove","keydown","scroll","click"].forEach(i=>{document.removeEventListener(i,u)})}function g({subscribeText:t,placeholder:i,embedUrl:n,iframeClass:a,iframeStyle:l}){e.subscribeText=t,e.placeholder=i,e.embedUrl=n||"",e.iframeClass=a||"",e.iframeStyle=l||"",E(),u()}const M={initModalIdleChecker:g,initModalManual:y,triggerModal:o,setupEventListeners:E,removeEventListeners:p,canShowModal:w,updateLastShownTime:d};export{M as default};
