<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="sitemap" href="/sitemap-index.xml"><!-- <link rel="shortcut icon" href={iconSVG.src} /> --><link rel="icon" type="image/png" sizes="16x16" href="/_astro/favicon-16x16.2312221518-2.DhhY-2ao.png"><link rel="icon" type="image/png" sizes="32x32" href="/_astro/favicon-32x32.2312221518-2.BbUzUdRZ.png"><link rel="mask-icon" href="/_astro/faviconSVG-32x32.2312221518-2.ll_gTgJS.svg"><link rel="apple-touch-icon" sizes="180x180" href="/_astro/apple-touch-icon.2312227635.BE1WvNvp.png"><title>Ads Manager - Admin</title>
<meta name="description" content="Advertisement management dashboard">
<meta name="robots" content="index,follow">
<link rel="canonical" href="https://fatbobman.com/admin/ads-manager/">
<meta property="og:title" content="Fatbobman&#39;s Blog - A Blog About Swift, SwiftUI, and More">
<meta property="og:description" content="Advertisement management dashboard">
<meta property="og:url" content="https://fatbobman.com/admin/ads-manager/">
<meta property="og:type" content="website">
<meta property="og:image" content="https://fatbobman.com/images/blog-card.png">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="fatbobman.com">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@fatbobman">
<meta name="twitter:creator" content="@fatbobman"><link rel="alternate" type="application/rss+xml" title="RSS Feed for My Website" href="https://fatbobman.com/en/rss.xml"><link rel="sitemap" href="/sitemap-index.xml"><!-- å…¶ä»–è·¯å¾„çš„ hreflang -->
  <link rel="alternate" hreflang="en" href="https://fatbobman.com/admin/ads-manager/">
  <link rel="alternate" hreflang="zh-CN" href="https://fatbobman.com/admin/ads-manager/">
  <link rel="alternate" hreflang="x-default" href="https://fatbobman.com/admin/ads-manager/"><script type="text/partytown" src="https://analytics.ahrefs.com/analytics.js" data-key="KF0NNRpbcfyJPzijzZEiOw"></script><script data-partytown-skip="true">
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.async = true; // Add async attribute
        hm.src = "https://hm.baidu.com/hm.js?14e5d60a3ea6276655f9d14c58b1fcd0";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script><script type="text/partytown">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5C7N4MF5');</script><script>
      // Immediately set theme before page renders
      if (
        localStorage.getItem('color-theme') === 'dark' ||
        (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
      ) {
        document.documentElement.classList.add('dark');
      }
    </script><script type='application/ld+json'>{
  "@context": "https://schema.org",
  "@type": "Person",
  "@id": "#author",
  "name": "ä¸œå¡è‚˜å­ (å¾æ¨)",
  "alternateName": "Fatbobman (Xu Yang)",
  "jobTitle": "Apple Developer",
  "description": "è‹¹æœç”Ÿæ€å¼€å‘è€…ï¼Œä¸“æ³¨ Swift å’Œ SwiftUI å¼€å‘ã€‚Fatbobman's Blog ä½œè€…ã€‚",
  "url": "https://fatbobman.com",
  "image": {
    "@type": "ImageObject",
    "url": "https://cdn.fatbobman.com/FatWithBoys.png"
  },
  "sameAs": [
    "https://github.com/fatbobman",
    "https://x.com/fatbobman",
    "https://www.linkedin.com/in/fatbobman/",
    "https://bsky.app/profile/fatbobman.com",
    "https://mastodon.social/@fatbobman",
    "https://web.okjike.com/u/e32947ef-7751-4363-9456-b340eef2efd3",
    "https://fatbobman.com/zh/about/",
    "https://fatbobman.com/en/about/"
  ],
  "worksFor": {
    "@type": "Organization",
    "name": "Fatbobman's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://fatbobman.com/images/blog-card.png"
    }
  }
}</script><link rel="stylesheet" href="/_astro/about.sOqopnWC.css"><script>!(function(w,p,f,c){if(!window.crossOriginIsolated && !navigator.serviceWorker) return;c=w[p]=Object.assign(w[p]||{},{"lib":"/~partytown/","debug":true});c[f]=(c[f]||[]).concat(["dataLayer.push","gtag"])})(window,'partytown','forward');/* Partytown 0.11.2 - MIT QwikDev */
const t={preserveBehavior:!1},e=e=>{if("string"==typeof e)return[e,t];const[n,r=t]=e;return[n,{...t,...r}]},n=Object.freeze((t=>{const e=new Set;let n=[];do{Object.getOwnPropertyNames(n).forEach((t=>{"function"==typeof n[t]&&e.add(t)}))}while((n=Object.getPrototypeOf(n))!==Object.prototype);return Array.from(e)})());!function(t,r,o,i,a,s,c,l,d,p,u=t,f){function h(){f||(f=1,"/"==(c=(s.lib||"/~partytown/")+(s.debug?"debug/":""))[0]&&(d=r.querySelectorAll('script[type="text/partytown"]'),i!=t?i.dispatchEvent(new CustomEvent("pt1",{detail:t})):(l=setTimeout(v,(null==s?void 0:s.fallbackTimeout)||1e4),r.addEventListener("pt0",w),a?y(1):o.serviceWorker?o.serviceWorker.register(c+(s.swPath||"partytown-sw.js"),{scope:c}).then((function(t){t.active?y():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&y()}))}),console.error):v())))}function y(e){p=r.createElement(e?"script":"iframe"),t._pttab=Date.now(),e||(p.style.display="block",p.style.width="0",p.style.height="0",p.style.border="0",p.style.visibility="hidden",p.setAttribute("aria-hidden",!0)),p.src=c+"partytown-"+(e?"atomics.js?v=0.11.2":"sandbox-sw.html?"+t._pttab),r.querySelector(s.sandboxParent||"body").appendChild(p)}function v(n,o){for(w(),i==t&&(s.forward||[]).map((function(n){const[r]=e(n);delete t[r.split(".")[0]]})),n=0;n<d.length;n++)(o=r.createElement("script")).innerHTML=d[n].innerHTML,o.nonce=s.nonce,r.head.appendChild(o);p&&p.parentNode.removeChild(p)}function w(){clearTimeout(l)}s=t.partytown||{},i==t&&(s.forward||[]).map((function(r){const[o,{preserveBehavior:i}]=e(r);u=t,o.split(".").map((function(e,r,o){var a;u=u[o[r]]=r+1<o.length?u[o[r]]||(a=o[r+1],n.includes(a)?[]:{}):(()=>{let e=null;if(i){const{methodOrProperty:n,thisObject:r}=((t,e)=>{let n=t;for(let t=0;t<e.length-1;t+=1)n=n[e[t]];return{thisObject:n,methodOrProperty:e.length>0?n[e[e.length-1]]:void 0}})(t,o);"function"==typeof n&&(e=(...t)=>n.apply(r,...t))}return function(){let n;return e&&(n=e(arguments)),(t._ptf=t._ptf||[]).push(o,arguments),n}})()}))})),"complete"==r.readyState?h():(t.addEventListener("DOMContentLoaded",h),t.addEventListener("load",h))}(window,document,navigator,top,window.crossOriginIsolated);;(e=>{e.addEventListener("astro:before-swap",e=>{let r=document.body.querySelector("iframe[src*='/~partytown/']");if(r)e.newDocument.body.append(r)})})(document);</script></head> <body class="antialiased text-default bg-page">  <div class="flex flex-col min-h-screen justify-between "> <div> <header>  </header> <h1 class="sr-only">Ads Manager</h1> <main class="w-full mx-auto max-w-3xl p-4 md:p-6 "> <div class="container mx-auto">  <main class="container max-w-6xl mx-auto px-4 py-8"> <!-- Auth Check Loading --> <div id="loadingAuth" class="text-center py-16"> <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div> <p class="mt-4 text-gray-600 dark:text-gray-400">Checking authentication...</p> </div> <!-- Main Content (hidden until authenticated) --> <div id="mainContent" class="hidden"> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6"> <div class="flex items-center justify-between"> <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100">
ğŸ“Š Advertisement Manager
</h1> <div class="flex items-center gap-3"> <button id="exportDataButton" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center gap-2" title="Export all ad data as JSON"> <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path> </svg>
Export
</button> <button id="importDataButton" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center gap-2" title="Import ad data from JSON file"> <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path> </svg>
Import
</button> <input type="file" id="importFileInput" accept=".json" class="hidden"> <button id="logoutButton" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
Logout
</button> </div> </div> </div> <!-- Status Panel --> <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"> <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-6 border border-blue-200 dark:border-blue-800"> <h3 class="text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2">Authentication</h3> <p class="text-2xl font-bold text-blue-600 dark:text-blue-400">âœ“ Verified</p> </div> <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-6 border border-green-200 dark:border-green-800"> <h3 class="text-sm font-semibold text-green-900 dark:text-green-100 mb-2">KV Connection</h3> <p id="kvStatus" class="text-2xl font-bold text-green-600 dark:text-green-400">Testing...</p> </div> <div class="bg-purple-50 dark:bg-purple-900/20 rounded-lg p-6 border border-purple-200 dark:border-purple-800"> <h3 class="text-sm font-semibold text-purple-900 dark:text-purple-100 mb-2">Total Ads</h3> <p id="totalAds" class="text-2xl font-bold text-purple-600 dark:text-purple-400">0</p> </div> </div> <!-- Default/Fallback Advertisement --> <div class="bg-yellow-50 dark:bg-yellow-900/20 rounded-lg shadow-lg p-6 mb-6 border-2 border-yellow-300 dark:border-yellow-700"> <div class="flex items-center justify-between mb-4"> <div> <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100">
ğŸ  Default / Fallback Advertisement
</h2> <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
This ad is shown when no sponsored ad is scheduled. Cannot be deleted, only modified.
</p> </div> <button id="editDefaultButton" class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg font-semibold transition-colors">
âœï¸ Edit Default Ad
</button> </div> <div id="defaultAdPreview" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"> <div class="border border-gray-300 dark:border-gray-600 rounded-lg p-4"> <h3 class="font-bold text-gray-900 dark:text-gray-100 mb-2">ğŸ‡¨ğŸ‡³ Chinese</h3> <div id="defaultZhTitle" class="text-sm text-gray-700 dark:text-gray-300">Loading...</div> </div> <div class="border border-gray-300 dark:border-gray-600 rounded-lg p-4"> <h3 class="font-bold text-gray-900 dark:text-gray-100 mb-2">ğŸ‡¬ğŸ‡§ English</h3> <div id="defaultEnTitle" class="text-sm text-gray-700 dark:text-gray-300">Loading...</div> </div> </div> </div> <!-- Advertisement List --> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6"> <div class="flex items-center justify-between mb-6"> <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100">
ğŸ“‹ Advertisement Schedules
</h2> <button id="createAdButton" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-colors">
â• Create New Ad
</button> </div> <div id="adsList" class="space-y-4"> <div class="text-center py-8 text-gray-500 dark:text-gray-400">
Loading advertisements...
</div> </div> </div> <!-- Create/Edit Modal --> <div id="adModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"> <div class="p-6"> <div class="flex items-center justify-between mb-6"> <h3 id="modalTitle" class="text-2xl font-bold text-gray-900 dark:text-gray-100">
Create Advertisement
</h3> <button id="closeModal" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"> <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path> </svg> </button> </div> <form id="adForm" class="space-y-6"> <input type="hidden" id="adId" name="id"> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"> <div> <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
Sponsor ID *
</label> <input type="text" id="sponsorId" name="sponsorId" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" placeholder="e.g., boltai (lowercase, no spaces)"> </div> <div> <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
Status
</label> <select id="enabled" name="enabled" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"> <option value="true">âœ“ Enabled</option> <option value="false">âœ— Disabled</option> </select> </div> <div> <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
Start Date *
</label> <input type="date" id="startDate" name="startDate" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"> </div> <div> <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
End Date *
</label> <input type="date" id="endDate" name="endDate" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"> </div> </div> <div> <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
Notes
</label> <textarea id="notes" name="notes" rows="2" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" placeholder="Internal notes about this campaign"></textarea> </div> <div class="border-t border-gray-200 dark:border-gray-700 pt-6"> <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">
Ad Variants (JSON)
</h4> <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
Define Chinese (zh) and English (en) variants. Use <strong>version</strong> (integer) instead of id - system will auto-generate IDs as <code>&lbrace;sponsorId&rbrace;-&lbrace;lang&rbrace;-v&lbrace;version&rbrace;</code>. Required fields: version, title, description, cta, link, logo, badge. Optional: <strong>style</strong> (1=primary card, 2=inline text, default: 1), features[], logoDark. HTML tags supported in title/description.
</p> <textarea id="variants" name="variants" rows="12" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 font-mono text-sm" placeholder="{&quot;zh&quot;: [{&quot;version&quot;: 1, &quot;title&quot;: &quot;...&quot;, ...}], &quot;en&quot;: [{&quot;version&quot;: 1, &quot;title&quot;: &quot;...&quot;, ...}]}"></textarea> </div> <div class="flex items-center justify-end gap-3 pt-4"> <button type="button" id="cancelButton" class="px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
Cancel
</button> <button type="submit" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors">
Save Advertisement
</button> </div> </form> </div> </div> </div> <!-- Default Ad Edit Modal --> <div id="defaultAdModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto"> <div class="p-6"> <div class="flex items-center justify-between mb-6"> <h3 class="text-2xl font-bold text-gray-900 dark:text-gray-100">
Edit Default / Fallback Advertisement
</h3> <button id="closeDefaultModal" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"> <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path> </svg> </button> </div> <form id="defaultAdForm" class="space-y-6"> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"> <!-- Chinese Default Ad --> <div class="border border-gray-300 dark:border-gray-600 rounded-lg p-4"> <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">
ğŸ‡¨ğŸ‡³ Chinese Default Ad (JSON Array)
</h4> <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
Array format with 2 versions. Each version requires: version, style, title, description, cta, link, logo, badge. Optional: features[], logoDark
</p> <textarea id="defaultZhJson" rows="20" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 font-mono text-sm" placeholder="[{&quot;version&quot;: 1, &quot;style&quot;: 1, ...}, {&quot;version&quot;: 2, &quot;style&quot;: 2, ...}]"></textarea> <div id="zhValidationErrors" class="hidden mt-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"> <p class="text-sm font-semibold text-red-800 dark:text-red-200 mb-1">Validation Errors:</p> <ul class="text-sm text-red-700 dark:text-red-300 list-disc list-inside"></ul> </div> </div> <!-- English Default Ad --> <div class="border border-gray-300 dark:border-gray-600 rounded-lg p-4"> <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">
ğŸ‡¬ğŸ‡§ English Default Ad (JSON Array)
</h4> <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
Array format with 2 versions. Each version requires: version, style, title, description, cta, link, logo, badge. Optional: features[], logoDark
</p> <textarea id="defaultEnJson" rows="20" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 font-mono text-sm" placeholder="[{&quot;version&quot;: 1, &quot;style&quot;: 1, ...}, {&quot;version&quot;: 2, &quot;style&quot;: 2, ...}]"></textarea> <div id="enValidationErrors" class="hidden mt-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"> <p class="text-sm font-semibold text-red-800 dark:text-red-200 mb-1">Validation Errors:</p> <ul class="text-sm text-red-700 dark:text-red-300 list-inside list-disc"></ul> </div> </div> </div> <div class="flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700"> <button type="button" id="validateDefaultButton" class="px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold transition-colors">
ğŸ” Validate JSON
</button> <div class="flex items-center gap-3"> <button type="button" id="cancelDefaultButton" class="px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
Cancel
</button> <button type="submit" class="px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg font-semibold transition-colors">
Save Default Ad
</button> </div> </div> </form> </div> </div> </div> </div> </main> <script type="module" src="/_astro/ads-manager.astro_astro_type_script_index_0_lang.CrDLpEiS.js"></script>  </div> </main> </div> <footer>  </footer> </div> <section> <div id="weekly-modal" data-subscribeText="Join Now" data-placeholder="Subscribe with your email" data-embed-url="https://weekly.fatbobman.com/embed" data-iframe-class="mx-auto sm:w-[320px] md:w-[480px] sm:h-[200px] md:h-[320px] dark:opacity-80 dark:rounded-lg dark:shadow-2xl dark:border-gray-600" data-iframe-style="border:0px solid #EEE; background:white; width: 100%; max-width: 480px;"> <div id="popup-modal" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"> <!-- Modal content --> <div class="relative bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 rounded-lg shadow-2xl border-gray-200 border dark:border-gray-600"> <!-- Modal header --> <div class="flex items-center justify-between px-4 md:px-5 pt-4 pb-0 rounded-t dark:border-gray-600"> <button id="popup-modal-close-button" type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"> <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14"> <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"></path> </svg> <span class="sr-only">Close modal</span> </button> </div> <!-- Modal body --> <div class="px-4 md:px-5 pb-4 md:w-[480px] sm:w-80 mx-auto"> <div class="sm:hidden md:block text-base text-center font-bold text-gray-900 dark:text-blue-100 pt-4 pb-2 ">Weekly Swift &amp; SwiftUI Highlights - Every Monday</div> <div id="weekly-modal-embed" class="flex flex-col items-center justify-center gap-4" data-iframe-loaded="false"> <div class="relative flex items-center justify-center"> <div class="w-8 h-8 border-2 border-gray-200 dark:border-gray-700 border-t-secondary rounded-full animate-spin" aria-hidden="true"></div> </div> <div class="text-sm text-gray-400 dark:text-gray-500 text-center" data-weekly-loader data-error-text="Failed to load subscription form. Please retry later." aria-live="polite"> Preparing subscription form... </div> </div> </div> </div> </div> </div> </section> <script type="module" src="/_astro/WeeklyModalLoader.astro_astro_type_script_index_0_lang.BtEIyxdk.js"></script>  <script src="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.js" async></script> <script>
  // ä¸ºæ¯ä¸ªéœ€è¦æ¸…é™¤ focus çŠ¶æ€çš„æŒ‰é’®éƒ½æ·»åŠ ä¸€ä¸ª clear-focus ç±», ä¸‹é¢çš„ä»£ç å°†åœ¨ç‚¹å‡»åè‡ªåŠ¨ç§»é™¤ focus çŠ¶æ€
  document.addEventListener('DOMContentLoaded', () => {
    // è·å–æ‰€æœ‰å…·æœ‰ 'clear-focus' ç±»çš„æŒ‰é’®
    const buttons = document.querySelectorAll('.clear-focus');

    buttons.forEach((button) => {
      button.addEventListener('click', () => {
        setTimeout(() => {
          button.blur();
        }, 0);
      });
    });
  });

  window.onpageshow = function () {
    document.documentElement.classList.add('motion-safe:scroll-smooth');
  };

  if (typeof window !== 'undefined') {
    const videos = Array.from(document.querySelectorAll('video.lazy-video[data-autoplay="lazy"]'));

    if ('IntersectionObserver' in window) {
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            const video = entry.target;

            if (entry.isIntersecting) {
              // è¿›å…¥è§†çª— -> å°è¯•æ’­æ”¾ï¼ˆæµè§ˆå™¨ä¼šæ ¹æ®ç­–ç•¥å†³å®šæ˜¯å¦å…è®¸ï¼‰
              video.play().catch(() => {
                // æŸäº›æƒ…å†µä¸‹ï¼ˆæµè§ˆå™¨ç­–ç•¥ï¼‰å¯èƒ½ä¼šå¤±è´¥ï¼Œé™é»˜å³å¯
              });
            } else {
              // ç¦»å¼€è§†çª— -> æš‚åœï¼ŒèŠ‚çœ CPU & å¸¦å®½
              video.pause();
            }
          });
        },
        {
          threshold: 0.1, // è‡³å°‘æœ‰ 10% å‡ºç°åœ¨è§†çª—é‡Œæ—¶è§¦å‘
        }
      );

      videos.forEach((video) => observer.observe(video));

      // æ¸…ç†é€»è¾‘ï¼šé¡µé¢å¸è½½æ—¶å–æ¶ˆæ‰€æœ‰è§‚å¯Ÿ
      window.addEventListener('beforeunload', () => {
        videos.forEach((video) => observer.unobserve(video));
        observer.disconnect();
      });

      // å¤„ç† bfcache æƒ…å†µ
      window.addEventListener('pageshow', (event) => {
        // å¦‚æœæ˜¯ä» bfcache æ¢å¤ï¼Œé‡æ–°åˆå§‹åŒ–
        if (event.persisted) {
          const newVideos = Array.from(document.querySelectorAll('video.lazy-video[data-autoplay="lazy"]'));
          newVideos.forEach((video) => {
            if (!videos.includes(video)) {
              observer.observe(video);
            }
          });
        }
      });
    } else {
      // è€æµè§ˆå™¨çš„é™çº§ç­–ç•¥ï¼šä»€ä¹ˆéƒ½ä¸åšï¼Œç”¨æˆ·æ‰‹åŠ¨æ’­æ”¾
    }
  }
</script> <script>(function(){const lang = "zh";
const searchText = "æœç´¢...";
const runSearchModuleUrl = "/_astro/runsearch.Cf7wkMmH.js";

  document.addEventListener('DOMContentLoaded', () => {
    const button = document.getElementById('docsearch');
    if (!button) {
      return;
    }

    let docsearchScriptPromise = null;
    let initialized = false;

    const loadDocsearchLibrary = () => {
      if (typeof window !== 'undefined' && typeof window.docsearch === 'function') {
        return Promise.resolve();
      }
      if (!docsearchScriptPromise) {
        docsearchScriptPromise = new Promise((resolve, reject) => {
          const script = document.createElement('script');
          script.src = 'https://cdn.jsdelivr.net/npm/@docsearch/js@3.8.3';
          script.defer = true;
          script.onload = () => resolve();
          script.onerror = reject;
          document.head.appendChild(script);
        });
      }
      return docsearchScriptPromise;
    };

    const handleFirstClick = async (event) => {
      event.preventDefault();
      event.stopPropagation();

      try {
        // Load DocSearch library
        await loadDocsearchLibrary();

        // Import and execute search module
        const module = await import(runSearchModuleUrl);

        // openSearch will call initSearch internally, so we don't need to call both
        await module.openSearch(lang, searchText);

        // Remove the first-click listener after successful initialization
        button.removeEventListener('click', handleFirstClick, true);
        initialized = true;
      } catch (error) {
        console.error('Failed to initialize DocSearch:', error);
      }
    };

    button.addEventListener('click', handleFirstClick, true);
  });
})();</script> <!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5C7N4MF5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!-- End Google Tag Manager (noscript) --> <!--Magic Fix è§£å†³åœ¨ Safari ä¸‹æœç´¢æ¡†å–æ¶ˆåä¼šæ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨--> <div class="fixed"> <input type="text"> </div> </body></html>